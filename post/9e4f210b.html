<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha256-wiz7ZSCn/btzhjKDQBms9Hx4sSeUYsDrTLg7roPstac=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.28/fancybox/fancybox.css" integrity="sha256-6cQIC71/iBIYXFK+0RHAvwmjwWzkWd+r7v/BX3/vZDc=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/green/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"sumumm.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.19.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"fold":{"enable":true,"height":300},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":true,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="本文主要是SD卡的一些基础知识相关笔记，若笔记中有错误或者不合适的地方，欢迎批评指正😃。">
<meta property="og:type" content="article">
<meta property="og:title" content="LV16-21-SDIO-01-SD卡基础知识">
<meta property="og:url" content="https://sumumm.github.io/post/9e4f210b.html">
<meta property="og:site_name" content="苏木">
<meta property="og:description" content="本文主要是SD卡的一些基础知识相关笔记，若笔记中有错误或者不合适的地方，欢迎批评指正😃。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230509221123178.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230509221531248.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230509221736652.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230509222233994.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230509223200913.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230509225102180.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230509225145717.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230509225556057.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230509225712028.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230509225818883.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230509225906879.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230509225926471.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510194931239.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230512071810158.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510211833918.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510212155886.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510214259366.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510214551994.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510214702846.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510215003169.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510215042811.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510215143920.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510220131450.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510220616487.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510220940937.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510221021370.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510221102516.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510221722806.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510222129117.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510222239890.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510222255985.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510222326770.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510222425522.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510222518271.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510222627687.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510222326770.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230511070742199.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230511065559668.png">
<meta property="article:published_time" content="2023-06-04T14:07:15.000Z">
<meta property="article:modified_time" content="2025-06-13T16:25:57.011Z">
<meta property="article:author" content="苏木">
<meta property="article:tag" content="LV16-STM32开发">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230509221123178.png">


<link rel="canonical" href="https://sumumm.github.io/post/9e4f210b.html">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://sumumm.github.io/post/9e4f210b.html","path":"post/9e4f210b.html","title":"LV16-21-SDIO-01-SD卡基础知识"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>LV16-21-SDIO-01-SD卡基础知识 | 苏木</title>
  








    <script src="/js/browser_tools_disable.js"></script>

  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<!-- hexo injector head_end start --><link rel="stylesheet" href="https://unpkg.com/hexo-next-tags-plus@latest/lib/tag_plus.css" media="defer" onload="this.media='all'"><!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">苏木</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">我的学习之路</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>苏木的家</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类页<span class="badge">42</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档页<span class="badge">673</span></a></li><li class="menu-item menu-item-flink"><a href="/flink/" rel="section"><i class="fa fa-link fa-fw"></i>友人帐</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于我</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%80%E3%80%81SD%E5%8D%A1%E7%AE%80%E4%BB%8B"><span class="nav-text">一、SD卡简介</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E4%BB%80%E4%B9%88%E6%98%AFSD%E5%8D%A1%EF%BC%9F"><span class="nav-text">1. 什么是SD卡？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E9%95%BF%E5%95%A5%E6%A0%B7%EF%BC%9F"><span class="nav-text">2. 长啥样？</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-TF%E5%8D%A1"><span class="nav-text">2.1 TF卡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-SD%E5%8D%A1"><span class="nav-text">2.2 SD卡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-TF%E5%8D%A1%E8%BD%ACSD%E5%8D%A1%EF%BC%9F"><span class="nav-text">2.3 TF卡转SD卡？</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E5%AE%98%E6%96%B9%E5%AE%A3%E4%BC%A0%E5%86%8C%EF%BC%9F"><span class="nav-text">3. 官方宣传册？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-SD%E5%8D%A1%E5%88%86%E7%B1%BB"><span class="nav-text">4. SD卡分类</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%8C%E3%80%81SD%E5%8D%A1%E7%89%A9%E7%90%86%E7%BB%93%E6%9E%84"><span class="nav-text">二、SD卡物理结构</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E5%8C%85%E5%90%AB%E5%93%AA%E4%BA%9B%EF%BC%9F"><span class="nav-text">1. 包含哪些？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E5%AF%84%E5%AD%98%E5%99%A8%E7%AE%80%E4%BB%8B"><span class="nav-text">2. 寄存器简介</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%89%E3%80%81SD%E5%8D%A1%E6%80%BB%E7%BA%BF%E5%8F%8A%E5%8D%8F%E8%AE%AE"><span class="nav-text">三、SD卡总线及协议</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-SDIO%E6%8E%A5%E5%8F%A3%EF%BC%9F"><span class="nav-text">1. SDIO接口？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E6%80%BB%E7%BA%BF%E5%8D%8F%E8%AE%AE"><span class="nav-text">2. 总线协议</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-%E5%91%BD%E4%BB%A4%E4%B8%8E%E5%93%8D%E5%BA%94"><span class="nav-text">2.1 命令与响应</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-%E5%B8%A6%E6%95%B0%E6%8D%AE%E5%9D%97%E7%9A%84%E9%80%9A%E4%BF%A1"><span class="nav-text">2.2 带数据块的通信</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-%E5%8D%95%E5%9D%97%E5%92%8C%E5%A4%9A%E5%9D%97%E7%9A%84%E9%80%9A%E4%BF%A1"><span class="nav-text">2.3 单块和多块的通信</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-%E6%95%B0%E6%8D%AE%E4%BD%8D%E4%BB%80%E4%B9%88%E4%BC%A0%E8%BE%93%EF%BC%9F"><span class="nav-text">2.4 数据位什么传输？</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9B%9B%E3%80%81SD%E5%8D%A1%E5%91%BD%E4%BB%A4"><span class="nav-text">四、SD卡命令</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E5%91%BD%E4%BB%A4%E6%A0%BC%E5%BC%8F"><span class="nav-text">1. 命令格式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E5%91%BD%E4%BB%A4%E7%B1%BB%E5%9E%8B"><span class="nav-text">2. 命令类型  </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E5%91%BD%E4%BB%A4%E6%8F%8F%E8%BF%B0"><span class="nav-text">3. 命令描述</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4-Class-0"><span class="nav-text">3.1 基本命令(Class 0)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-%E9%9D%A2%E5%90%91%E5%9D%97%E7%9A%84%E8%AF%BB%E6%93%8D%E4%BD%9C-Class-2"><span class="nav-text">3.2 面向块的读操作(Class 2)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-%E9%9D%A2%E5%90%91%E5%9D%97%E7%9A%84%E5%86%99%E6%93%8D%E4%BD%9C-Class-4"><span class="nav-text">3.3 面向块的写操作(Class 4)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-%E6%93%A6%E9%99%A4%E5%91%BD%E4%BB%A4-Class-5"><span class="nav-text">3.4 擦除命令(Class 5)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-5-%E5%8A%A0%E9%94%81%E5%91%BD%E4%BB%A4-Class-7"><span class="nav-text">3.5 加锁命令(Class 7)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-6-%E7%89%B9%E5%AE%9A%E5%BA%94%E7%94%A8%E5%91%BD%E4%BB%A4-Class-8"><span class="nav-text">3.6 特定应用命令(Class 8)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-7-SD%E5%8D%A1%E7%89%B9%E5%AE%9A%E5%BA%94%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="nav-text">3.7 SD卡特定应用命令</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%94%E3%80%81SD%E5%8D%A1%E5%93%8D%E5%BA%94"><span class="nav-text">五、SD卡响应</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E5%93%8D%E5%BA%94%E7%AE%80%E4%BB%8B"><span class="nav-text">1. 响应简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-R1-%E6%AD%A3%E5%B8%B8%E5%93%8D%E5%BA%94%E5%91%BD%E4%BB%A4"><span class="nav-text">2. R1(正常响应命令)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-R2-CID-CSD%E5%AF%84%E5%AD%98%E5%99%A8"><span class="nav-text">3. R2(CID,CSD寄存器)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-R3-OCR%E5%AF%84%E5%AD%98%E5%99%A8"><span class="nav-text">4. R3(OCR寄存器)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-R6-%E5%8F%91%E5%B8%83%E7%9A%84RCA%E5%AF%84%E5%AD%98%E5%99%A8%E5%93%8D%E5%BA%94"><span class="nav-text">5. R6(发布的RCA寄存器响应)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-R7-%E5%8F%91%E5%B8%83%E7%9A%84RCA%E5%AF%84%E5%AD%98%E5%99%A8%E5%93%8D%E5%BA%94"><span class="nav-text">6. R7(发布的RCA寄存器响应)</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%85%AD%E3%80%81SD%E5%8D%A1%E7%8A%B6%E6%80%81"><span class="nav-text">六、SD卡状态</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E7%8A%B6%E6%80%81%E7%AE%80%E4%BB%8B"><span class="nav-text">1. 状态简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E5%8D%A1%E7%8A%B6%E6%80%81"><span class="nav-text">2. 卡状态</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-SD%E7%8A%B6%E6%80%81"><span class="nav-text">3. SD状态</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%83%E3%80%81SD%E5%8D%A1%E6%97%B6%E9%92%9F%E6%8E%A7%E5%88%B6"><span class="nav-text">七、SD卡时钟控制</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%85%AB%E3%80%81SD%E5%8D%A1%E6%93%8D%E4%BD%9C%E6%A8%A1%E5%BC%8F%E5%8F%8A%E5%88%87%E6%8D%A2"><span class="nav-text">八、SD卡操作模式及切换</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E6%93%8D%E4%BD%9C%E6%A8%A1%E5%BC%8F"><span class="nav-text">1. 操作模式  </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E4%B8%8D%E5%90%8C%E6%A8%A1%E5%BC%8F%E4%B8%8BSD%E5%8D%A1%E7%8A%B6%E6%80%81"><span class="nav-text">2. 不同模式下SD卡状态</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E5%8D%A1%E8%AF%86%E5%88%AB%E6%A8%A1%E5%BC%8F"><span class="nav-text">3. 卡识别模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93%E6%A8%A1%E5%BC%8F"><span class="nav-text">4. 数据传输模式</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B9%9D%E3%80%81%E8%AF%BB%E5%86%99SD%E5%8D%A1"><span class="nav-text">九、读写SD卡</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="nav-text">1. 初始化</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E6%95%B0%E6%8D%AE%E5%9D%97%E8%AF%BB%E5%8F%96"><span class="nav-text">2. 数据块读取</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-%E5%8D%95%E5%9D%97%E6%95%B0%E6%8D%AE%E5%9D%97%E8%AF%BB%E5%8F%96%E6%B5%81%E7%A8%8B"><span class="nav-text">2.1 单块数据块读取流程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-%E5%A4%9A%E5%9D%97%E6%95%B0%E6%8D%AE%E5%9D%97%E8%AF%BB%E5%8F%96%E6%B5%81%E7%A8%8B"><span class="nav-text">2.2 多块数据块读取流程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4%E8%AF%B4%E6%98%8E"><span class="nav-text">2.3 相关命令说明</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-1-CMD17%E5%91%BD%E4%BB%A4"><span class="nav-text">2.3.1 CMD17命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-2-CMD18%E5%91%BD%E4%BB%A4"><span class="nav-text">2.3.2 CMD18命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-3-CMD12%E5%91%BD%E4%BB%A4"><span class="nav-text">2.3.3 CMD12命令</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E6%95%B0%E6%8D%AE%E5%9D%97%E5%86%99%E5%85%A5"><span class="nav-text">3. 数据块写入</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-%E5%8D%95%E5%9D%97%E6%95%B0%E6%8D%AE%E5%9D%97%E5%86%99%E5%85%A5%E6%B5%81%E7%A8%8B"><span class="nav-text">3.1 单块数据块写入流程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-%E5%A4%9A%E5%9D%97%E6%95%B0%E6%8D%AE%E5%86%99%E5%85%A5%E6%B5%81%E7%A8%8B"><span class="nav-text">3.2 多块数据写入流程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4%E8%AF%B4%E6%98%8E"><span class="nav-text">3.3 相关命令说明</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-1-CMD13%E5%91%BD%E4%BB%A4"><span class="nav-text">3.3.1 CMD13命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-2-CMD24%E5%91%BD%E4%BB%A4"><span class="nav-text">3.3.2 CMD24命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-3-ACMD23%E5%91%BD%E4%BB%A4"><span class="nav-text">3.3.3 ACMD23命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-4-CMD55%E5%91%BD%E4%BB%A4"><span class="nav-text">3.3.4 CMD55命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-5-CMD25%E5%91%BD%E4%BB%A4"><span class="nav-text">3.3.5 CMD25命令</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E8%AF%BB%E5%86%99%E5%9C%B0%E5%9D%80"><span class="nav-text">4. 读写地址</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-%E5%86%99%E5%91%BD%E4%BB%A4CMD24"><span class="nav-text">4.1 写命令CMD24</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-%E5%8D%A1%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="nav-text">4.2 卡的类型</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="苏木"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">苏木</p>
  <div class="site-description" itemprop="description">莫道桑榆晚，为霞尚满天</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">673</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">42</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">43</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/sumumm" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;sumumm" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://sumumm.github.io/post/9e4f210b.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="苏木">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="苏木">
      <meta itemprop="description" content="莫道桑榆晚，为霞尚满天">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="LV16-21-SDIO-01-SD卡基础知识 | 苏木">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          LV16-21-SDIO-01-SD卡基础知识
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-06-04 22:07:15" itemprop="dateCreated datePublished" datetime="2023-06-04T22:07:15+08:00">2023-06-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">嵌入式开发</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/" itemprop="url" rel="index"><span itemprop="name">01HQ课程体系</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">LV16-STM32开发</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>14k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>50 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>本文主要是SD卡的一些基础知识相关笔记，若笔记中有错误或者不合适的地方，欢迎批评指正😃。</p>
<span id="more"></span>

<!-- Photo: https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/ -->

<details class="folding-tag" blue><summary> 点击查看使用工具及版本 </summary>
              <div class='content'>
              <table>    <tr>        <td align="center" width=150px>Windows</td>        <td align="left">windows11</td>    </tr>    <tr>        <td align="center">Ubuntu</td>        <td align="left">Ubuntu16.04的64位版本</td>      </tr>    <tr>        <td align="center">VMware® Workstation 16 Pro</td>        <td align="left">16.2.3 build-19376536</td>      </tr>    <tr>        <td align="center">SecureCRT</td>        <td align="left">Version 8.7.2 (x64 build 2214)   -   正式版-2020年5月14日</td>      </tr>    <tr>        <td align="center">开发板</td>        <td align="left">正点原子 i.MX6ULL Linux阿尔法开发板</td>      </tr>    <tr>        <td align="center">uboot</td>        <td align="left">NXP官方提供的uboot，NXP提供的版本为uboot-imx-rel_imx_4.1.15_2.1.0_ga(使用的uboot版本为U-Boot 2016.03)</td>      </tr>    <tr>        <td align="center">linux内核</td>        <td align="left">linux-4.15(NXP官方提供)</td>      </tr>    <tr>        <td align="center">STM32开发板</td>        <td align="left">正点原子战舰V3(STM32F103ZET6)</td>      </tr></table>
              </div>
            </details>

<details class="folding-tag" blue><summary> 点击查看本文参考资料 </summary>
              <div class='content'>
              <ul><li>通用</li></ul><table><tr><td align="center">分类  </td><td align="center">网址</td><td align="center">说明</td></tr><tr><td align="center" rowspan="4">官方网站</td><td align="left"><a href="https://www.arm.com/" target="_blank">https://www.arm.com/</a></td><td align="left">ARM官方网站，在这里我们可以找到Cotex-Mx以及ARMVx的一些文档</td></tr><tr>                                            <td align="left"><a href="https://www.st.com/content/st_com/zh.html" target="_blank">https://www.st.com/content/st_com/zh.html</a></td><td align="left">ST官方网站，在这里我们可以找到STM32的相关文档</td></tr><tr>                                            <td align="left"><a href="https://www.stmcu.com.cn/" target="_blank">https://www.stmcu.com.cn/</a></td><td align="left">意法半导体ST中文官方网站，在这里我们可以找到STM32的相关中文参考文档</td></tr><tr>                                            <td align="left"><a href="http://elm-chan.org/fsw/ff/00index_e.html" target="_blank">http://elm-chan.org/fsw/ff/00index_e.html</a></td><td align="left">FatFs文件系统官网</td></tr><tr><td align="center" rowspan="3">教程书籍</td><td align="left"><a href="STM32开发相关资料/01ARM参考资料/ARM Cortex-M3权威指南(中文).pdf" target="_blank">《ARM Cortex-M3权威指南》</a></td><td alirn="left" rowspan="3">ARM公司专家Joseph Yiu（姚文祥）的力作，中文翻译是NXP的宋岩</td></tr><tr>                                            <td align="left"><a href="STM32开发相关资料/01ARM参考资料/ARM Cortex-M0权威指南(中文).pdf" target="_blank">《ARM Cortex-M0权威指南》</a></td></tr><tr>                                            <td align="left"><a href="" target="_blank">《ARM Cortex-M3与Cortex-M4权威指南》</a></td></tr><tr><td align="center" rowspan="4">开发论坛</td><td align="left"><a href="http://47.111.11.73/forum.php" target="_blank">http://47.111.11.73/forum.php</a></td><td align="left">开源电子网，正点原子的资料下载及问题讨论论坛</td></tr><tr>                                            <td align="left"><a href="https://www.firebbs.cn/forum.php" target="_blank">https://www.firebbs.cn/forum.php</a></td><td align="left">国内Kinetis开发板-野火/秉火（刘火良）主持的论坛，现也做STM32和i.MX RT</td></tr><tr>                                            <td align="left"><a href="https://www.amobbs.com/index.php" target="_blank">https://www.amobbs.com/index.php</a></td><td align="left">阿莫（莫进明）主持的论坛，号称国内最早最火的电子论坛，以交流Atmel AVR系列单片机起家，现已拓展到嵌入式全平台，其STM32系列帖子有70W+。</td></tr><tr>                                            <td align="left"><a href="http://download.100ask.net/index.html" target="_blank">http://download.100ask.net/index.html</a></td><td align="left">韦东山嵌入式资料中心，有些STM32和linux的相关资料也可以来这里找。</td></tr><tr><td align="center" rowspan="3">博客参考</td><td align="left"><a href="http://www.openedv.com/" target="_blank">http://www.openedv.com/</a></td><td align="left">开源网-原子哥个人博客</td></tr><tr>                                            <td align="left"><a href="http://blog.chinaaet.com/jihceng0622" target="_blank">http://blog.chinaaet.com/jihceng0622</a></td><td align="left">博主是原Freescale现NXP的现场应用工程师</td></tr><tr>                                            <td align="left"><a href="https://community.arm.com/arm-community-blogs/b/architectures-and-processors-blog/posts/cortex-m-resources" target="_blank">cortex-m-resources</a></td><td align="left">这其实并不算是一个博客，这是ARM公司专家Joseph Yiu收集整理的所有对开发者有用的官方Cortex-M资料链接（也包含极少数外部资源链接）</td></tr></table><ul><li>STM32</li></ul><table>    <tr><td align="center" rowspan="2">STM32</td><td align="left"><a href="https://doc.embedfire.com/mcu/stm32/f103/hal_general/zh/latest/index.html" target="_blank">STM32 HAL库开发实战指南——基于F103系列开发板</a></td><td align="left">野火STM32开发教程在线文档</td></tr><tr>                                            <td align="left"><a href="https://doc.embedfire.com/mcu/stm32/f103badao/std/zh/latest/index.html" target="_blank">STM32库开发实战指南——基于野火霸道开发板</a></td><td align="left">野火STM32开发教程在线文档</td></tr></table><ul><li>SD卡</li></ul><table>    <tr><td align="left"><a href="https://www.sdcard.org/" target="_blank">SD Association</a></td><td align="left">提供了SD存储卡和SDIO卡系统规范</td></tr></table>
              </div>
            </details>

<details class="folding-tag" blue><summary> 点击查看相关文件下载 </summary>
              <div class='content'>
              <table>    <tr><td align="left"><a href="https://www.st.com/resource/en/datasheet/stm32f103ze.pdf" target="_blank">STM32F103xx英文数据手册</a></td><td align="left">STM32F103xC/D/E系列的英文数据手册</td></tr>    <tr><td align="left"><a href="https://www.stmcu.com.cn/Designresource/detail/localization_document%20/709978" target="_blank">STM32F103xx中文数据手册</a></td><td align="left">STM32F103xC/D/E系列的中文数据手册</td></tr>    <tr><td align="left"><a href="https://www.st.com/resource/en/reference_manual/rm0008-stm32f101xx-stm32f102xx-stm32f103xx-stm32f105xx-and-stm32f107xx-advanced-armbased-32bit-mcus-stmicroelectronics.pdf" target="_blank">STM32F10xxx英文参考手册（RM0008）</a></td><td align="left">STM32F10xxx系列的英文参考手册</td></tr>    <tr><td align="left"><a href="https://www.stmcu.com.cn/Designresource/detail/localization_document%20/710001" target="_blank">STM32F10xxx中文参考手册（RM0008）</a></td><td align="left">STM32F10xxx系列的中文参考手册</td></tr>    <tr><td align="left"><a href="https://developer.arm.com/documentation/100165/0201/?lang=en" target="_blank">Arm Cortex-M3 处理器技术参考手册-英文版</a></td><td align="left">Cortex-M3技术参考手册-英文版</td></tr>    <tr><td align="left"><a href="https://www.st.com/resource/en/programming_manual/pm0056-stm32f10xxx20xxx21xxxl1xxxx-cortexm3-programming-manual-stmicroelectronics.pdf" target="_blank">STM32F10xxx Cortex-M3编程手册-英文版(PM0056)</a></td><td align="left">STM32F10xxx/20xxx/21xxx/L1xxxx系列Cortex-M3编程手册-英文版</td></tr>    <tr><td align="left"><a href="https://www.sdcard.org/downloads/pls/" target="_blank">SD卡相关资料——最新版本</a></td><td align="left">有关SD卡的一些资料可以从这里下载</td></tr>    <tr><td align="left"><a href="https://www.sdcard.org/downloads/pls/archives/" target="_blank">SD卡相关资料——历史版本</a></td><td align="left">有关SD卡的一些历史版本资料可以从这里下载，比如后边看的SD卡2.0协议</td></tr>    <tr><td align="left"><a href="./" target="_blank">SD 2.0 协议标准完整版</a></td><td align="left">这是一篇关于SD卡2.0协议的中文文档，还是比较有参考价值的，可以一看</td></tr></table>
              </div>
            </details>

<p>这篇笔记主要看的是文档 <a target="_blank" rel="noopener" href="https://www.sdcard.org/downloads/pls/pdf/?p=Part1_Physical_Layer_Simplified_Specification_Ver9.00.jpg&f=Part1_Physical_Layer_Simplified_Specification_Ver9.00.pdf&e=EN_SS1_9">Physical Layer Simplified Specification v9.0</a> ，但其实应该看文档<a target="_blank" rel="noopener" href="https://www.sdcard.org/downloads/pls/pdf/?p=Part1_Physical_Layer_Simplified_Specification_Ver2.00.jpg&f=Part1_Physical_Layer_Simplified_Specification_Ver2.00.pdf&e=EN_P1200">Physical Layer Simplified Specification v2.0</a>可能会更好一些，虽然他们基本是一样的（因为后边好像说是STM32做多支持到2.0版本的SD卡）。</p>
<h1 id="一、SD卡简介"><a href="#一、SD卡简介" class="headerlink" title="一、SD卡简介"></a><font size=3>一、SD卡简介</font></h1><h2 id="1-什么是SD卡？"><a href="#1-什么是SD卡？" class="headerlink" title="1. 什么是SD卡？"></a><font size=3>1. 什么是SD卡？</font></h2><p> SD卡（Secure Digital Memory Card）即：安全数码卡，它是在MMC的基础上发展而来，是一种基于半导体快闪记忆器的新一代记忆设备，是SD协会开发的一种专有 的非易失性 存储卡格式，用于便携式设备。由于它体积小、数据传输速度快、可热插拔等优良的特性，被广泛地于便携式装置上使用，例如数码相机、个人数码助理(PDA)和多媒体播放器等。</p>
<p>SD卡由日本松下、东芝及美国SanDisk公司于1999年8月共同开发研制。作为对MultiMediaCard（MMC）的改进，现已成为行业标准。这三家公司组成了SD-3C，LLC，这家公司许可并执行与SD存储卡以及SD主机和辅助产品相关的知识产权。两家公司还于2000年1月成立了非营利组织SD协会（SDA），以促进和创建SD卡标准。SDA如今有大约1,000个成员公司。SDA使用SD-3C拥有并许可的多个商标徽标，以强制遵守其规范并确保用户的兼容性。</p>
<h2 id="2-长啥样？"><a href="#2-长啥样？" class="headerlink" title="2. 长啥样？"></a><font size=3>2. 长啥样？</font></h2><p>这样的话，我们就去某宝看一看吧：</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230509221123178.png" alt="image-20230509221123178" style="zoom:50%;" />

<p>我们搜索关键词，就会出现下边这些类型的，我们会发现，似乎有两种形状，一种比较大，一种比较小，但是简介好像都叫SD卡。那就来了解一下吧。</p>
<h3 id="2-1-TF卡"><a href="#2-1-TF卡" class="headerlink" title="2.1 TF卡"></a><font size=3>2.1 TF卡</font></h3><p>Micro SD Card，原名Trans-flashCard（TF卡），2004年正式更名为MicroSD Card，由SanDisk（闪迪）公司发明。MicroSD卡是一种极细小的快闪存储器卡，其格式源自SanDisk创造，原本这种记忆卡称为T-Flash，及后改称为TransFlash；而重新命名为MicroSD的原因是因为被SD协会(SDA) 采立。</p>
<p>它的体积为15mm x 11mm x1mm，差不多相等于手指甲的大小，是现时最细小的记忆卡。它也能通过SD转接卡来接驳于SD卡插槽中使用。现时MicroSD卡提供128MB、256MB、512MB、1G、2G、4G、8G、16G、32G、64G、128G的容量(MWC2014 世界移动通信大会期间，SanDisk（闪迪）打破了储存卡最高64GB容量的传统，正式发布了一款容量高达128GB的Micro SD XC 储存卡。</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230509221531248.png" alt="image-20230509221531248" style="zoom:50%;" />

<h3 id="2-2-SD卡"><a href="#2-2-SD卡" class="headerlink" title="2.2 SD卡"></a><font size=3>2.2 SD卡</font></h3><p> SD卡（Secure Digital Memory Card）即：安全数码卡，就前边介绍的那样，俗称大卡，是一种发展时间比较久的内存卡，SD卡的标准尺寸为24mm×32mm×2.1mm。</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230509221736652.png" alt="image-20230509221736652" style="zoom:50%;" />

<h3 id="2-3-TF卡转SD卡？"><a href="#2-3-TF卡转SD卡？" class="headerlink" title="2.3 TF卡转SD卡？"></a><font size=3>2.3 TF卡转SD卡？</font></h3><p>MicroSD的体积更小且可以转换SD卡使用，TF卡的电路和引脚和SD卡是一样的。TF卡可经SD卡转换器后，当SD卡使用，SD卡在一般情况下无法转换成TF卡，毕竟大小在哪摆着。</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230509222233994.png" alt="image-20230509222233994" style="zoom:50%;" />





<h2 id="3-官方宣传册？"><a href="#3-官方宣传册？" class="headerlink" title="3. 官方宣传册？"></a><font size=3>3. 官方宣传册？</font></h2><p>这一部人可以查看官方网站的宣传册：<a target="_blank" rel="noopener" href="https://www.sdcard.org/pdf/SDA_brochure_EN.pdf">SDA_brochure_EN.pdf</a>，这个具体的还是看在线文档吧，简单了解一下，对后边自己购买SD卡也有帮助，比如SD卡上边标注的 class等参数是什么意思？</p>
<h2 id="4-SD卡分类"><a href="#4-SD卡分类" class="headerlink" title="4. SD卡分类"></a><font size=3>4. SD卡分类</font></h2><p>SD卡按容量分类，可以分为3类：SD卡、SDHC卡、SDXC卡，如下表所示：</p>
<table>
<thead>
<tr>
<th><strong>容量</strong></th>
<th><strong>命名</strong></th>
<th><strong>简称</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>0~2G</strong></td>
<td>Standard Capacity SD Memory Card</td>
<td>SDSC或SD</td>
</tr>
<tr>
<td><strong>2G~32G</strong></td>
<td>High Capacity SD Memory Card</td>
<td>SDHC</td>
</tr>
<tr>
<td><strong>32G~2T</strong></td>
<td>Extended Capacity SD Memory Card</td>
<td>SDXC</td>
</tr>
</tbody></table>
<p>这个其实在文档 <a target="_blank" rel="noopener" href="https://www.sdcard.org/downloads/pls/pdf/?p=Part1_Physical_Layer_Simplified_Specification_Ver9.00.jpg&f=Part1_Physical_Layer_Simplified_Specification_Ver9.00.pdf&e=EN_SS1_9">Physical Layer Simplified Specification v9.0</a> 的 2. System Features一节中的Capacity of Memory部分有说明。</p>
<h1 id="二、SD卡物理结构"><a href="#二、SD卡物理结构" class="headerlink" title="二、SD卡物理结构"></a><font size=3>二、SD卡物理结构</font></h1><h2 id="1-包含哪些？"><a href="#1-包含哪些？" class="headerlink" title="1. 包含哪些？"></a><font size=3>1. 包含哪些？</font></h2><p>这张图我们可以查看 文档 <a target="_blank" rel="noopener" href="https://www.sdcard.org/downloads/pls/pdf/?p=Part1_Physical_Layer_Simplified_Specification_Ver9.00.jpg&f=Part1_Physical_Layer_Simplified_Specification_Ver9.00.pdf&e=EN_SS1_9">Physical Layer Simplified Specification v9.0</a> 的 3.7 SD Memory Card-Pins and Registers一节。</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230509223200913.png" alt="image-20230509223200913" style="zoom:50%;" />

<p>一张SD卡包括有存储单元、存储单元接口、电源检测、卡及接口控制器和接口驱动器5个部分 ：</p>
<p>（1）存储单元是存储数据部件，存储单元通过存储单元接口与卡控制单元进行数据传输，这一部分属于NAND FLASH；</p>
<p>（2）电源检测单元保证SD卡工作在合适的电压下，如出现掉电或上状态时，它会使控制单元和存储单元接口复位；</p>
<p>（3）卡及接口控制单元控制SD卡的运行状态，它包括有8个寄存器用于设定或表示SD卡信息。这些寄存器只能通过对应的命令访问， 一共定义有64个命令，每个命令都有特殊意义，可以实现某一特定功能， SD卡接收到命令后，根据命令要求对SD卡内部寄存器进行修改，程序控制中只需要发送组合命令就可以实现SD卡的控制以及读写操作。 </p>
<p>（4）接口驱动器控制SD卡引脚的输入输出 。</p>
<h2 id="2-寄存器简介"><a href="#2-寄存器简介" class="headerlink" title="2. 寄存器简介"></a><font size=3>2. 寄存器简介</font></h2><table>
<thead>
<tr>
<th>名称</th>
<th>bit宽度</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>CID</td>
<td>128</td>
<td>卡识别号(Card identification number)：用来识别的卡的个体号码(唯一的)</td>
</tr>
<tr>
<td>RCA</td>
<td>16</td>
<td>相对地址(Relative card address)：卡的本地系统地址，初始化时，动态地由卡建议，主机核准。</td>
</tr>
<tr>
<td>DSR</td>
<td>16</td>
<td>驱动级寄存器(Driver Stage Register)：配置卡的输出驱动</td>
</tr>
<tr>
<td>CSD</td>
<td>128</td>
<td>卡的特定数据(Card Specific Data)：卡的操作条件信息</td>
</tr>
<tr>
<td>SCR</td>
<td>64</td>
<td>SD配置寄存器(SD Configuration Register)：SD 卡特殊特性信息</td>
</tr>
<tr>
<td>OCR</td>
<td>32</td>
<td>操作条件寄存器(Operation conditions register)</td>
</tr>
<tr>
<td>SSR</td>
<td>512</td>
<td>SD状态(SD Status)：SD卡专有特征的信息</td>
</tr>
<tr>
<td>CSR</td>
<td>32</td>
<td>卡状态(Card Status)：卡状态信息</td>
</tr>
</tbody></table>
<p>每个寄存器的含义我们可以参考 文档 <a target="_blank" rel="noopener" href="https://www.sdcard.org/downloads/pls/pdf/?p=Part1_Physical_Layer_Simplified_Specification_Ver9.00.jpg&f=Part1_Physical_Layer_Simplified_Specification_Ver9.00.pdf&e=EN_SS1_9">Physical Layer Simplified Specification v9.0</a> 的 5.Card Registers，里边有对每个寄存器的详细描述。这里选几个重要的，我们可能会用到的说明一下。</p>
<p>（1）CID ：就是一个卡识别号，每一张卡的号都是唯一的，厂家生产SD卡的时候，需要向SD卡的那个标准组织购买卡号的，所以每一张的卡识别号都应该是唯一的。包括有提供制造商ID、OEM&#x2F;应用ID、产品名称、版本、序列号、制造日期等信息。</p>
<p>（2）CID ：相对地址，这个主要是因为CID太长了，有128位，每一次通讯都通过这么长的CID号来查找是要跟哪一张SD卡通信的话，就比较麻烦了，所以出现了相对地址，那什么是相对地址呢？比如我们在STM32上边接了两张SD卡，这样我们就可以将第一张相对地址指定为0，第二张指定为1，这样就很好区分啦。可动态变化，在主机初始化的时候确定。（仅SDIO模式下有，SPI模式下无RCA）</p>
<p>（3）SSR：包含了这一张SD卡的一些专有特征信息，比如读写的基本单位，块的大小这些信息。</p>
<p>（4）CSR：卡状态寄存器，我们可以从这里获取SD卡的擦除状态啊，写入状态啊，是否需要等待啊这些状态。</p>
<h1 id="三、SD卡总线及协议"><a href="#三、SD卡总线及协议" class="headerlink" title="三、SD卡总线及协议"></a><font size=3>三、SD卡总线及协议</font></h1><h2 id="1-SDIO接口？"><a href="#1-SDIO接口？" class="headerlink" title="1. SDIO接口？"></a><font size=3>1. SDIO接口？</font></h2><p>SD卡一般都支持SDIO和SPI这两种接口，支持SPI和SDIO两种模式：不同模式下，SD卡引脚功能描述如下表所示：</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230509225102180.png" alt="image-20230509225102180" style="zoom:67%;" />

<p>需要注意的是TF卡+卡套，组合起来也可以当SD卡用，不过，很大一部分TF卡，不支持SPI访问模式。所以，SPI驱动SD卡的时候，尽量选择大卡(SD卡)，而不要选择TF卡。在这里我们只学习SDIO接口操作方式， SD卡与SDIO接口示意图如下  </p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230509225145717.png" alt="image-20230509225145717" style="zoom:50%;" />

<p>SD卡使用9-pin接口通信，其中3根电源线、 1根时钟线、 1根命令线和4根数据线，具体如下：  </p>
<table>
<thead>
<tr>
<th>信号线</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>CLK</td>
<td>时钟线，由SDIO主机产生，即由STM32控制器输出；</td>
</tr>
<tr>
<td>CMD</td>
<td>命令控制线， SDIO主机通过该线发送命令控制SD卡，如果命令要求SD，卡提供应答， SD卡也是通过该线传输应答信息；</td>
</tr>
<tr>
<td>D0-3</td>
<td>数据线，传输读写数据； SD卡可将D0拉低表示忙状态；</td>
</tr>
<tr>
<td>VDD、 VSS1、 VSS2</td>
<td>电源和地信号</td>
</tr>
</tbody></table>
<p>SDIO的通信时序的物理逻辑非常简单， SDIO不管是从主机控制器向SD卡传输，还是SD卡向主机控制器传输都只以CLK时钟线的上升沿为有效。SD卡操作过程会使用两种不同频率的时钟同步数据，一个是识别卡阶段时钟频率FOD，最高为400kHz； 另外一个是数据传输模式下时钟频率FPP，默认最高为25MHz，如果通过相关寄存器配置使SDIO工作在高速模式，此时数据传输模式最高频率为50MHz。  </p>
<h2 id="2-总线协议"><a href="#2-总线协议" class="headerlink" title="2. 总线协议"></a><font size=3>2. 总线协议</font></h2><p>关于总线协议，我们可以参考文档 <a target="_blank" rel="noopener" href="https://www.sdcard.org/downloads/pls/pdf/?p=Part1_Physical_Layer_Simplified_Specification_Ver9.00.jpg&f=Part1_Physical_Layer_Simplified_Specification_Ver9.00.pdf&e=EN_SS1_9">Physical Layer Simplified Specification v9.0</a> 的 3.6 Bus Protocol章节。</p>
<h3 id="2-1-命令与响应"><a href="#2-1-命令与响应" class="headerlink" title="2.1 命令与响应"></a><font size=3>2.1 命令与响应</font></h3><p>SD总线通信是基于命令和数据传输的。通讯由一个起始位(“0” )，由一个停止位(“1” )终止。 SD通信一般是主机发送一个命令(Command)，从设备在接收到命令后作出响应(Response)，如有需要会有数据(Data)传输参与。  </p>
<p>命令与响应交互的过程如下图：</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230509225556057.png" alt="image-20230509225556057" style="zoom:50%;" />

<h3 id="2-2-带数据块的通信"><a href="#2-2-带数据块的通信" class="headerlink" title="2.2 带数据块的通信"></a><font size=3>2.2 带数据块的通信</font></h3><p>SD数据是以块(Black)形式传输的， SDHC卡数据块长度一般为512字节，数据可以从主机到卡，也可以是从卡到主机。数据块需要CRC位来保证数据传输成功。 CRC位由SD卡系统硬件生成。 STM32控制器可以控制使用单线或4线传输。  </p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230509225712028.png" alt="image-20230509225712028" style="zoom: 36%;" />

<h3 id="2-3-单块和多块的通信"><a href="#2-3-单块和多块的通信" class="headerlink" title="2.3 单块和多块的通信"></a><font size=3>2.3 单块和多块的通信</font></h3><p>SD数据传输支持单块和多块读写，它们分别对应不同的操作命令，多块写入还需要使用命令来停止整个写入操作。数据写入前需要检测SD卡忙状态，因为SD卡在接收到数据后编程到存储区过程需要一定操作时间。 SD卡忙状态通过把D0线拉低表示。  数据块读操作与之类似，只是无需忙状态检测。  </p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230509225818883.png" alt="image-20230509225818883" style="zoom:37%;" />

<h3 id="2-4-数据位什么传输？"><a href="#2-4-数据位什么传输？" class="headerlink" title="2.4 数据位什么传输？"></a><font size=3>2.4 数据位什么传输？</font></h3><p>使用4数据线传输时，每次传输4bit数据，每根数据线都必须有起始位、终止位以及CRC位， CRC位每根数据线都要分别检查，并把检查结果汇总然后在数据传输完后通过D0线反馈给主机。  </p>
<p>SD卡数据包有两种格式，一种是常规数据(8bit宽)，它先发低字节再发高字节，而每个字节则是先发高位再发低位， 4线传输示意如下图：  </p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230509225906879.png" alt="image-20230509225906879" style="zoom:50%;" />

<p>另外一种数据包发送格式是宽位数据包格式，对SD卡而言宽位数据包发送方式是针对SD卡SSR(SD状态)寄存器内容发送的， SSR寄存器总共有512bit，在主机发出ACMD13命令后SD卡将SSR寄存器内容通过DAT线发送给主机。宽位数据包格式示意图如下：  </p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230509225926471.png" alt="image-20230509225926471" style="zoom:50%;" />

<h1 id="四、SD卡命令"><a href="#四、SD卡命令" class="headerlink" title="四、SD卡命令"></a><font size=3>四、SD卡命令</font></h1><p>SD命令由主机发出，以广播命令和寻址命令为例，广播命令是针对与SD主机总线连接的所有从设备发送的，寻址命令是指定某个地址设备进行命令传输。这一章的内容我们可以参考文档 <a target="_blank" rel="noopener" href="https://www.sdcard.org/downloads/pls/pdf/?p=Part1_Physical_Layer_Simplified_Specification_Ver9.00.jpg&f=Part1_Physical_Layer_Simplified_Specification_Ver9.00.pdf&e=EN_SS1_9">Physical Layer Simplified Specification v9.0</a> 的 4.7 Commands  章节。 </p>
<h2 id="1-命令格式"><a href="#1-命令格式" class="headerlink" title="1. 命令格式"></a><font size=3>1. 命令格式</font></h2><p>SD命令格式固定为48bit，都是通过CMD线连续传输的， 数据线不参与。  </p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510194931239.png" alt="image-20230510194931239" style="zoom:50%;" />

<p>SD命令的组成如下：</p>
<p>（1）起始位和终止位：命令的主体包含在起始位与终止位之间，它们都只包含一个数据位，起始位为0，终止位为1。</p>
<p>（2）传输标志：用于区分传输方向，该位为1时表示命令，方向为主机传输到SD卡，该位为0时表示响应，方向为SD卡传输到主机。</p>
<p>（3）命令主体内容： 命令主体内容包括命令、地址信息&#x2F;参数和CRC校验三个部分。  </p>
<blockquote>
<p>命令主体内容的三个部分说明如下：</p>
<p>命令号：它固定占用6bit，所以总共有64个命令(代号：CMD0~CMD63)，每个命令都有特定的用途，部分命令不适用于SD卡操作，只是专门用于MMC卡或者SD I&#x2F;O卡。</p>
<p>地址&#x2F;参数：每个命令有32bit地址信息&#x2F;参数用于命令附加内容，例如，广播命令没有地址信息，这32bit用于指定参数，而寻址命令这32bit用于指定目标SD卡的地址。    </p>
<p>CRC7校验：长度为7bit的校验位用于验证命令传输内容正确性，如果发生外部干扰导致传输数据个别位状态改变将导致校准失败，也意味着命令传输失败， SD卡不执行命令。  </p>
</blockquote>
<h2 id="2-命令类型"><a href="#2-命令类型" class="headerlink" title="2. 命令类型  "></a><font size=3>2. 命令类型  </font></h2><p>SD命令有4种类型：</p>
<p>（1）无响应广播命令(bc)，发送到所有卡，不返回任务响应；</p>
<p>（2）带响应广播命令(bcr)，发送到所有卡，同时接收来自所有卡响应；</p>
<p>（3）寻址命令(ac)，发送到选定卡， DAT线无数据传输；</p>
<p>（4）寻址数据传输命令(adtc)，发送到选定卡， DAT线有数据传输。  </p>
<p>另外， SD卡主机模块系统旨在为各种应用程序类型提供一个标准接口。在此环境中，需要有特定的客户&#x2F;应用程序功能。为实现这些功能，在标准中定义了两种类型的通用命令： **特定应用命令(ACMD)和常规命令(GEN_CMD)**。 要使用SD卡制造商特定的ACMD命令如ACMD6，需要在发送该命令之前无发送CMD55命令，告知SD卡接下来的命令为特定应用命令。 CMD55命令只对紧接的第一个命令有效，SD卡如果检测到CMD55之后的第一条命令为ACMD则执行其特定应用功能，如果检测发现不是ACMD命令，则执行标准命令。  </p>
<h2 id="3-命令描述"><a href="#3-命令描述" class="headerlink" title="3. 命令描述"></a><font size=3>3. 命令描述</font></h2><p>接下来我们来学习一下SD卡部分命令信息，更多详细信息可以参考SD简易规格文件说明，表中填充位和保留位都必须被设置为0。这一部分详细可以参考文档 <a target="_blank" rel="noopener" href="https://www.sdcard.org/downloads/pls/pdf/?p=Part1_Physical_Layer_Simplified_Specification_Ver9.00.jpg&f=Part1_Physical_Layer_Simplified_Specification_Ver9.00.pdf&e=EN_SS1_9">Physical Layer Simplified Specification v9.0</a> 的  4.7.4 Detailed command Description 一节。注意后边列举命令的时候是将保留的命令给去掉了。</p>
<h3 id="3-1-基本命令-Class-0"><a href="#3-1-基本命令-Class-0" class="headerlink" title="3.1 基本命令(Class 0)"></a><font size=3>3.1 基本命令(Class 0)</font></h3><table>
<thead>
<tr>
<th>命令序号</th>
<th>类型</th>
<th>参数</th>
<th>响应</th>
<th>缩写</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>CMD0</td>
<td>bc</td>
<td>[31:0]填充位</td>
<td>-</td>
<td>GO_IDLE_STATE</td>
<td>复位所有的卡到idle状态。</td>
</tr>
<tr>
<td>CMD2</td>
<td>bcr</td>
<td>[31:0]填充位</td>
<td>R2</td>
<td>ALL_SEND_CID</td>
<td>通知所有卡通过CMD线返回CID值。</td>
</tr>
<tr>
<td>CMD3</td>
<td>bcr</td>
<td>[31:0]填充位</td>
<td>R6</td>
<td>SEND_RELATIVE_ADDR</td>
<td>通知所有卡发布新RCA。</td>
</tr>
<tr>
<td>CMD4</td>
<td>bc</td>
<td>[31:16]DSR[15:0]填充位</td>
<td>-</td>
<td>SET_DSR</td>
<td>编程所有卡的DSR。</td>
</tr>
<tr>
<td>CMD7</td>
<td>ac</td>
<td>[31:16]RCA[15:0]填充位</td>
<td>R1b</td>
<td>SELECT&#x2F;DESELECT_CARD</td>
<td>选择&#x2F;取消选择RCA地址卡。</td>
</tr>
<tr>
<td>CMD8</td>
<td>bcr</td>
<td>[31:12]保留位[11:8]VHS[7:0]检查模式</td>
<td>R7</td>
<td>SEND_IF_COND</td>
<td>发送SD卡接口条件， 包含主机支持的电压信息， 并询问卡是否支持。</td>
</tr>
<tr>
<td>CMD9</td>
<td>ac</td>
<td>[31:16]RCA[15:0]填充位</td>
<td>R2</td>
<td>SEND_CSD</td>
<td>选定卡通过CMD线发送CSD内容</td>
</tr>
<tr>
<td>CMD10</td>
<td>ac</td>
<td>[31:16]RCA[15:0]填充位</td>
<td>R2</td>
<td>SEND_CID</td>
<td>选定卡通过CMD线发送CID内容</td>
</tr>
<tr>
<td>CMD12</td>
<td>ac</td>
<td>[31:0]填充位</td>
<td>R1b</td>
<td>STOP_TRANSMISSION</td>
<td>强制卡停止传输</td>
</tr>
<tr>
<td>CMD13</td>
<td>ac</td>
<td>[31:16]RCA[15:0]填充位</td>
<td>R1</td>
<td>SEND_STATUS</td>
<td>选定卡通过CMD线发送它状态寄存器</td>
</tr>
<tr>
<td>CMD15</td>
<td>ac</td>
<td>[31:16]RCA[15:0]填充位</td>
<td>-</td>
<td>GO_INACTIVE_STATE</td>
<td>使选定卡进入“inactive” 状态</td>
</tr>
</tbody></table>
<h3 id="3-2-面向块的读操作-Class-2"><a href="#3-2-面向块的读操作-Class-2" class="headerlink" title="3.2 面向块的读操作(Class 2)"></a><font size=3>3.2 面向块的读操作(Class 2)</font></h3><table>
<thead>
<tr>
<th>命令序号</th>
<th>类型</th>
<th>参数</th>
<th>响应</th>
<th>缩写</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>CMD16</td>
<td>ac</td>
<td>[31:0]块长度</td>
<td>R1</td>
<td>SET_BLOCK_LEN</td>
<td>对于标准SD卡， 设置块命令的长度， 对于SDHC卡块命令长度固定为512字节。</td>
</tr>
<tr>
<td>CMD17</td>
<td>adtc</td>
<td>[31:0]数据地址</td>
<td>R1</td>
<td>READ_SINGLE_BLOCK</td>
<td>对于标准卡， 读取SEL_BLOCK_LEN长度字节的块；对于SDHC卡， 读取512字 节的块。</td>
</tr>
<tr>
<td>CMD18</td>
<td>adtc</td>
<td>[31:0]数据地址</td>
<td>R1</td>
<td>READ_MULTIPLE_BLOCK</td>
<td>连续从SD卡读取数据块， 直到被CMD12中断。 块长度同CMD17。</td>
</tr>
</tbody></table>
<h3 id="3-3-面向块的写操作-Class-4"><a href="#3-3-面向块的写操作-Class-4" class="headerlink" title="3.3 面向块的写操作(Class 4)"></a><font size=3>3.3 面向块的写操作(Class 4)</font></h3><table>
<thead>
<tr>
<th>命令序号</th>
<th>类型</th>
<th>参数</th>
<th>响应</th>
<th>缩写</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>CMD24</td>
<td>adtc</td>
<td>[31:0]数据地址</td>
<td>R1</td>
<td>WRITE_BLOCK</td>
<td>对于标准卡， 写入SEL_BLOCK_LEN长度字节的块；对于SDHC卡， 写入512字 节的块。</td>
</tr>
<tr>
<td>CMD25</td>
<td>adtc</td>
<td>[31:0]数据地址</td>
<td>R1</td>
<td>WRITE_MILTIPLE_BLOCK</td>
<td>连续向SD卡写入数据块， 直到被CMD12中断。 每块长度同CMD17。</td>
</tr>
<tr>
<td>CMD27</td>
<td>adtc</td>
<td>[31:0]填充位</td>
<td>R1</td>
<td>PROGRAM_CSD</td>
<td>对CSD的可编程位进行编程</td>
</tr>
</tbody></table>
<h3 id="3-4-擦除命令-Class-5"><a href="#3-4-擦除命令-Class-5" class="headerlink" title="3.4 擦除命令(Class 5)"></a><font size=3>3.4 擦除命令(Class 5)</font></h3><table>
<thead>
<tr>
<th>命令序号</th>
<th>类型</th>
<th>参数</th>
<th>响应</th>
<th>缩写</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>CMD32</td>
<td>ac</td>
<td>[31:0]数据地址</td>
<td>R1</td>
<td>ERASE_WR_BLK_START</td>
<td>设置擦除的起始块地址</td>
</tr>
<tr>
<td>CMD33</td>
<td>ac</td>
<td>[31:0]数据地址</td>
<td>R1</td>
<td>ERASE_WR_BLK_END</td>
<td>设置擦除的结束块地址</td>
</tr>
<tr>
<td>CMD38</td>
<td>ac</td>
<td>[31:0]填充位</td>
<td>R1b</td>
<td>ERASE</td>
<td>擦除预先选定的块</td>
</tr>
</tbody></table>
<h3 id="3-5-加锁命令-Class-7"><a href="#3-5-加锁命令-Class-7" class="headerlink" title="3.5 加锁命令(Class 7)"></a><font size=3>3.5 加锁命令(Class 7)</font></h3><table>
<thead>
<tr>
<th>命令序号</th>
<th>类型</th>
<th>参数</th>
<th>响应</th>
<th>缩写</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>CMD42</td>
<td>adtc</td>
<td>[31:0]保留</td>
<td>R1</td>
<td>LOCK_UNLOCK</td>
<td>加锁&#x2F;解锁SD卡</td>
</tr>
</tbody></table>
<h3 id="3-6-特定应用命令-Class-8"><a href="#3-6-特定应用命令-Class-8" class="headerlink" title="3.6 特定应用命令(Class 8)"></a><font size=3>3.6 特定应用命令(Class 8)</font></h3><table>
<thead>
<tr>
<th>命令序号</th>
<th>类型</th>
<th>参数</th>
<th>响应</th>
<th>缩写</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>CMD55</td>
<td>ac</td>
<td>[31:16]RCA[15:0]填充位</td>
<td>R1</td>
<td>APP_CMD</td>
<td>指定下个命令为特定应用命令， 不是标准命令</td>
</tr>
<tr>
<td>CMD56</td>
<td>adtc</td>
<td>[31:1]填充位[0]读&#x2F;写</td>
<td>R1</td>
<td>GEN_CMD</td>
<td>通用命令， 或者特定应用命令中， 用于传输一个数据块， 最低位为1表示读数据 ， 为0表示写数据</td>
</tr>
</tbody></table>
<h3 id="3-7-SD卡特定应用命令"><a href="#3-7-SD卡特定应用命令" class="headerlink" title="3.7 SD卡特定应用命令"></a><font size=3>3.7 SD卡特定应用命令</font></h3><table>
<thead>
<tr>
<th>命令序号</th>
<th>类型</th>
<th>参数</th>
<th>响应</th>
<th>缩写</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>ACMD6</td>
<td>ac</td>
<td>[31:2]填充位[1:0]总线宽度</td>
<td>R1</td>
<td>SET_BUS_WIDTH</td>
<td>定义数据总线宽度(‘00’&#x3D;1bit,’10’&#x3D;4bit)。</td>
</tr>
<tr>
<td>ACMD13</td>
<td>adtc</td>
<td>[31:0]填充位</td>
<td>R1</td>
<td>SD_STATUS</td>
<td>发送SD状态</td>
</tr>
<tr>
<td>ACMD41</td>
<td>bcr</td>
<td>[32]保留位[30]HCS(OCR[30]) [29:24]保留 位[23:0]VDD电压(OCR[23:0])</td>
<td>R3</td>
<td>SD_SEND_OP_COND</td>
<td>主机要求卡发送它的支持信息(HCS)和OCR寄存器内容。</td>
</tr>
<tr>
<td>ACMD51</td>
<td>adtc</td>
<td>[31:0]填充位</td>
<td>R1</td>
<td>SEND_SCR</td>
<td>读取配置寄存器SCR</td>
</tr>
</tbody></table>
<h1 id="五、SD卡响应"><a href="#五、SD卡响应" class="headerlink" title="五、SD卡响应"></a><font size=3>五、SD卡响应</font></h1><p>关于响应这一部分，我们可以参考文档 <a target="_blank" rel="noopener" href="https://www.sdcard.org/downloads/pls/pdf/?p=Part1_Physical_Layer_Simplified_Specification_Ver9.00.jpg&f=Part1_Physical_Layer_Simplified_Specification_Ver9.00.pdf&e=EN_SS1_9">Physical Layer Simplified Specification v9.0</a> 的 4.9 Responses一节。</p>
<h2 id="1-响应简介"><a href="#1-响应简介" class="headerlink" title="1. 响应简介"></a><font size=3>1. 响应简介</font></h2><p>响应由SD卡向主机发出，部分命令要求SD卡作出响应，这些响应多用于反馈SD卡的状态。 基本特性如下：</p>
<p>（1）总共有7个响应类型(代号： R1~R7)，其中SD卡没有R4、 R5类型响应。特定的命令对应有特定的响应类型，比如当主机发送CMD3命令时，可以得到响应R6。</p>
<p>（2）与命令一样， SD卡的响应也是通过CMD线连续传输的。</p>
<p>（3）根据响应内容大小可以分为短响应和长响应。短响应是48bit长度，只有R2类型是长响应，其长度为136bit。  </p>
<p>（4）除了 R3 类型之外，其他响应都使用 CRC7 校验来校验，对于 R2 类型是使用 CID 和 CSD 寄存器内部 CRC7。</p>
<h2 id="2-R1-正常响应命令"><a href="#2-R1-正常响应命令" class="headerlink" title="2. R1(正常响应命令)"></a><font size=3>2. R1(正常响应命令)</font></h2><table>
<thead>
<tr>
<th>描述</th>
<th>起始位</th>
<th>传输位</th>
<th>命令号</th>
<th>卡状态</th>
<th>CRC7</th>
<th>终止位</th>
</tr>
</thead>
<tbody><tr>
<td>Bit</td>
<td>47</td>
<td>46</td>
<td>[45:40]</td>
<td>[39:8]</td>
<td>[7:1]</td>
<td>0</td>
</tr>
<tr>
<td>位宽</td>
<td>1</td>
<td>1</td>
<td>6</td>
<td>32</td>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>值</td>
<td>“0”</td>
<td>“0”</td>
<td>x</td>
<td>x</td>
<td>x</td>
<td>“1”</td>
</tr>
</tbody></table>
<p>如果有传输到卡的数据，那么在数据线可能有busy信号。</p>
<h2 id="3-R2-CID-CSD寄存器"><a href="#3-R2-CID-CSD寄存器" class="headerlink" title="3. R2(CID,CSD寄存器)"></a><font size=3>3. R2(CID,CSD寄存器)</font></h2><table>
<thead>
<tr>
<th>描述</th>
<th>起始位</th>
<th>传输位</th>
<th>保留</th>
<th>[127:1]</th>
<th>终止位</th>
</tr>
</thead>
<tbody><tr>
<td>Bit</td>
<td>135</td>
<td>134</td>
<td>[133:128]</td>
<td>127</td>
<td>0</td>
</tr>
<tr>
<td>位宽</td>
<td>1</td>
<td>1</td>
<td>6</td>
<td>x</td>
<td>1</td>
</tr>
<tr>
<td>值</td>
<td>“0”</td>
<td>“0”</td>
<td>“111111”</td>
<td>CID或者CSD寄存器[127:1]位的值</td>
<td>“1”</td>
</tr>
</tbody></table>
<p>CID寄存器内容作为CMD2和CMD10响应， CSD寄存器内容作为CMD9响应。</p>
<h2 id="4-R3-OCR寄存器"><a href="#4-R3-OCR寄存器" class="headerlink" title="4. R3(OCR寄存器)"></a><font size=3>4. R3(OCR寄存器)</font></h2><table>
<thead>
<tr>
<th>描述</th>
<th>起始位</th>
<th>传输位</th>
<th>保留</th>
<th>OCR寄存器</th>
<th>保留</th>
<th>终止位</th>
</tr>
</thead>
<tbody><tr>
<td>Bit</td>
<td>47</td>
<td>46</td>
<td>[45:40]</td>
<td>[39:8]</td>
<td>[7:1]</td>
<td>0</td>
</tr>
<tr>
<td>位宽</td>
<td>1</td>
<td>1</td>
<td>6</td>
<td>32</td>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>值</td>
<td>“0”</td>
<td>“0”</td>
<td>“111111”</td>
<td>x</td>
<td>“1111111”</td>
<td>“1”</td>
</tr>
</tbody></table>
<p>OCR寄存器的值作为ACMD41的响应。</p>
<h2 id="5-R6-发布的RCA寄存器响应"><a href="#5-R6-发布的RCA寄存器响应" class="headerlink" title="5. R6(发布的RCA寄存器响应)"></a><font size=3>5. R6(发布的RCA寄存器响应)</font></h2><table>
<thead>
<tr>
<th>描述</th>
<th>起始位</th>
<th>传输位</th>
<th>CMD3</th>
<th>RCA寄存器</th>
<th>卡状态位</th>
<th>CRC7</th>
<th>终止位</th>
</tr>
</thead>
<tbody><tr>
<td>Bit</td>
<td>47</td>
<td>46</td>
<td>[45:40]</td>
<td>[39:8]</td>
<td>[7:1]</td>
<td>0</td>
<td></td>
</tr>
<tr>
<td>位宽</td>
<td>1</td>
<td>1</td>
<td>6</td>
<td>16</td>
<td>16</td>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>值</td>
<td>“0”</td>
<td>“0”</td>
<td>“000011”</td>
<td>x</td>
<td>x</td>
<td>x</td>
<td>“1”</td>
</tr>
</tbody></table>
<p>专用于命令CMD3的响应。</p>
<h2 id="6-R7-发布的RCA寄存器响应"><a href="#6-R7-发布的RCA寄存器响应" class="headerlink" title="6. R7(发布的RCA寄存器响应)"></a><font size=3>6. R7(发布的RCA寄存器响应)</font></h2><table>
<thead>
<tr>
<th>描述</th>
<th>起始位</th>
<th>传输位</th>
<th>CMD8</th>
<th>保留</th>
<th>接收电压</th>
<th>检测模式</th>
<th>CRC7</th>
<th>终止位</th>
</tr>
</thead>
<tbody><tr>
<td>Bit</td>
<td>47</td>
<td>46</td>
<td>[45:40]</td>
<td>[39:20]</td>
<td>[19:16]</td>
<td>[15:8]</td>
<td>[7:1]</td>
<td>0</td>
</tr>
<tr>
<td>位宽</td>
<td>1</td>
<td>1</td>
<td>6</td>
<td>20</td>
<td>4</td>
<td>8</td>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>值</td>
<td>“0”</td>
<td>“0”</td>
<td>“001000”</td>
<td>“00000h”</td>
<td>x</td>
<td>x</td>
<td>x</td>
<td>“1”</td>
</tr>
</tbody></table>
<p>专用于命令CMD8的响应,返回卡支持电压范围和检测模式。</p>
<h1 id="六、SD卡状态"><a href="#六、SD卡状态" class="headerlink" title="六、SD卡状态"></a><font size=3>六、SD卡状态</font></h1><p>这一部分我们可以参考文档 <a target="_blank" rel="noopener" href="https://www.sdcard.org/downloads/pls/pdf/?p=Part1_Physical_Layer_Simplified_Specification_Ver9.00.jpg&f=Part1_Physical_Layer_Simplified_Specification_Ver9.00.pdf&e=EN_SS1_9">Physical Layer Simplified Specification v9.0</a> 的 4.10 Three Status Information of SD Memory Card 这一小节，有关SD卡状态的那部分在4.10.2 SD Status。</p>
<h2 id="1-状态简介"><a href="#1-状态简介" class="headerlink" title="1. 状态简介"></a><font size=3>1. 状态简介</font></h2><p>这里以文档<a target="_blank" rel="noopener" href="https://www.sdcard.org/downloads/pls/pdf/?p=Part1_Physical_Layer_Simplified_Specification_Ver2.00.jpg&f=Part1_Physical_Layer_Simplified_Specification_Ver2.00.pdf&e=EN_P1200">Physical Layer Simplified Specification v2.0</a>来说明吧，因为在9.0版本中多了一个状态，但是似乎并不是目前关注的重点，而在2.0版本中是定义了种状态区域：</p>
<p>卡状态：执行命令的错误和状态信息，在响应中标示。</p>
<p>SD 状态：512 位的扩展状态信息，支持 SD 卡的特定功能以及将来的应用特定功能。  </p>
<h2 id="2-卡状态"><a href="#2-卡状态" class="headerlink" title="2. 卡状态"></a><font size=3>2. 卡状态</font></h2><p>响应 R1 包含一个 32bit 的“卡状态”区域。这个区域用来传输卡的状态信息(可以被存在本地状态寄存器中)给主机。如果没有特别说明，这个状态总是同前一个命令相关。这里就不写了，具体可以查看 文档<a target="_blank" rel="noopener" href="https://www.sdcard.org/downloads/pls/pdf/?p=Part1_Physical_Layer_Simplified_Specification_Ver2.00.jpg&f=Part1_Physical_Layer_Simplified_Specification_Ver2.00.pdf&e=EN_P1200">Physical Layer Simplified Specification v2.0</a> 的 4.10.1 Card Status一节。</p>
<h2 id="3-SD状态"><a href="#3-SD状态" class="headerlink" title="3. SD状态"></a><font size=3>3. SD状态</font></h2><p>SD 状态包含了与 SD 卡属性功能相关的状态位，可能会用于将来特定的应用命令。SD状态的大小是一个 512bit 的数据块。这个寄存器的内容与16位CRC会通过 DAT 总线传递给主机。SD 状态会通过 DAT 总线发送给主机，作为 ACMD13(前面是 CMD55)的响应。ACMD13 只能在“transfer”模式发送给已选定的卡。卡状态结构体在下表描述。“类型”和“清除条件”使用的缩写和卡状态一样。这一部分也不详细写，具体可以查看 文档<a target="_blank" rel="noopener" href="https://www.sdcard.org/downloads/pls/pdf/?p=Part1_Physical_Layer_Simplified_Specification_Ver2.00.jpg&f=Part1_Physical_Layer_Simplified_Specification_Ver2.00.pdf&e=EN_P1200">Physical Layer Simplified Specification v2.0</a> 的 4.10.2 SD Status一节。</p>
<h1 id="七、SD卡时钟控制"><a href="#七、SD卡时钟控制" class="headerlink" title="七、SD卡时钟控制"></a><font size=3>七、SD卡时钟控制</font></h1><p>这一部分我们可以参考文档 <a target="_blank" rel="noopener" href="https://www.sdcard.org/downloads/pls/pdf/?p=Part1_Physical_Layer_Simplified_Specification_Ver9.00.jpg&f=Part1_Physical_Layer_Simplified_Specification_Ver9.00.pdf&e=EN_SS1_9">Physical Layer Simplified Specification v9.0</a> 的 4.4 Clock Control 一节。</p>
<p>主机可以使用 SD 卡时钟信号来将卡改变到节电模式，或者控制总线上的数据流(避免不足或者超出的情况)。主机可以减小时钟频率，或者关闭时钟。比如，当主机带有 512Byte的数据缓存，却想要向 1kByte 的卡上写块。因此，为了保持连续的数据传输，从卡这边来看，卡的时钟需要在第一个 512Byte 后关闭时钟。然后主机会将另外 512Byte 数据填写到缓存中。当主机的写块的后半部分 ready 后，将会重启时钟，并继续发送数据。这样，卡就不会意识到数据传输的中断。</p>
<p>这里有一些限制，主机需要注意：</p>
<p>总线时钟可在任何时候改变(要小于最大数据传输频率和本规范定义的标示频率)，但是有个例外，那就是ACMD41(SD_APP_OP_COND)命令。当 ACMD41 发送后，主机应该执行下面的（1）和（2）两个步骤，直到卡变为 ready 状态。</p>
<p>（1）发送连续的时钟，频率在 100KHz~400KHz；</p>
<p>（2）如果主机想要停止时钟，通过 ACMD41 循环设置 busy 位，小于 50ms 间隔。  </p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230512071810158.png" alt="image-20230512071810158" style="zoom:50%;" />

<h1 id="八、SD卡操作模式及切换"><a href="#八、SD卡操作模式及切换" class="headerlink" title="八、SD卡操作模式及切换"></a><font size=3>八、SD卡操作模式及切换</font></h1><p>这一部分我们可以参考文档 <a target="_blank" rel="noopener" href="https://www.sdcard.org/downloads/pls/pdf/?p=Part1_Physical_Layer_Simplified_Specification_Ver9.00.jpg&f=Part1_Physical_Layer_Simplified_Specification_Ver9.00.pdf&e=EN_SS1_9">Physical Layer Simplified Specification v9.0</a> 的 4.2 Card ldentification Mode 和 4.3 Data Transfer Mode 两个小节。</p>
<h2 id="1-操作模式"><a href="#1-操作模式" class="headerlink" title="1. 操作模式  "></a><font size=3>1. 操作模式  </font></h2><p>SD卡有多个版本， STM32控制器目前最高支持《Physical Layer Simplified Specification V2.0》定义的SD卡， STM32控制器对SD卡进行数据读写之前需要识别卡的种类： V1.0标准卡、 V2.0标准卡、 V2.0高容量卡或者不被识别卡。  </p>
<p>SD卡系统(包括主机和SD卡)定义了两种操作模式： <strong>卡识别模式</strong>和<strong>数据传输模式</strong>。 在系统复位后，主机处于卡识别模式，寻找总线上可用的SDIO设备；同<br>时， SD卡也处于卡识别模式，直到被主机识别到，即当SD卡接收到SEND_RCA(CMD3)命令后， SD卡就会进入数据传输模式，而主机在总线上所有卡被识别后也进入数据传输模式。</p>
<h2 id="2-不同模式下SD卡状态"><a href="#2-不同模式下SD卡状态" class="headerlink" title="2. 不同模式下SD卡状态"></a><font size=3>2. 不同模式下SD卡状态</font></h2><p> 在每个操作模式下，SD卡都有几种状态， 通过命令控制实现卡状态的切换 ：</p>
<table>
    <tr><td align="center" width=300px>操作模式</td><td align="center">SD卡状态</td></tr>
    <tr><td align="left">无效模式(Inactive)</td><td align="left">无效状态(Inactive State)</td></tr>
    <tr><td align="left" rowspan="3">卡识别模式(Card identification mode)</td><td align="left">空闲状态(Idle State)</td></tr>
    <tr><td align="left">准备状态(Ready State)</td></tr>
    <tr><td align="left">识别状态(Identification State)</td></tr>
    <tr><td align="left" rowspan="6">数据传输模式(Data transfer mode)</td><td align="left">待机状态(Stand-by State)</td></tr>
    <tr><td align="left">传输状态(Transfer State)</td></tr>
    <tr><td align="left">发送数据状态(Sending-data State)</td></tr>
    <tr><td align="left">接收数据状态(Receive-data State)</td></tr>
    <tr><td align="left">编程状态(Programming State)</td></tr>
    <tr><td align="left">断开连接状态(Disconnect State)</td></tr>
</table>

<h2 id="3-卡识别模式"><a href="#3-卡识别模式" class="headerlink" title="3. 卡识别模式"></a><font size=3>3. 卡识别模式</font></h2><p>在卡识别模式下，主机会复位所有处于“卡识别模式”的SD卡，确认其工作电压范围，识别SD卡类型，并且获取SD卡的相对地址(卡相对地址较短，便于寻址)。在卡识别过程中，要求SD卡工作在识别时钟频率FOD的状态下。  </p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510211833918.png" alt="image-20230510211833918" style="zoom:50%;" />

<p>（1）上电后，所有卡处于空闲状态，包括当前处于无效状态的卡，主机也可以发送GO_IDLE_STATE(CMD0)让所有卡软复位从而进入空闲状态，但当前处于无效状态的卡并不会复位。    </p>
<p>（2）主机在开始与卡通信前，需要先确定双方在互相支持的电压范围内。 SD 卡有一个电压支持范围，主机当前电压必须在该范围可能才能与卡正常通信。 SEND_IF_COND(CMD8) 命令就是用于验证卡接口操作条件的 (主要是电压支持)。卡会根据命令的参数来检测操作条件匹配性，如果卡支持主机电压就产生响应，否则不响应。而主机则根据响应内容确定卡的电压匹配性。 CMD8 是 SD卡标准 V2.0 版本才有的新命令，所以如果主机有接收到响应，可以判断卡为 V2.0 或更高版本SD 卡(非MMC卡)。  </p>
<p>（3）使用SD_SEND_OP_COND(ACMD41)命令识别或拒绝不匹配它的电压范围的卡。 并通过HCS位及其响应判断是SDSC还是SDHC卡。ACMD41 命令的VDD 电压参数用于设置主机支持电压范围，卡响应会返回卡支持的电压范围。对于对 CMD8有响应的卡，把 ACMD41 命令的 HCS 位设置为 1，可以测试卡的容量类型，如果卡响应的 CCS 位为 1 说明为高容量 SD 卡，否则为标准卡。卡在响应 ACMD41 之后进入准备状态，不响应 ACMD41的卡为不可用卡，进入无效状态。 ACMD41 是应用特定命令，发送该命令之前必须先发 CMD55。    </p>
<p>（4）使用ALL_SEND_CID(CMD2) 来控制所有卡返回它们的卡识别号(CID)，处于准备状态的卡在发送CID之后就进入识别状态。</p>
<p>（5）主机  发送SEND_RELATIVE_ADDR(CMD3)命令，让卡自己推荐一个相对地址(RCA)并响应命令。这个RCA是16bit地址，而CID是128bit地址，使用RCA简化通信。  </p>
<p>（6）卡在接收到CMD3并发出响应后就进入数据传输模式，并处于待机状态，主机在获取所有卡RCA之后也进入数据传输模式。</p>
<h2 id="4-数据传输模式"><a href="#4-数据传输模式" class="headerlink" title="4. 数据传输模式"></a><font size=3>4. 数据传输模式</font></h2><p>只有SD卡系统处于数据传输模式下才可以进行数据读写操作。数据传输模式下可以将主机SD时钟频率设置为FPP，默认最高为25MHz，频率切换可以通过CMD4命令来实现。  </p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510212155886.png" alt="image-20230510212155886" style="zoom:47%;" />

<p>（1）CMD7用来选定和取消指定的卡，卡在待机状态下还不能进行数据通信，因为总线上可能有多个卡都是出于待机状态，必须选择一个RCA地址目标卡使<br>其进入传输状态才可以进行数据通信。同时通过CMD7命令也可以让已经被选择的目标卡返回到待机状态。</p>
<p>（2）数据传输模式下的数据通信都是主机和目标卡之间通过寻址命令点对点进行的。卡处于传输状态下可以使用块的读写以及擦除命令对卡进行数据读写、擦除。  </p>
<p>（3）CMD12可以中断正在进行的数据通信，让卡返回到传输状态。 CMD0和CMD15会中止任何数据编程操作，返回卡识别模式，这可能导致卡数据被损坏。  </p>
<h1 id="九、读写SD卡"><a href="#九、读写SD卡" class="headerlink" title="九、读写SD卡"></a><font size=3>九、读写SD卡</font></h1><h2 id="1-初始化"><a href="#1-初始化" class="headerlink" title="1. 初始化"></a><font size=3>1. 初始化</font></h2><p>要实现SDIO驱动SD卡，最重要的步骤就是SD卡的初始化，只要SD卡初始化完成了，那么剩下的（读写操作）就简单了，所以我们这里重点介绍SD卡的初始化。这一部分可以参考文档 <a target="_blank" rel="noopener" href="https://www.sdcard.org/downloads/pls/pdf/?p=Part1_Physical_Layer_Simplified_Specification_Ver9.00.jpg&f=Part1_Physical_Layer_Simplified_Specification_Ver9.00.pdf&e=EN_SS1_9">Physical Layer Simplified Specification v9.0</a> 的4.2.3 Card lnitialization and ldentification Process一节。</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510214259366.png" alt="image-20230510214259366" style="zoom: 80%;" />

<p>（1）从SD卡初始化流程可知，不管什么卡（这里我们将卡分为4类：SD2.0高容量卡（SDHC，最大32G），SD2.0标准容量卡（SDSC，最大2G），SD1.x卡和MMC卡），首先我们要执行的是卡上电（设置SDIO_POWER[1:0]&#x3D;11），上电后发送CMD0，对卡进行软复位.</p>
<p>（2）之后发送CMD8命令，用于区分SD卡2.0，只有2.0及以后的卡才支持CMD8命令，MMC卡和V1.x的卡，是不支持该命令的。 CMD8命令格式如下表（见 文档 <a target="_blank" rel="noopener" href="https://www.sdcard.org/downloads/pls/pdf/?p=Part1_Physical_Layer_Simplified_Specification_Ver9.00.jpg&f=Part1_Physical_Layer_Simplified_Specification_Ver9.00.pdf&e=EN_SS1_9">Physical Layer Simplified Specification v9.0</a> 的4.9.6 R7(Card interface condition)）：</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510214551994.png" alt="image-20230510214551994" style="zoom:50%;" />

<p>在发送CMD8的时候，通过其带的参数我们可以设置VHS位（在v9.0上叫Voltage accepted），以告诉SD卡，主机的供电情况，让SD卡知道主机的供电范围。VHS位（在v9.0上叫Voltage accepted）定义如下表所示：</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510214702846.png" alt="image-20230510214702846" style="zoom:50%;" />

<p>这里我们使用参数0X1AA，即告诉SD卡，主机供电为2.7~3.6V之间，如果SD卡支持CMD8，且支持该电压范围，则会通过CMD8的响应（R7）将参数部分原本返回给主机，如果不支持CMD8，或者不支持这个电压范围，则不响应。</p>
<p>（3）在发送CMD8后，发送ACMD41（注意：发送ACMD41之前，要先发送CMD55），来进一步确认卡的操作电压范围，并通过HCS位来告诉SD卡，主机是不是支持高容量卡（SDHC）。ACMD41命令格式如下表所示：</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510215003169.png" alt="image-20230510215003169" style="zoom:50%;" />

<p> ACMD41指令响应(R3)，包含了SD卡OCR寄存器内容，其定义如下表所示：</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510215042811.png" alt="image-20230510215042811" style="zoom:50%;" />

<p>对于支持CMD8的卡，主机设置ACMD41的参数HCS&#x3D;1，告诉SD卡，主机支持SDHC卡。对2.0的卡，OCR的CCS位用于表示SDHC还是SDSC；对1.x的卡，则忽略该位；对MMC卡，则不支持ACMD41，MMC卡只需要发送：CMD0和CMD1即可完成初始化。</p>
<p>（4）CMD2用于获取CID寄存器数据，CID寄存器各位定义如下表：</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510215143920.png" alt="image-20230510215143920" style="zoom:50%;" />

<p>SD卡在收到CMD2后，将返回R2长响应（136位），其中包含128位有效数据（CID寄存器内容），存放在SDIO_RESP1~4等4个寄存器里面。通过读取这四个寄存器，就可以获得SD卡的CID信息。</p>
<p>（4）CMD3，用于设置卡相对地址（RCA，必须为非0），对于SD卡（非MMC卡），在收到CMD3后，将返回一个新的RCA给主机，方便主机寻址。RCA的存在允许一个SDIO接口挂多个SD卡，通过RCA来区分主机要操作的是哪个卡。对于MMC卡，则不是由SD卡自动返回RCA，而是主机主动设置MMC卡的RCA，即通过CMD3带参数（高16位用于RCA设置），实现RCA设置。同样MMC卡也支持一个SDIO接口挂多个MMC卡，不同于SD卡的是所有的RCA都是由主机主动设置的，而SD卡的RCA则是SD卡发给主机的。在获得卡RCA之后，我们便可以发送CMD9（带RCA参数），获得SD卡的CSD寄存器内容，从CSD寄存器，我们可以得到SD卡的容量和扇区大小等十分重要的信息。CSD寄存器我们可以参考文档 <a target="_blank" rel="noopener" href="https://www.sdcard.org/downloads/pls/pdf/?p=Part1_Physical_Layer_Simplified_Specification_Ver9.00.jpg&f=Part1_Physical_Layer_Simplified_Specification_Ver9.00.pdf&e=EN_SS1_9">Physical Layer Simplified Specification v9.0</a> 的5.3.1 CSD STRUCTURE一节。</p>
<p>（5）至此，我们的SD卡初始化基本就结束了，最后通过CMD7命令，选中我们要操作的SD卡，即可开始对SD卡的读写操作了。</p>
<h2 id="2-数据块读取"><a href="#2-数据块读取" class="headerlink" title="2. 数据块读取"></a><font size=3>2. 数据块读取</font></h2><p>关于读取我们可以参文档 <a target="_blank" rel="noopener" href="https://www.sdcard.org/downloads/pls/pdf/?p=Part1_Physical_Layer_Simplified_Specification_Ver9.00.jpg&f=Part1_Physical_Layer_Simplified_Specification_Ver9.00.pdf&e=EN_SS1_9">Physical Layer Simplified Specification v9.0</a> 的 4.3.3 Data Read 一节。</p>
<h3 id="2-1-单块数据块读取流程"><a href="#2-1-单块数据块读取流程" class="headerlink" title="2.1 单块数据块读取流程"></a><font size=3>2.1 单块数据块读取流程</font></h3><p>单块数据块读取大概得流程如下：</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510220131450.png" alt="image-20230510220131450" style="zoom:50%;" />

<h3 id="2-2-多块数据块读取流程"><a href="#2-2-多块数据块读取流程" class="headerlink" title="2.2 多块数据块读取流程"></a><font size=3>2.2 多块数据块读取流程</font></h3><img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510220616487.png" alt="image-20230510220616487" style="zoom:50%;" />

<h3 id="2-3-相关命令说明"><a href="#2-3-相关命令说明" class="headerlink" title="2.3 相关命令说明"></a><font size=3>2.3 相关命令说明</font></h3><h4 id="2-3-1-CMD17命令"><a href="#2-3-1-CMD17命令" class="headerlink" title="2.3.1 CMD17命令"></a><font size=3>2.3.1 CMD17命令</font></h4><img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510220940937.png" alt="image-20230510220940937" style="zoom: 33%;" />

<h4 id="2-3-2-CMD18命令"><a href="#2-3-2-CMD18命令" class="headerlink" title="2.3.2 CMD18命令"></a><font size=3>2.3.2 CMD18命令</font></h4><img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510221021370.png" alt="image-20230510221021370" style="zoom: 33%;" />

<h4 id="2-3-3-CMD12命令"><a href="#2-3-3-CMD12命令" class="headerlink" title="2.3.3 CMD12命令"></a><font size=3>2.3.3 CMD12命令</font></h4><img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510221102516.png" alt="image-20230510221102516" style="zoom: 33%;" />

<h2 id="3-数据块写入"><a href="#3-数据块写入" class="headerlink" title="3. 数据块写入"></a><font size=3>3. 数据块写入</font></h2><p>关于写入我们可以参考文档 <a target="_blank" rel="noopener" href="https://www.sdcard.org/downloads/pls/pdf/?p=Part1_Physical_Layer_Simplified_Specification_Ver9.00.jpg&f=Part1_Physical_Layer_Simplified_Specification_Ver9.00.pdf&e=EN_SS1_9">Physical Layer Simplified Specification v9.0</a> 的 4.3.4 Data Write 一节。</p>
<h3 id="3-1-单块数据块写入流程"><a href="#3-1-单块数据块写入流程" class="headerlink" title="3.1 单块数据块写入流程"></a><font size=3>3.1 单块数据块写入流程</font></h3><img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510221722806.png" alt="image-20230510221722806" style="zoom:50%;" />

<h3 id="3-2-多块数据写入流程"><a href="#3-2-多块数据写入流程" class="headerlink" title="3.2 多块数据写入流程"></a><font size=3>3.2 多块数据写入流程</font></h3><img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510222129117.png" alt="image-20230510222129117" style="zoom:50%;" />

<h3 id="3-3-相关命令说明"><a href="#3-3-相关命令说明" class="headerlink" title="3.3 相关命令说明"></a><font size=3>3.3 相关命令说明</font></h3><h4 id="3-3-1-CMD13命令"><a href="#3-3-1-CMD13命令" class="headerlink" title="3.3.1 CMD13命令"></a><font size=3>3.3.1 CMD13命令</font></h4><img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510222239890.png" alt="image-20230510222239890" style="zoom: 33%;" />

<p>R1响应如下：</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510222255985.png" alt="image-20230510222255985" style="zoom: 43%;" />

<h4 id="3-3-2-CMD24命令"><a href="#3-3-2-CMD24命令" class="headerlink" title="3.3.2 CMD24命令"></a><font size=3>3.3.2 CMD24命令</font></h4><img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510222326770.png" alt="image-20230510222326770" style="zoom: 33%;" />

<h4 id="3-3-3-ACMD23命令"><a href="#3-3-3-ACMD23命令" class="headerlink" title="3.3.3 ACMD23命令"></a><font size=3>3.3.3 ACMD23命令</font></h4><img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510222425522.png" alt="image-20230510222425522" style="zoom:33%;" />

<p>注意：发送ACMD之前，必须先发送CMD55，通知SD卡，接下来要发送的是应用命令（APP CMD），而非标准命令。</p>
<h4 id="3-3-4-CMD55命令"><a href="#3-3-4-CMD55命令" class="headerlink" title="3.3.4 CMD55命令"></a><font size=3>3.3.4 CMD55命令</font></h4><img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510222518271.png" alt="image-20230510222518271" style="zoom:33%;" />

<h4 id="3-3-5-CMD25命令"><a href="#3-3-5-CMD25命令" class="headerlink" title="3.3.5 CMD25命令"></a><font size=3>3.3.5 CMD25命令</font></h4><img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510222627687.png" alt="image-20230510222627687" style="zoom: 33%;" />

<h2 id="4-读写地址"><a href="#4-读写地址" class="headerlink" title="4. 读写地址"></a><font size=3>4. 读写地址</font></h2><h3 id="4-1-写命令CMD24"><a href="#4-1-写命令CMD24" class="headerlink" title="4.1 写命令CMD24"></a><font size=3>4.1 写命令CMD24</font></h3><img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230510222326770.png" alt="image-20230510222326770" style="zoom: 33%;" />

<p>我们可以参考文档 <a target="_blank" rel="noopener" href="https://www.sdcard.org/downloads/pls/pdf/?p=Part1_Physical_Layer_Simplified_Specification_Ver9.00.jpg&f=Part1_Physical_Layer_Simplified_Specification_Ver9.00.pdf&e=EN_SS1_9">Physical Layer Simplified Specification v9.0</a> 的4.7.4 Detailed Command Description一节，上边会有CMD24的说名，如上图所示，我们发送CMD24命令的时候携带的参数就是写入的地址信息，他是一个32位的长度，一共就是可以表示这么多个“地址”：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span> ^ <span class="number">32</span> = <span class="number">4</span> * <span class="number">2</span>^<span class="number">10</span> * <span class="number">2</span>^<span class="number">10</span></span><br></pre></td></tr></table></figure>

<p>那么这是怎么对应SD卡的地址的呢？要是每个字节都对应一个地址，那这完全不够32GB的用啊，2GB的还。其实我们看手册的话，手册这里有一个脚注：</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230511070742199.png" alt="image-20230511070742199" style="zoom:50%;" />

<p>这句话就在文档 <a target="_blank" rel="noopener" href="https://www.sdcard.org/downloads/pls/pdf/?p=Part1_Physical_Layer_Simplified_Specification_Ver9.00.jpg&f=Part1_Physical_Layer_Simplified_Specification_Ver9.00.pdf&e=EN_SS1_9">Physical Layer Simplified Specification v9.0</a> 的Table 4-24 : Block-Oriented Read Commands (class 2)这一个命令组的下边，这句话的意思就是，对于SDSC卡来说，单位就是字节，对于SDHC或者SDXC卡来说，使用块为单位，也就是512个字节，这什么意思呢，意思就是：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">对于SDSC卡：</span><br><span class="line">    SD卡<span class="number">0</span>h地址 ---&gt; <span class="number">0x00000000</span></span><br><span class="line">    SD卡<span class="number">1</span>h地址 ---&gt; <span class="number">0x00000001</span></span><br><span class="line">    SD卡<span class="number">2</span>h地址 ---&gt; <span class="number">0x00000010</span></span><br><span class="line">    ... ...</span><br><span class="line">对于SDHC或者SDXC卡：</span><br><span class="line">    SD卡<span class="number">0</span>地址   ---&gt; <span class="number">0x00000000</span></span><br><span class="line">    SD卡<span class="number">511</span>地址 ---&gt; <span class="number">0x00000001</span></span><br><span class="line">    SD卡<span class="number">1023</span>地址---&gt; <span class="number">0x00000010</span></span><br><span class="line">    ... ...</span><br></pre></td></tr></table></figure>

<p>这样计算下来的话，32位的地址，以512字节为单位，就可以表示:</p>
 <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4</span> * <span class="number">2</span>^<span class="number">10</span> * <span class="number">2</span>^<span class="number">10</span> * <span class="number">512</span> = <span class="number">2048</span> * <span class="number">2</span>^<span class="number">10</span> * <span class="number">2</span>^<span class="number">10</span> = <span class="number">2</span> * <span class="number">2</span>^<span class="number">10</span> * <span class="number">2</span>^<span class="number">10</span> * <span class="number">2</span>^<span class="number">10</span> = <span class="number">2</span>TB</span><br></pre></td></tr></table></figure>

<p>这样的话32位不就够最大2TB的卡使用了嘛，这也就是为什么我们初始化SD卡的时候要获取卡的类型，读写的时候要先确定块的长度的原因啦。我们还可以查看 文档 <a target="_blank" rel="noopener" href="https://www.sdcard.org/downloads/pls/pdf/?p=Part1_Physical_Layer_Simplified_Specification_Ver9.00.jpg&f=Part1_Physical_Layer_Simplified_Specification_Ver9.00.pdf&e=EN_SS1_9">Physical Layer Simplified Specification v9.0</a> 的 4.3 Data Transfer Mode中 4.3.3 Data Read 和 4.3.4 Data Write两个部分，里边也有对应的说明。</p>
<h3 id="4-2-卡的类型"><a href="#4-2-卡的类型" class="headerlink" title="4.2 卡的类型"></a><font size=3>4.2 卡的类型</font></h3><p>我们在看SD卡初始化流程的时候会发现，我们发送了ACMD41命令，这个命令上边有说明，我们再看一下手册（我们可以参考文档 <a target="_blank" rel="noopener" href="https://www.sdcard.org/downloads/pls/pdf/?p=Part1_Physical_Layer_Simplified_Specification_Ver9.00.jpg&f=Part1_Physical_Layer_Simplified_Specification_Ver9.00.pdf&e=EN_SS1_9">Physical Layer Simplified Specification v9.0</a> 的 4.2.3.1 Initialization Command (ACMD41)），详细了解一下：</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/01HQ%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB/LV16-STM32%E5%BC%80%E5%8F%91/LV16-21-SDIO-01-SD%E5%8D%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/img/image-20230511065559668.png" alt="image-20230511065559668" style="zoom:50%;" />

<p>可以看到，我们这里收到响应的时候，有一个CCS位，当CCS&#x3D;1 表示卡是高容量 SD 卡（SDHC或者SDXC）；CCS&#x3D;0 表示卡是普通 SD 卡（SDSC）。 </p>

    </div>

    
    
    

    <footer class="post-footer">




    <div>
        
            <div style="text-align:center;color: #ccc;font-size:14px;">
            ----------本文结束
            <i class="fas fa-fan fa-spin" style="color: #FF1493; font-size: 1rem"></i>
            感谢您的阅读----------
            </div>
        
    </div>





  
  <div class="my_post_copyright"> 
    <p><span>文章标题:</span><a href="/post/9e4f210b.html">LV16-21-SDIO-01-SD卡基础知识</a></p>
    <p><span>文章作者:</span><a href="/" title="欢迎访问 《苏木》 的学习笔记">苏木</a></p>
    <p><span>发布时间:</span>2023年06月04日 - 22:07</p>
    <p><span>最后更新:</span>2025年06月14日 - 00:25</p>
    <p><span>原始链接:</span><a href="/post/9e4f210b.html" title="LV16-21-SDIO-01-SD卡基础知识">https://sumumm.github.io/post/9e4f210b.html</a></p>
    <p><span>许可协议:</span><i class="fab fa-creative-commons"></i> <a rel="license" href= "https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">署名-非商业性使用-禁止演绎 4.0 国际</a> 转载请保留原文链接及作者。</p>  
  </div>
  


          <div class="post-tags">
              <a href="/tags/LV16-STM32%E5%BC%80%E5%8F%91/" rel="tag"><i class="fa fa-tag"></i> LV16-STM32开发</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/post/4734145d.html" rel="prev" title="LV16-21-SDIO-02-STM32的SDIO接口">
                  <i class="fa fa-angle-left"></i> LV16-21-SDIO-02-STM32的SDIO接口
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/post/7e1c4c31.html" rel="next" title="LV16-20-SPI-02-读写外部SPI-FLASH">
                  LV16-20-SPI-02-读写外部SPI-FLASH <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2017 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">苏木</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>站点总字数：</span>
    <span title="站点总字数">3.7m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">225:26</span>
  </span>
</div>




    <span id="sitetime"></span>
    <script defer language=javascript>
        function siteTime()
        {
            window.setTimeout("siteTime()", 1000);
            var seconds = 1000;
            var minutes = seconds * 60;
            var hours = minutes * 60;
            var days = hours * 24;
            var years = days * 365;
            var today = new Date();
            var todayYear = today.getFullYear();
            var todayMonth = today.getMonth()+1;
            var todayDate = today.getDate();
            var todayHour = today.getHours();
            var todayMinute = today.getMinutes();
            var todaySecond = today.getSeconds();
            /*==================================================
            Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)
            year        - 作为date对象的年份，为4位年份值
            month       - 0-11之间的整数，做为date对象的月份
            day         - 1-31之间的整数，做为date对象的天数
            hours       - 0(午夜24点)-23之间的整数，做为date对象的小时数
            minutes     - 0-59之间的整数，做为date对象的分钟数
            seconds     - 0-59之间的整数，做为date对象的秒数
            microseconds - 0-999之间的整数，做为date对象的毫秒数
            ==================================================*/
            var t1 = Date.UTC(2017, 
                              5, 
                              19, 
                              0, 
                              0, 
                              0); //北京时间
            var t2 = Date.UTC(todayYear,todayMonth,todayDate,todayHour,todayMinute,todaySecond);
            var diff = t2-t1;
            var diffYears = Math.floor(diff/years);
            var diffDays = Math.floor((diff/days)-diffYears*365);
            var diffHours = Math.floor((diff-(diffYears*365+diffDays)*days)/hours);
            var diffMinutes = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours)/minutes);
            var diffSeconds = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours-diffMinutes*minutes)/seconds);
            document.getElementById("sitetime").innerHTML="已在这里 "+diffYears+" 年 "+diffDays+" 天 "+diffHours+" 小时 "+diffMinutes+" 分钟 "+diffSeconds+" 秒";
        }
        siteTime();
    </script>



    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.28/fancybox/fancybox.umd.js" integrity="sha256-ytMJGN3toR+a84u7g7NuHm91VIR06Q41kMWDr2pq7Zo=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/fancybox.js"></script>

  <script src="/js/third-party/pace.js"></script>


  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


 
        <div id="click-show-text"
            data-mobile = false
            data-text = 富强,民主,文明,和谐,自由,平等,公正,法制,爱国,敬业,诚信,友善
            data-fontsize = 15px
            data-random= false>
        </div>
       

      
        <script async src=https://cdn.jsdelivr.net/npm/hexo-next-mouse-effect@latest/click/showText.js></script>
      

      
    




    <script async src="/js/fancybox_param.js"></script>





<!-- APlayer本体 -->



</body>
</html>
