<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha256-wiz7ZSCn/btzhjKDQBms9Hx4sSeUYsDrTLg7roPstac=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.28/fancybox/fancybox.css" integrity="sha256-6cQIC71/iBIYXFK+0RHAvwmjwWzkWd+r7v/BX3/vZDc=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/green/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"sumumm.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.19.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"fold":{"enable":true,"height":300},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":true,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="本文主要是驱动程序简介的相关笔记，包括什么是驱动？Linux的体系结构是怎样的？若笔记中有错误或者不合适的地方，欢迎批评指正😃。">
<meta property="og:type" content="article">
<meta property="og:title" content="LV06-01-驱动程序-01-驱动程序基础">
<meta property="og:url" content="https://sumumm.github.io/post/333e1a11.html">
<meta property="og:site_name" content="苏木">
<meta property="og:description" content="本文主要是驱动程序简介的相关笔记，包括什么是驱动？Linux的体系结构是怎样的？若笔记中有错误或者不合适的地方，欢迎批评指正😃。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%E5%9F%BA%E7%A1%80/img/linux-system-1-300x298.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%E5%9F%BA%E7%A1%80/img/linux-system-2.jpg">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%E5%9F%BA%E7%A1%80/img/022ece3665208de1900660038c737eb220140221042342.gif">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%E5%9F%BA%E7%A1%80/img/efb4b3efc1f2ad15641770286c60632120140221042339.gif">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%E5%9F%BA%E7%A1%80/img/linux-system-3-300x245.jpeg">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%E5%9F%BA%E7%A1%80/img/ebdf81849e128bb2f1c63f6fa4a7300c20140221042345.gif">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%E5%9F%BA%E7%A1%80/img/c40020e12f187437d6b91e076f3d733320140221042347.gif">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%E5%9F%BA%E7%A1%80/img/linux-system-4.jpg">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%E5%9F%BA%E7%A1%80/img/linux-system-5.jpg">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%E5%9F%BA%E7%A1%80/img/linux-system-6.jpg">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%E5%9F%BA%E7%A1%80/img/linux-system-7.jpg">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%E5%9F%BA%E7%A1%80/img/linux-system-8.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%E5%9F%BA%E7%A1%80/img/linux-system-9.jpg">
<meta property="article:published_time" content="2024-11-16T12:07:00.000Z">
<meta property="article:modified_time" content="2025-06-13T16:25:57.048Z">
<meta property="article:author" content="苏木">
<meta property="article:tag" content="LV06-驱动开发">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%E5%9F%BA%E7%A1%80/img/linux-system-1-300x298.png">


<link rel="canonical" href="https://sumumm.github.io/post/333e1a11.html">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":"","permalink":"https://sumumm.github.io/post/333e1a11.html","path":"post/333e1a11.html","title":"LV06-01-驱动程序-01-驱动程序基础"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>LV06-01-驱动程序-01-驱动程序基础 | 苏木</title>
  








    <script src="/js/browser_tools_disable.js"></script>

  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<!-- hexo injector head_end start --><link rel="stylesheet" href="https://unpkg.com/hexo-next-tags-plus@latest/lib/tag_plus.css" media="defer" onload="this.media='all'"><!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">苏木</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">我的学习之路</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>苏木的家</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类页<span class="badge">42</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档页<span class="badge">673</span></a></li><li class="menu-item menu-item-flink"><a href="/flink/" rel="section"><i class="fa fa-link fa-fw"></i>友人帐</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于我</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F"><span class="nav-text">一、操作系统</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AF%E9%A9%B1%E5%8A%A8%EF%BC%9F"><span class="nav-text">二、什么是驱动？</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E9%A9%B1%E5%8A%A8"><span class="nav-text">1. 驱动</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-linux%E9%A9%B1%E5%8A%A8"><span class="nav-text">2. linux驱动</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%89%E3%80%81linux%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84"><span class="nav-text">三、linux体系结构</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-linux%E5%86%85%E6%A0%B8"><span class="nav-text">1. linux内核</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86"><span class="nav-text">1.1 内存管理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86"><span class="nav-text">1.2 进程管理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="nav-text">1.3 文件系统</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-%E8%AE%BE%E5%A4%87%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F"><span class="nav-text">1.4 设备驱动程序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-5-%E7%BD%91%E7%BB%9C%E6%8E%A5%E5%8F%A3%EF%BC%88NET%EF%BC%89"><span class="nav-text">1.5 网络接口（NET）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-Linux-Shell"><span class="nav-text">2. Linux Shell</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-linux-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="nav-text">3.  linux 文件系统</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-%E6%96%87%E4%BB%B6%E7%B1%BB%E5%9E%8B"><span class="nav-text">3.1 文件类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-Linux%E7%9B%AE%E5%BD%95"><span class="nav-text">3.2 Linux目录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-Linux%E7%A3%81%E7%9B%98%E5%88%86%E5%8C%BA"><span class="nav-text">3.3 Linux磁盘分区</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-1-%E4%B8%89%E7%A7%8D%E7%A1%AC%E7%9B%98%E5%88%86%E5%8C%BA"><span class="nav-text">3.3.1 三种硬盘分区</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-2-Linux%E4%B8%8B%E7%A1%AC%E7%9B%98%E5%88%86%E5%8C%BA%E7%9A%84%E6%A0%87%E8%AF%86"><span class="nav-text">3.3.2 Linux下硬盘分区的标识</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-3-Linux%E4%B8%8B%E7%A3%81%E7%9B%98%E5%88%86%E5%8C%BA%E5%92%8C%E7%9B%AE%E5%BD%95%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="nav-text">3.3.3 Linux下磁盘分区和目录的关系</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-linux%E4%B8%BB%E8%A6%81%E7%9B%AE%E5%BD%95%E7%9A%84%E7%94%A8%E9%80%94"><span class="nav-text">3.4 linux主要目录的用途</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-5-linux%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="nav-text">3.5 linux文件系统</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-5-1-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%B1%BB%E5%9E%8B"><span class="nav-text">3.5.1 文件系统类型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-5-2-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%89%B9%E6%80%A7"><span class="nav-text">3.5.2 文件系统特性</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-6-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%9C%A8%E5%86%85%E6%A0%B8%E4%B8%AD%E7%9A%84%E8%A1%A8%E7%A4%BA"><span class="nav-text">3.6 文件系统在内核中的表示</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-7-%E6%8C%82%E8%BD%BD%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="nav-text">3.7 挂载文件系统</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-7-1-%E4%BB%80%E4%B9%88%E6%98%AF%E6%8C%82%E8%BD%BD"><span class="nav-text">3.7.1 什么是挂载</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-7-2-%E6%8C%82%E8%BD%BD%E5%91%BD%E4%BB%A4"><span class="nav-text">3.7.2 挂载命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-7-3-%E6%8C%82%E8%BD%BD%E5%AE%9E%E4%BE%8B"><span class="nav-text">3.7.3 挂载实例</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-8-%E8%87%AA%E5%8A%A8%E6%8C%82%E8%BD%BDwindows%E5%88%86%E5%8C%BA"><span class="nav-text">3.8 自动挂载windows分区</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-9-%E6%96%87%E4%BB%B6%E7%9A%84%E4%B8%A4%E7%A7%8D%E9%93%BE%E6%8E%A5"><span class="nav-text">3.9 文件的两种链接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-10-%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%E7%AE%A1%E7%90%86%E5%91%BD%E4%BB%A4"><span class="nav-text">3.10 文件目录管理命令</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-linux-%E5%BA%94%E7%94%A8"><span class="nav-text">4. linux 应用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-linux%E5%86%85%E6%A0%B8%E5%8F%82%E6%95%B0%E4%BC%98%E5%8C%96"><span class="nav-text">5. linux内核参数优化</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9B%9B%E3%80%81%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%E5%88%86%E7%B1%BB"><span class="nav-text">四、驱动程序分类</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E4%B8%89%E7%B1%BB%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F"><span class="nav-text">1. 三类驱动程序</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-%E5%AD%97%E7%AC%A6%E8%AE%BE%E5%A4%87"><span class="nav-text">1.1 字符设备</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-%E5%9D%97%E8%AE%BE%E5%A4%87"><span class="nav-text">1.2 块设备</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87"><span class="nav-text">1.3 网络设备</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E4%B8%89%E4%B8%AA%E5%AF%B9%E8%B1%A1"><span class="nav-text">2. 三个对象</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="苏木"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">苏木</p>
  <div class="site-description" itemprop="description">莫道桑榆晚，为霞尚满天</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">673</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">42</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">43</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/sumumm" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;sumumm" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://sumumm.github.io/post/333e1a11.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="苏木">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="苏木">
      <meta itemprop="description" content="莫道桑榆晚，为霞尚满天">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="LV06-01-驱动程序-01-驱动程序基础 | 苏木">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          LV06-01-驱动程序-01-驱动程序基础
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-11-16 20:07:00" itemprop="dateCreated datePublished" datetime="2024-11-16T20:07:00+08:00">2024-11-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">嵌入式开发</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/" itemprop="url" rel="index"><span itemprop="name">02IMX6ULL平台</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">LV06-驱动开发</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>15k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>55 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>本文主要是驱动程序简介的相关笔记，包括什么是驱动？Linux的体系结构是怎样的？若笔记中有错误或者不合适的地方，欢迎批评指正😃。</p>
<span id="more"></span>

<!-- Photo: https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%E5%9F%BA%E7%A1%80/img/ -->

<details class="folding-tag" blue><summary> 点击查看使用工具及版本 </summary>
              <div class='content'>
              <table>    <tr>        <td align="center" rowspan="5">PC端开发环境</td>        <td align="center" width=150px>Windows</td>        <td align="left">Windows11</td>    </tr>    <tr>        <td align="center">Ubuntu</td>        <td align="left">Ubuntu20.04.2的64位版本</td>      </tr>    <tr>        <td align="center">VMware® Workstation 17 Pro</td>        <td align="left">17.6.0 build-24238078</td>      </tr>    <tr>        <td align="center">终端软件</td>        <td align="left">MobaXterm(Professional Edition v23.0 Build 5042 (license))</td>    </tr>    <tr>        <td align="center">Win32DiskImager</td>        <td align="left">Win32DiskImager v1.0</td>      </tr>    <tr>        <td align="center" rowspan="3">Linux开发板环境</td>        <td align="center">Linux开发板</td>        <td align="left">正点原子 i.MX6ULL Linux 阿尔法开发板</td>      </tr>    <tr>        <td align="center">uboot</td>        <td align="left">NXP官方提供的uboot，使用的uboot版本为U-Boot 2019.04</td>      </tr>    <tr>        <td align="center">linux内核</td>        <td align="left">linux-4.19.71(NXP官方提供)</td>      </tr></table>
              </div>
            </details>

<details class="folding-tag" blue><summary> 点击查看本文参考资料 </summary>
              <div class='content'>
              <table>    <tr>        <td align="center">分类</td>        <td align="center">网址</td>        <td align="center">说明</td>    </tr>    <tr>        <td align="center" rowspan="5">官方网站</td>        <td align="left"><a href="https://www.arm.com/" target="_blank">https://www.arm.com/</a></td>        <td align="left">ARM官方网站，在这里我们可以找到Cotex-Mx以及ARMVx的一些文档</td>    </tr>    <tr>        <td align="left"><a href="https://www.nxp.com.cn/" target="_blank">https://www.nxp.com.cn/ </a></td>        <td align="left">NXP官方网站</td>    </tr>    <tr>        <td align="left"><a href="https://www.nxpic.org.cn/" target="_blank">https://www.nxpic.org.cn/</a></td><td align="left">NXP 官方社区</td>    </tr>    <tr>        <td align="left"><a href="https://u-boot.readthedocs.io/en/latest/" target="_blank">https://u-boot.readthedocs.io/en/latest/</a></td><td align="left">u-boot官网</td>    </tr>    <tr>        <td align="left"><a href="https://www.kernel.org/" target="_blank">https://www.kernel.org/</a></td><td align="left">linux内核官网</td>    </tr></table>
              </div>
            </details>

<details class="folding-tag" blue><summary> 点击查看相关文件下载 </summary>
              <div class='content'>
              <table>    <tr>        <td align="center">分类</td>        <td align="center">网址</td>        <td align="center">说明</td>    </tr>    <tr>        <td align="center" rowspan="3">NXP</td>        <td align="left"><a href="https://github.com/nxp-imx" target="_blank">https://github.com/nxp-imx</a></td>        <td align="left">NXP imx开发资源GitHub组织，里边会有u-boot和linux内核的仓库</td>    </tr>    <tr>        <td align="left"><a href="https://github.com/nxp-imx/linux-imx/releases/tag/v4.19.71" target="_blank">nxp-imx/linux-imx/releases/tag/v4.19.71</a></td>        <td align="left">NXP linux内核仓库tags中的v4.19.71</td>    </tr>    <tr>        <td align="left"><a href="https://github.com/nxp-imx/uboot-imx/releases/tag/rel_imx_4.19.35_1.1.0" target="_blank">nxp-imx/uboot-imx/releases/tag/rel_imx_4.19.35_1.1.0</a></td>        <td align="left">NXP u-boot仓库tags中的rel_imx_4.19.35_1.1.0</td>    </tr>    <tr>        <td align="center" rowspan="2">I.MX6ULL</td>        <td align="left"><a href="https://www.nxp.com.cn/docs/en/data-sheet/IMX6ULLIEC.pdf" target="_blank">i.MX 6ULL Applications Processors for Industrial Products</a></td>        <td align="left">I.MX6ULL 芯片手册（datasheet，可以在线查看）</td>    </tr>    <tr>        <td align="left"><a href="https://www.nxp.com.cn/webapp/Download?colCode=IMX6ULLRM&lang_cd=zh" target="_blank">i.MX 6ULL Applications ProcessorReference Manual</a></td>        <td align="left">I.MX6ULL 参考手册（下载后才能查看，需要登录NXP官网）</td>    </tr>    <tr>        <td align="center" rowspan="2">Source Code</td>        <td align="left"><a href="https://elixir.bootlin.com/linux/latest/source" target="_blank">https://elixir.bootlin.com/linux/latest/source</a></td>        <td align="left">linux kernel源码</td>    </tr>    <tr>        <td align="left"><a href="https://elixir.bootlin.com/u-boot/latest/source" target="_blank">https://elixir.bootlin.com/u-boot/latest/source</a></td>        <td align="left">uboot源码</td>    </tr></table>
              </div>
            </details>

<h1 id="一、操作系统"><a href="#一、操作系统" class="headerlink" title="一、操作系统"></a><font size=3>一、操作系统</font></h1><p>计算机出现的时候，就是它只能执行一个任务，执行一个进程，也可以叫“裸跑”。向我们最开始接触的51单片机。</p>
<p>可以拿的手机来比喻，裸机的话，就是我们玩王者荣耀的时候，有人打电话进来的话，王者荣耀是要被终止的。后来就有了操作系统，操作系统可以保证多任务执行，同样的 CPU 芯片，有了操作系统，我可以开微信，QQ ，还同时做其他很多事情。</p>
<p>所以就出来了很多操作系统，操作系统可以<strong>分为实时操作系统和通用操作系统</strong>。</p>
<p>时操作系统（RTOS 全称Real Time Operating System）可以理解为对时间要求非常苛刻，可以用一个词“必须”来理解，就是在某个时间段之内必须要做某件事情。</p>
<p>通用操作系统很常见，比如电脑 windows，Android 手机，ios手机等，<strong>Linux</strong> <strong>也可以认为是通用</strong> **OS,**因为他们对时间要求不是很严苛。</p>
<p>Linux 可以通过配置某个宏定义变成实时操作系统，但是我们使用Linux 主要是针对他的通用 OS，多用户，多任务等特别突出的性能。</p>
<h1 id="二、什么是驱动？"><a href="#二、什么是驱动？" class="headerlink" title="二、什么是驱动？"></a><font size=3>二、什么是驱动？</font></h1><h2 id="1-驱动"><a href="#1-驱动" class="headerlink" title="1. 驱动"></a><font size=3>1. 驱动</font></h2><p>照字面意思就是给一个东西动力，让它动起来，至于物体怎么动是有一定的逻辑规律在里面的；对于电学中的硬件驱动来说，<strong>电力提供了动力，但是驱动程序提供了操作物体的逻辑方法</strong>。</p>
<p>比如我们的LED路灯照明，电让我们的LED灯亮起来，但是里面的程序检测到时间的变化控制电路的导通和断开，这里面的驱动程序就叫LED Driver。</p>
<h2 id="2-linux驱动"><a href="#2-linux驱动" class="headerlink" title="2. linux驱动"></a><font size=3>2. linux驱动</font></h2><p>linux驱动是linux内核驱动的全称。</p>
<p>linux驱动广义上是指操作硬件，让硬件工作起来的程序代码，这段代码就叫做硬件的驱动程序。但是在裸机开发中我们也经常会听到裸机驱动，其实严格意义上来说，没有操作系统是没有驱动概念的，如果非要说裸机驱动的话，也是指裸机中操作硬件的那部分程序。</p>
<p>linux驱动狭义上是指操作系统中用来控制硬件的逻辑方法的那部分代码。</p>
<p>对于这个定义我们可以从以下两方面去进行理解：</p>
<p>（1）操作系统有很多种，windows有windows驱动，ios有ios驱动，android有android驱动，而我们学习的linux驱动则是针对linux操作系统平台。</p>
<p>（2）linux驱动只是内核中的一部分，除了用来控制硬件的这部分外，还有文件系统，内存管理，内核调度等内容。</p>
<h1 id="三、linux体系结构"><a href="#三、linux体系结构" class="headerlink" title="三、linux体系结构"></a><font size=3>三、linux体系结构</font></h1><p>Linux系统一般有4个主要部分：内核、shell、文件系统和应用程序。内核、shell和文件系统一起形成了基本的操作系统结构，它们使得用户可以运行程序、管理文件并使用系统。</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%E5%9F%BA%E7%A1%80/img/linux-system-1-300x298.png" alt="带你真正认识Linux 系统结构带你真正认识Linux 系统结构" />

<h2 id="1-linux内核"><a href="#1-linux内核" class="headerlink" title="1. linux内核"></a><font size=3>1. linux内核</font></h2><p>内核是操作系统的核心，具有很多最基本功能，它负责管理系统的进程、内存、设备驱动程序、文件和网络系统，决定着系统的性能和稳定性。Linux 内核由如下几部分组成：内存管理、进程管理、设备驱动程序、文件系统和网络管理等。如图：</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%E5%9F%BA%E7%A1%80/img/linux-system-2.jpg" alt="带你真正认识Linux 系统结构带你真正认识Linux 系统结构" />

<p><strong>系统调用接口：</strong>SCI 层提供了某些机制执行从用户空间到内核的函数调用。这个接口依赖于体系结构，甚至在相同的处理器家族内也是如此。SCI 实际上是一个非常有用的函数调用多路复用和多路分解服务。在 .&#x2F;linux&#x2F;kernel 中您可以找到 SCI 的实现，并在 .&#x2F;linux&#x2F;arch 中找到依赖于体系结构的部分。</p>
<blockquote>
<p>Tips：</p>
<p>其核心功能就是：<strong>管理硬件设备，供应用程序使用</strong>。而现代计算机（无论是PC还是嵌入式系统）的标准组成，就是CPU、Memory（内存和外存）、输入输出设备、网络设备和其它的外围设备。</p>
</blockquote>
<h3 id="1-1-内存管理"><a href="#1-1-内存管理" class="headerlink" title="1.1 内存管理"></a><font size=3>1.1 内存管理</font></h3><p>对任何一台计算机而言，其内存以及其它资源都是有限的。为了让有限的物理内存满足应用程序对内存的大需求量，Linux 采用了称为“虚拟内存”的内存管理方式。Linux 将内存划分为容易处理的“内存页”（对于大部分体系结构来说都是 4KB）。Linux 包括了管理可用内存的方式，以及物理和虚拟映射所使用的硬件机制。</p>
<p>不过内存管理要管理的可不止 4KB 缓冲区。Linux 提供了对 4KB 缓冲区的抽象，例如 slab 分配器。这种内存管理模式使用 4KB 缓冲区为基数，然后从中分配结构，并跟踪内存页使用情况，比如哪些内存页是满的，哪些页面没有完全使用，哪些页面为空。这样就允许该模式根据系统需要来动态调整内存使用。</p>
<p>为了支持多个用户使用内存，有时会出现可用内存被消耗光的情况。由于这个原因，页面可以移出内存并放入磁盘中。这个过程称为交换，因为页面会被从内存交换到硬盘上。内存管理的源代码可以在 .&#x2F;linux&#x2F;mm 中找到。</p>
<p>内存管理子系统包括3个子模块（见下图），它们的功能如下：</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%E5%9F%BA%E7%A1%80/img/022ece3665208de1900660038c737eb220140221042342.gif" alt="mman" />

<ul>
<li>Architecture Specific Managers，体系结构相关部分。提供用于访问硬件Memory的虚拟接口。</li>
<li>Architecture Independent Manager，体系结构无关部分。提供所有的内存管理机制，包括：以进程为单位的memory mapping；虚拟内存的Swapping。</li>
<li>System Call Interface，系统调用接口。通过该接口，向用户空间程序应用程序提供内存的分配、释放，文件的map等功能。</li>
</ul>
<h3 id="1-2-进程管理"><a href="#1-2-进程管理" class="headerlink" title="1.2 进程管理"></a><font size=3>1.2 进程管理</font></h3><p><strong>进程实际是某特定应用程序的一个运行实体。</strong>在 Linux 系统中，能够同时运行多个进程，Linux 通过在短的时间间隔内轮流运行这些进程而实现“多任务”。这一短的时间间隔称为“时间片”，让进程轮流运行的方法称为“进程调度” ，完成调度的程序称为调度程序。</p>
<p><strong>进程调度控制进程对CPU的访问。</strong>在计算机中，CPU资源是有限的，而众多的应用程序都要使用CPU资源，所以需要“进程调度子系统”对CPU进行调度管理。当需要选择下一个进程运行时，由调度程序选择最值得运行的进程。可运行进程实际上是仅等待CPU资源的进程，如果某个进程在等待其它资源，则该进程是不可运行进程。Linux使用了比较简单的基于优先级的进程调度算法选择新的进程。</p>
<p>通过多任务机制，每个进程可认为只有自己独占计算机，从而简化程序的编写。每个进程有自己单独的地址空间，并且只能由这一进程访问，这样，操作系统避免了进程之间的互相干扰以及“坏”程序对系统可能造成的危害。 为了完成某特定任务，有时需要综合两个程序的功能，例如一个程序输出文本，而另一个程序对文本进行排序。为此，操作系统还提供进程间的通讯机制来帮助完成这样的任务。Linux 中常见的进程间通讯机制有信号、管道、共享内存、信号量和套接字等。</p>
<p>内核通过 SCI 提供了一个应用程序编程接口（API）来创建一个新进程（fork、exec 或 Portable Operating System Interface [POSⅨ] 函数），停止进程（kill、exit），并在它们之间进行通信和同步（signal 或者 POSⅨ 机制）。</p>
<p>进程调度子系统包括4个子模块（见下图），它们的功能如下：</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%E5%9F%BA%E7%A1%80/img/efb4b3efc1f2ad15641770286c60632120140221042339.gif" alt="scheduler" />

<ul>
<li><p>Scheduling Policy，实现进程调度的策略，它决定哪个（或哪几个）进程将拥有CPU。</p>
</li>
<li><p>Architecture-specific Schedulers，体系结构相关的部分，用于将对不同CPU的控制，抽象为统一的接口。这些控制主要在suspend和resume进程时使用，牵涉到CPU的寄存器访问、汇编指令操作等。</p>
</li>
<li><p>Architecture-independent Scheduler，体系结构无关的部分。它会和“Scheduling Policy模块”沟通，决定接下来要执行哪个进程，然后通过“Architecture-specific Schedulers模块”resume指定的进程。</p>
</li>
<li><p>System Call Interface，系统调用接口。进程调度子系统通过系统调用接口，将需要提供给用户空间的接口开放出去，同时屏蔽掉不需要用户空间程序关心的细节。</p>
</li>
</ul>
<h3 id="1-3-文件系统"><a href="#1-3-文件系统" class="headerlink" title="1.3 文件系统"></a><font size=3>1.3 文件系统</font></h3><p>和 DOS 等操作系统不同，Linux 操作系统中单独的文件系统并不是由驱动器号或驱动器名称（如 A: 或 C: 等）来标识的。相反，和 UNIX 操作系统一样，Linux 操作系统将独立的文件系统组合成了一个层次化的树形结构，并且由一个单独的实体代表这一文件系统。Linux 将新的文件系统通过一个称为“挂装”或“挂上”的操作将其挂装到某个目录上，从而让不同的文件系统结合成为一个整体。Linux 操作系统的一个重要特点是它支持许多不同类型的文件系统。Linux 中最普遍使用的文件系统是 Ext2，它也是 Linux 土生土长的文件系统。但 Linux 也能够支持 FAT、VFAT、FAT32、MINIX 等不同类型的文件系统，从而可以方便地和其它操作系统交换数据。由于 Linux 支持许多不同的文件系统，并且将它们组织成了一个统一的虚拟文件系统.</p>
<p><strong>虚拟文件系统（VirtualFileSystem,VFS）</strong>：隐藏了各种硬件的具体细节，把文件系统操作和不同文件系统的具体实现细节分离了开来，为所有的设备提供了统一的接口，VFS提供了多达数十种不同的文件系统。虚拟文件系统可以分为逻辑文件系统和设备驱动程序。逻辑文件系统指Linux所支持的文件系统，如ext2,fat等，设备驱动程序指为每一种硬件控制器所编写的设备驱动程序模块。</p>
<p>虚拟文件系统（VFS）是 Linux 内核中非常有用的一个方面，因为它为文件系统提供了一个通用的接口抽象。VFS 在 SCI 和内核所支持的文件系统之间提供了一个交换层。即VFS在用户和文件系统之间提供了一个交换层。</p>
<p>VFS在用户和文件系统之间提供了一个交换层:</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%E5%9F%BA%E7%A1%80/img/linux-system-3-300x245.jpeg" alt="带你真正认识Linux 系统结构带你真正认识Linux 系统结构" />

<p>在 VFS 上面，是对诸如 open、close、read 和 write 之类的函数的一个通用 API 抽象。在 VFS 下面是文件系统抽象，它定义了上层函数的实现方式。它们是给定文件系统（超过 50 个）的插件。文件系统的源代码可以在 .&#x2F;linux&#x2F;fs 中找到。</p>
<p>文件系统层之下是缓冲区缓存，它为文件系统层提供了一个通用函数集（与具体文件系统无关）。这个缓存层通过将数据保留一段时间（或者随即预先读取数据以便在需要是就可用）优化了对物理设备的访问。缓冲区缓存之下是设备驱动程序，它实现了特定物理设备的接口。</p>
<p>因此，用户和进程不需要知道文件所在的文件系统类型，而只需要象使用 Ext2 文件系统中的文件一样使用它们。</p>
<p>VFS子系统包括6个子模块（见下图），它们的功能如下：</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%E5%9F%BA%E7%A1%80/img/ebdf81849e128bb2f1c63f6fa4a7300c20140221042345.gif" alt="vfs" />

<ul>
<li><p>Device Drivers，设备驱动，用于控制所有的外部设备及控制器。由于存在大量不能相互兼容的硬件设备（特别是嵌入式产品），所以也有非常多的设备驱动。因此，Linux内核中将近一半的Source Code都是设备驱动，大多数的Linux底层工程师都是在编写或者维护设备驱动，而无暇估计其它内容（它们恰恰是Linux内核的精髓所在）。</p>
</li>
<li><p>Device Independent Interface， 该模块定义了描述硬件设备的统一方式（统一设备模型），所有的设备驱动都遵守这个定义，可以降低开发的难度。同时可以用一致的形势向上提供接口。</p>
</li>
<li><p>Logical Systems，每一种文件系统，都会对应一个Logical System（逻辑文件系统），它会实现具体的文件系统逻辑。</p>
</li>
<li><p>System Independent Interface，该模块负责以统一的接口（快设备和字符设备）表示硬件设备和逻辑文件系统，这样上层软件就不再关心具体的硬件形态了。</p>
</li>
<li><p>System Call Interface，系统调用接口，向用户空间提供访问文件系统和硬件设备的统一的接口。</p>
</li>
</ul>
<h3 id="1-4-设备驱动程序"><a href="#1-4-设备驱动程序" class="headerlink" title="1.4 设备驱动程序"></a><font size=3>1.4 设备驱动程序</font></h3><p>设备驱动程序是 Linux 内核的主要部分。和操作系统的其它部分类似，设备驱动程序运行在高特权级的处理器环境中，从而可以直接对硬件进行操作，但正因为如此，任何一个设备驱动程序的错误都可能导致操作系统的崩溃。设备驱动程序实际控制操作系统和硬件设备之间的交互。</p>
<p>设备驱动程序提供一组操作系统可理解的抽象接口完成和操作系统之间的交互，而与硬件相关的具体操作细节由设备驱动程序完成。一般而言，设备驱动程序和设备的控制芯片有关，例如，如果计算机硬盘是 SCSI 硬盘，则需要使用 SCSI 驱动程序，而不是 IDE 驱动程序。</p>
<h3 id="1-5-网络接口（NET）"><a href="#1-5-网络接口（NET）" class="headerlink" title="1.5 网络接口（NET）"></a><font size=3>1.5 网络接口（NET）</font></h3><p>提供了对各种网络标准的存取和各种网络硬件的支持。网络接口可分为网络协议和网络驱动程序。网络协议部分负责实现每一种可能的网络传输协议。众所周知，TCP&#x2F;IP 协议是 Internet 的标准协议，同时也是事实上的工业标准。</p>
<p>Linux 的网络实现支持 BSD 套接字，支持全部的TCP&#x2F;IP协议。Linux内核的网络部分由BSD套接字、网络协议层和网络设备驱动程序组成。网络设备驱动程序负责与硬件设备通讯，每一种可能的硬件设备都有相应的设备驱动程序。</p>
<p>在Linux内核中，网络接口几乎是自成体系，它包括5个子模块（见下图），它们的功能如下：</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%E5%9F%BA%E7%A1%80/img/c40020e12f187437d6b91e076f3d733320140221042347.gif" alt="net" />

<ul>
<li>Network Device Drivers，网络设备的驱动，和VFS子系统中的设备驱动是一样的。</li>
<li>Device Independent Interface，和VFS子系统中的是一样的。</li>
<li>Network Protocols，实现各种网络传输协议，例如IP, TCP, UDP等等。</li>
<li>Protocol Independent Interface，屏蔽不同的硬件设备和网络协议，以相同的格式提供接口（socket)。</li>
<li>System Call interface，系统调用接口，向用户空间提供访问网络设备的统一的接口。</li>
</ul>
<h2 id="2-Linux-Shell"><a href="#2-Linux-Shell" class="headerlink" title="2. Linux Shell"></a><font size=3>2. Linux Shell</font></h2><p>shell是系统的用户界面，提供了用户与内核进行交互操作的一种接口。它接收用户输入的命令并把它送入内核去执行，是一个命令解释器。另外，shell编程语言具有普通编程语言的很多特点，用这种编程语言编写的shell程序与其他应用程序具有同样的效果。</p>
<p>目前主要有下列版本的shell。</p>
<p>（1）<strong>Bourne Shell：</strong>是贝尔实验室开发的。</p>
<p>（2）<strong>BASH：</strong>是GNU的Bourne Again Shell，是GNU操作系统上默认的shell,大部分linux的发行套件使用的都是这种shell。</p>
<p>（3）<strong>Korn Shell：</strong>是对Bourne SHell的发展，在大部分内容上与Bourne Shell兼容。</p>
<p>（4）<strong>C Shell：</strong>是SUN公司Shell的BSD版本。</p>
<h2 id="3-linux-文件系统"><a href="#3-linux-文件系统" class="headerlink" title="3.  linux 文件系统"></a><font size=3>3.  linux 文件系统</font></h2><p>文件系统是文件存放在磁盘等存储设备上的组织方法。Linux系统能支持多种目前流行的文件系统，如EXT2、 EXT3、 FAT、 FAT32、 VFAT和ISO9660。</p>
<h3 id="3-1-文件类型"><a href="#3-1-文件类型" class="headerlink" title="3.1 文件类型"></a><font size=3>3.1 文件类型</font></h3><p>Linux下面的文件类型主要有：</p>
<ul>
<li>普通文件：C语言元代码、SHELL脚本、二进制的可执行文件等。分为纯文本和二进制。</li>
<li>目录文件：目录，存储文件的唯一地方。</li>
<li>链接文件：指向同一个文件或目录的的文件。</li>
<li>设备文件：与系统外设相关的，通常在&#x2F;dev下面。分为块设备和字符设备。</li>
<li>管道(FIFO)文件: 提供进程之间通信的一种方式</li>
<li>套接字(socket) 文件： 该文件类型与网络通信有关</li>
</ul>
<p>可以通过<code>ls –l</code>, <code>file</code>, <code>stat</code>几个命令来查看文件的类型等相关信息。</p>
<h3 id="3-2-Linux目录"><a href="#3-2-Linux目录" class="headerlink" title="3.2 Linux目录"></a><font size=3>3.2 Linux目录</font></h3><p>文件结构是文件存放在磁盘等存贮设备上的组织方法。主要体现在对文件和目录的组织上，目录提供了管理文件的一个方便而有效的途径。</p>
<p>Linux使用标准的目录结构，在安装的时候，安装程序就已经为用户创建了文件系统和完整而固定的目录组成形式，并指定了每个目录的作用和其中的文件类型。</p>
<p>完整的目录树可划分为小的部分，这些小部分又可以单独存放在自己的磁盘或分区上。这样，相对稳定的部分和经常变化的部分可单独存放在不同的分区中，从而方便备份或系统管理。目录树的主要部分有 root、&#x2F;usr、&#x2F;var、&#x2F;home 等。这样的布局可方便在 Linux 计算机之间共享文件系统的某些部分。</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%E5%9F%BA%E7%A1%80/img/linux-system-4.jpg" alt="带你真正认识Linux 系统结构带你真正认识Linux 系统结构" />

<p>Linux采用的是树型结构。最上层是根目录，其他的所有目录都是从根目录出发而生成的。</p>
<p>微软的DOS和windows也是采用树型结构，但是在DOS和windows中这样的树型结构的根是磁盘分区的盘符，有几个分区就有几个树型结构，他们之间的关系是并列的。最顶部的是不同的磁盘（分区），如：C，D，E，F等。</p>
<p>但是在linux中，无论操作系统管理几个磁盘分区，这样的目录树只有一个。从结构上讲，各个磁盘分区上的树型目录不一定是并列的。</p>
<h3 id="3-3-Linux磁盘分区"><a href="#3-3-Linux磁盘分区" class="headerlink" title="3.3 Linux磁盘分区"></a><font size=3>3.3 Linux磁盘分区</font></h3><h4 id="3-3-1-三种硬盘分区"><a href="#3-3-1-三种硬盘分区" class="headerlink" title="3.3.1 三种硬盘分区"></a><font size=3>3.3.1 三种硬盘分区</font></h4><p>linux分区不同于windows，硬盘和硬盘分区在Linux都表示为设备。硬盘分区一共有三种：主分区，扩展分区和逻辑分区。</p>
<p>硬盘的分区主要分为主分区(Primary Partion)和扩展分区(Extension Partion)两种，主分区和扩展分区的数目之和不能大于四个。</p>
<ul>
<li><p><strong>主分区(Primary Partion)：</strong>可以马上被使用但不能再分区。</p>
</li>
<li><p><strong>扩展分区(Extension Partion)：</strong>必须再进行分区后才能使用，也就是说它必须还要进行二次分区。</p>
</li>
<li><p><strong>逻辑分区((Logical Partion))：</strong>由扩展分区建立起来的分区，逻辑分区没有数量上限制。</p>
</li>
</ul>
<p>扩展分区只不过是逻辑分区的“容器”，实际上只有主分区和逻辑分区进行数据存储。</p>
<h4 id="3-3-2-Linux下硬盘分区的标识"><a href="#3-3-2-Linux下硬盘分区的标识" class="headerlink" title="3.3.2 Linux下硬盘分区的标识"></a><font size=3>3.3.2 Linux下硬盘分区的标识</font></h4><p><strong>硬盘分区的标识</strong>一般使用&#x2F;dev&#x2F;hd[a-z]X或者&#x2F;dev&#x2F;sd[a-z]X来标识，其中[a-z]代表硬盘号，X代表硬盘内的分区号。</p>
<p><strong>整块硬盘分区的块号标识</strong>：Linux下用hda、hdb、sda、sdb 等来标识不同的硬盘。其中：</p>
<ul>
<li><p>IDE接口硬盘：表示为&#x2F;dev&#x2F;hda1、&#x2F;dev&#x2F;hdb …；</p>
</li>
<li><p>SCSI 接口的硬盘、SATA接口的硬盘表示为&#x2F;dev&#x2F;sda、&#x2F;dev&#x2F;sdb … … ；</p>
</li>
</ul>
<p><strong>硬盘内的分区：</strong>如果X的值是1到4,表示硬盘的主分区（包含扩展分区）；逻辑分区从是从5开始的，比如&#x2F;dev&#x2F;hda5肯定是逻辑分区了；</p>
<p>例如：用hda1、hda2、 hda5、hda6 来标识不同的分区。其中，字母a代表第一块硬盘，b代表第二块硬盘，依次类推。而数字1 代表一块硬盘的第一个分区、2 代表第二个分区，依次类推。1 到4 对应的是主分区(Primary Partition)或扩展分区(Extension Partition)。从5开始，对应的都是硬盘的逻辑分区(Logical Partition)。<strong>一块硬盘即使只有一个主分区，逻辑分区也是从5开始编号的，这点应特别注意。</strong></p>
<blockquote>
<p>一个硬盘分区首先要确认在哪个硬盘，然后再确认它所在硬盘内的哪个分区。</p>
</blockquote>
<p>对于&#x2F;dev&#x2F;hda 类似的表示方法，也并不陌生吧；我们在Linux通过fdisk -l 就可以查到硬盘是&#x2F;dev&#x2F;hda还是&#x2F;dev&#x2F;hdb：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">sumu@sumu-virtual-machine:~$ sudo fdisk -l</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">......</span></span><br><span class="line">Disk /dev/sda：512 GiB，549755813888 字节，1073741824 个扇区</span><br><span class="line">Disk model: VMware Virtual S</span><br><span class="line">单元：扇区 / 1 * 512 = 512 字节</span><br><span class="line">扇区大小(逻辑/物理)：512 字节 / 512 字节</span><br><span class="line">I/O 大小(最小/最佳)：512 字节 / 512 字节</span><br><span class="line">磁盘标签类型：dos</span><br><span class="line">磁盘标识符：0x006baca8</span><br><span class="line"></span><br><span class="line">设备       启动    起点       末尾       扇区   大小 Id 类型</span><br><span class="line">/dev/sda1  *       2048    1050623    1048576   512M  b W95 FAT32</span><br><span class="line">/dev/sda2       1052670 1073739775 1072687106 511.5G  5 扩展</span><br><span class="line">/dev/sda5       1052672 1073739775 1072687104 511.5G 83 Linux</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">......</span></span><br></pre></td></tr></table></figure>

<p>请注意第一行， Disk &#x2F;dev&#x2F;sda：512 GiB，549755813888 字节，1073741824 个扇区，这个就是表示机器中只有一个硬盘设备&#x2F;dev&#x2F;sda ，体积大小为512G；下面的就是硬盘的分区，每个分区都有详细的信息，在这里不详细说了。</p>
<h4 id="3-3-3-Linux下磁盘分区和目录的关系"><a href="#3-3-3-Linux下磁盘分区和目录的关系" class="headerlink" title="3.3.3 Linux下磁盘分区和目录的关系"></a><font size=3>3.3.3 Linux下磁盘分区和目录的关系</font></h4><ul>
<li>任何一个分区都必须挂载到某个目录上。</li>
<li>目录是逻辑上的区分。分区是物理上的区分。</li>
<li>磁盘Linux分区都必须挂载到目录树中的某个具体的目录上才能进行读写操作。</li>
<li>根目录是所有Linux的文件和目录所在的地方，需要挂载上一个磁盘分区。</li>
</ul>
<h3 id="3-4-linux主要目录的用途"><a href="#3-4-linux主要目录的用途" class="headerlink" title="3.4 linux主要目录的用途"></a><font size=3>3.4 linux主要目录的用途</font></h3><p>&#x2F;bin 二进制可执行命令</p>
<p>&#x2F;dev 设备特殊文件</p>
<p>&#x2F;etc 系统管理和配置文件</p>
<p>&#x2F;etc&#x2F;rc.d 启动的配置文件和脚本</p>
<p>&#x2F;home 用户主目录的基点，比如用户user的主目录就是&#x2F;home&#x2F;user，可以用~user表示</p>
<p>&#x2F;lib 标准程序设计库，又叫动态链接共享库，作用类似windows里的.dll文件</p>
<p>&#x2F;sbin 系统管理命令，这里存放的是系统管理员使用的管理程序</p>
<p>&#x2F;tmp 公用的临时文件存储点</p>
<p>&#x2F;root 系统管理员的主目录</p>
<p>&#x2F;mnt 系统提供这个目录是让用户临时挂载其他的文件系统。</p>
<p>&#x2F;lost+found 这个目录平时是空的，系统非正常关机而留下“无家可归”的文件（windows下叫什么.chk）就在这里</p>
<p>&#x2F;proc 虚拟的目录，是系统内存的映射。可直接访问这个目录来获取系统信息。</p>
<p>&#x2F;var 某些大文件的溢出区，比方说各种服务的日志文件</p>
<p>&#x2F;usr 最庞大的目录，要用到的应用程序和文件几乎都在这个目录。其中包含：</p>
<p>&#x2F;usr&#x2F;X11R6 存放X window的目录</p>
<p>&#x2F;usr&#x2F;bin 众多的应用程序</p>
<p>&#x2F;usr&#x2F;sbin 超级用户的一些管理程序</p>
<p>&#x2F;usr&#x2F;doc linux文档</p>
<p>&#x2F;usr&#x2F;include linux下开发和编译应用程序所需要的头文件</p>
<p>&#x2F;usr&#x2F;lib 常用的动态链接库和软件包的配置文件</p>
<p>&#x2F;usr&#x2F;man 帮助文档</p>
<p>&#x2F;usr&#x2F;src 源代码，linux内核的源代码就放在&#x2F;usr&#x2F;src&#x2F;linux里</p>
<p>&#x2F;usr&#x2F;local&#x2F;bin 本地增加的命令</p>
<p>&#x2F;usr&#x2F;local&#x2F;lib 本地增加的库</p>
<h3 id="3-5-linux文件系统"><a href="#3-5-linux文件系统" class="headerlink" title="3.5 linux文件系统"></a><font size=3>3.5 linux文件系统</font></h3><p>文件系统指文件存在的物理空间，linux系统中每个分区都是一个文件系统，都有自己的目录层次结构。linux会将这些分属不同分区的、单独的文件系统按一定的方式形成一个系统的总的目录层次结构。一个操作系统的运行离不开对文件的操作，因此必然要拥有并维护自己的文件系统。</p>
<h4 id="3-5-1-文件系统类型"><a href="#3-5-1-文件系统类型" class="headerlink" title="3.5.1 文件系统类型"></a><font size=3>3.5.1 文件系统类型</font></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">ext2 ： 早期linux中常用的文件系统</span><br><span class="line">ext3 ： ext2的升级版，带日志功能</span><br><span class="line">RAMFS ： 内存文件系统，速度很快</span><br><span class="line">NFS ： 网络文件系统，由SUN发明，主要用于远程文件共享</span><br><span class="line">MS-DOS ： MS-DOS文件系统</span><br><span class="line">VFAT ： Windows 95/98 操作系统采用的文件系统</span><br><span class="line">FAT ： Windows XP 操作系统采用的文件系统</span><br><span class="line">NTFS： Windows NT/XP 操作系统采用的文件系统</span><br><span class="line">HPFS ： OS/2 操作系统采用的文件系统</span><br><span class="line">PROC : 虚拟的进程文件系统</span><br><span class="line">ISO9660 ： 大部分光盘所采用的文件系统</span><br><span class="line">ufsSun : OS 所采用的文件系统</span><br><span class="line">NCPFS ： Novell 服务器所采用的文件系统</span><br><span class="line">SMBFS ： Samba 的共享文件系统</span><br><span class="line">XFS ： 由SGI开发的先进的日志文件系统，支持超大容量文件</span><br><span class="line">JFS ：IBM的AIX使用的日志文件系统</span><br><span class="line">ReiserFS : 基于平衡树结构的文件系统</span><br><span class="line">udf: 可擦写的数据光盘文件系统</span><br></pre></td></tr></table></figure>

<h4 id="3-5-2-文件系统特性"><a href="#3-5-2-文件系统特性" class="headerlink" title="3.5.2 文件系统特性"></a><font size=3>3.5.2 文件系统特性</font></h4><p>磁盘分区完毕后还需要进行格式化(format)，之后操作系统才能够使用这个分区。 格式化的目的是能使操作系统可以使用的文件系统格式（即我们上面提到文件系统类型）.</p>
<p>每种操作系统能够使用的文件系统并不相同. 如windows 98 以前的微软操作系统主要利用的文件系统是 FAT (或 FAT16)，windows 2000 以后的版本有所谓的 NTFS 文件系统，至于 Linux 的正统文件系统则为 Ext2 (Linux second extended file system, ext2fs)这一个。此外，在默认的情况下，windows 操作系统是不会认识 Linux 的 Ext2 的。</p>
<p>传统的磁盘与文件系统之应用中，一个分区就是只能够被格式化成为一个文件系统，所以我们可以说一个 filesystem 就是一个 partition。但是由于新技术的利用，例如我们常听到的LVM与软件磁盘阵列(software raid)， 这些技术可以将一个分区格式化为多个文件系统(例如LVM)，也能够将多个分区合成一个文件系统(LVM, RAID)！ 所以说，目前我们在格式化时已经不再说成针对 partition 来格式化了， 通常我们可以称呼一个可被挂载的数据为一个文件系统而不是一个分区！</p>
<p>那么文件系统是如何运行的呢？这与操作系统的文件数据有关。较新的操作系统的文件数据除了文件实际内容外， 通常含有非常多的属性，例如 Linux 操作系统的文件权限(rwx)与文件属性(拥有者、群组、时间参数等)。 文件系统通常会将这两部份的数据分别存放在不同的区块，权限与属性放置到 inode 中，至于实际数据则放置到 data block 区块中。 另外，还有一个超级区块 (superblock) 会记录整个文件系统的整体信息，包括 inode 与 block 的总量、使用量、剩余量等。</p>
<p>对于一个磁盘分区来说，在被指定为相应的文件系统后，整个分区被分为 1024，2048 和 4096 字节大小的块。根据块使用的不同，可分为：</p>
<p>超级块（Superblock）：这是整个文件系统的第一块空间。包括整个文件系统的基本信息，如块大小，inode&#x2F;block的总量、使用量、剩余量，指向空间 inode 和数据块的指针等相关信息。</p>
<p>inode块（文件索引节点）：文件系统索引,记录文件的属性。它是文件系统的最基本单元，是文件系统连接任何子目录、任何文件的桥梁。每个子目录和文件只有唯一的一个 inode 块。它包含了文件系统中文件的基本属性(文件的长度、创建及修改时间、权限、所属关系)、存放数据的位置等相关信息. 在 Linux 下可以通过 “ls -li” 命令查看文件的 inode 信息。硬连接和源文件具有相同的 inode 。</p>
<p>数据块(Block) ：实际记录文件的内容，若文件太大时，会占用多个block。为了提高目录访问效率，Linux还提供了表达路径与inode对应关系的dentry结构。它描述了路径信息并连接到节点inode，它包括各种目录信息，还指向了inode和超级块。</p>
<p>就像一本书有封面、目录和正文一样。在文件系统中，超级块就相当于封面，从封面可以得知这本书的基本信息； inode 块相当于目录，从目录可以得知各章节内容的位置；而数据块则相当于书的正文，记录着具体内容。</p>
<p>Linux正统的文件系统(如ext2、3等)将硬盘分区时会划分出超级块、inode Table区块和data block数据区域。一个文件由一个超级块、inode和数据区域块组成。Inode包含文件的属性(如读写属性、owner等，以及指向数据块的指针)，数据区域块则是文件内容。当查看某个文件时，会先从inode table中查出文件属性及数据存放点，再从数据块中读取数据。</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%E5%9F%BA%E7%A1%80/img/linux-system-5.jpg" alt="带你真正认识Linux 系统结构带你真正认识Linux 系统结构" />

<p>我们将 inode与block区块用图解来说明一下，如下图所示，文件系统先格式化出inode与block的区块，假设某一个文件的属性与权限数据是放置到 inode 4号(下图较小方格内)，而这个inode记录了文件数据的实际放置点为 2, 7, 13, 15 这四个 block 号码，此时我们的操作系统就能够据此来排列磁盘的阅读顺序，可以一口气将四个 block 内容读出来！ 那么数据的读取就如同下图中的箭头所指定的模样了。</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%E5%9F%BA%E7%A1%80/img/linux-system-6.jpg" alt="带你真正认识Linux 系统结构带你真正认识Linux 系统结构" />

<p><strong>这种数据存取的方法我们称为索引式文件系统(indexed allocation)。</strong>那有没有其他的惯用文件系统可以比较一下啊？ 有的，那就是我们惯用的闪盘(闪存)，闪盘使用的文件系统一般为 FAT 格式。FAT 这种格式的文件系统并没有 inode 存在，所以 FAT 没有办法将这个文件的所有 block 在一开始就读取出来。每个 block 号码都记录在前一个 block 当中， 其读取方式有点像下图所示:</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%E5%9F%BA%E7%A1%80/img/linux-system-7.jpg" alt="带你真正认识Linux 系统结构带你真正认识Linux 系统结构" />

<p>上图中我们假设文件的数据依序写入1&rarr;7&rarr;4&rarr;15号这四个 block 号码中， 但这个文件系统没有办法一口气就知道四个 block 的号码，他得要一个一个的将 block 读出后，才会知道下一个 block 在何处。 如果同一个文件数据写入的 block 分散的太过厉害时，则我们的磁盘读取头将无法在磁盘转一圈就读到所有的数据， 因此磁盘就会多转好几圈才能完整的读取到这个文件的内容！</p>
<p><strong>常常会听到所谓的“碎片整理”吧？</strong> 需要碎片整理的原因就是文件写入的 block 太过于离散了，此时文件读取的效能将会变的很差所致。 这个时候可以透过碎片整理将同一个文件所属的 blocks 汇整在一起，这样数据的读取会比较容易啊！ 想当然，FAT 的文件系统需要经常的碎片整理一下，那么 Ext2 是否需要磁盘重整呢？</p>
<p><strong>由于 Ext2 是索引式文件系统，</strong>基本上不太需要常常进行碎片整理的。但是如果文件系统使用太久， 常常删除&#x2F;编辑&#x2F;新增文件时，那么还是可能会造成文件数据太过于离散的问题，此时或许会需要进行重整一下的。</p>
<h3 id="3-6-文件系统在内核中的表示"><a href="#3-6-文件系统在内核中的表示" class="headerlink" title="3.6 文件系统在内核中的表示"></a><font size=3>3.6 文件系统在内核中的表示</font></h3><p>Linux内核的VFS子系统可以图示如下：</p>
<p><img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%E5%9F%BA%E7%A1%80/img/linux-system-8.png" alt="带你真正认识Linux 系统结构带你真正认识Linux 系统结构"></p>
<p>文件与IO: 每个进程在PCB（Process Control Block）中都保存着一份文件描述符表，文件描述符就是这个表的索引，每个表项都有一个指向已打开文件的指针，现在我们明确一下：已打开的文件在内核中用file结构体表示，文件描述符表中的指针指向file结构体。</p>
<p>在file结构体中维护File Status Flag（file结构体的成员f_flags）和当前读写位置（file结构体的成员f_pos）。在上图中，进程1和进程2都打开同一文件，但是对应不同的file结构体，因此可以有不同的File Status Flag和读写位置。file结构体中比较重要的成员还有f_count，表示引用计数（Reference Count），后面我们会讲到，dup、fork等系统调用会导致多个文件描述符指向同一个file结构体，例如有fd1和fd2都引用同一个file结构体，那么它的引用计数就是2，当close(fd1)时并不会释放file结构体，而只是把引用计数减到1，如果再close(fd2)，引用计数就会减到0同时释放file结构体，这才真的关闭了文件。</p>
<p>每个file结构体都指向一个file_operations结构体，这个结构体的成员都是函数指针，指向实现各种文件操作的内核函数。比如在用户程序中read一个文件描述符，read通过系统调用进入内核，然后找到这个文件描述符所指向的file结构体，找到file结构体所指向的file_operations结构体，调用它的read成员所指向的内核函数以完成用户请求。在用户程序中调用lseek、read、write、ioctl、open等函数，最终都由内核调用file_operations的各成员所指向的内核函数完成用户请求。</p>
<p>file_operations结构体中的release成员用于完成用户程序的close请求，之所以叫release而不叫close是因为它不一定真的关闭文件，而是减少引用计数，只有引用计数减到0才关闭文件。对于同一个文件系统上打开的常规文件来说，read、write等文件操作的步骤和方法应该是一样的，调用的函数应该是相同的，所以图中的三个打开文件的file结构体指向同一个file_operations结构体。如果打开一个字符设备文件，那么它的read、write操作肯定和常规文件不一样，不是读写磁盘的数据块而是读写硬件设备，所以file结构体应该指向不同的file_operations结构体，其中的各种文件操作函数由该设备的驱动程序实现。</p>
<p>每个file结构体都有一个指向dentry结构体的指针，“dentry”是directory entry（目录项）的缩写。我们传给open、stat等函数的参数的是一个路径，例如&#x2F;home&#x2F;akaedu&#x2F;a，需要根据路径找到文件的inode。为了减少读盘次数，内核缓存了目录的树状结构，称为dentry cache，其中每个节点是一个dentry结构体，只要沿着路径各部分的dentry搜索即可，从根目录&#x2F;找到home目录，然后找到akaedu目录，然后找到文件a。dentry cache只保存最近访问过的目录项，如果要找的目录项在cache中没有，就要从磁盘读到内存中。</p>
<p>每个dentry结构体都有一个指针指向inode结构体。inode结构体保存着从磁盘inode读上来的信息。在上图的例子中，有两个dentry，分别表示&#x2F;home&#x2F;akaedu&#x2F;a和&#x2F;home&#x2F;akaedu&#x2F;b，它们都指向同一个inode，说明这两个文件互为硬链接。inode结构体中保存着从磁盘分区的inode读上来信息，例如所有者、文件大小、文件类型和权限位等。每个inode结构体都有一个指向inode_operations结构体的指针，后者也是一组函数指针指向一些完成文件目录操作的内核函数。</p>
<p>和file_operations不同，inode_operations所指向的不是针对某一个文件进行操作的函数，而是影响文件和目录布局的函数，例如添加删除文件和目录、跟踪符号链接等等，属于同一文件系统的各inode结构体可以指向同一个inode_operations结构体。</p>
<p>inode结构体有一个指向super_block结构体的指针。super_block结构体保存着从磁盘分区的超级块读上来的信息，例如文件系统类型、块大小等。super_block结构体的s_root成员是一个指向dentry的指针，表示这个文件系统的根目录被mount到哪里，在上图的例子中这个分区被mount到&#x2F;home目录下。</p>
<p>file、dentry、inode、super_block这几个结构体组成了VFS的核心概念。对于ext2文件系统来说，在磁盘存储布局上也有inode和超级块的概念，所以很容易和VFS中的概念建立对应关系。而另外一些文件系统格式来自非UNIX系统（例如Windows的FAT32、NTFS），可能没有inode或超级块这样的概念，但为了能mount到Linux系统，也只好在驱动程序中硬凑一下，在Linux下看FAT32和NTFS分区会发现权限位是错的，所有文件都是rwxrwxrwx，因为它们本来就没有inode和权限位的概念，这是硬凑出来的。</p>
<h3 id="3-7-挂载文件系统"><a href="#3-7-挂载文件系统" class="headerlink" title="3.7 挂载文件系统"></a><font size=3>3.7 挂载文件系统</font></h3><h4 id="3-7-1-什么是挂载"><a href="#3-7-1-什么是挂载" class="headerlink" title="3.7.1 什么是挂载"></a><font size=3>3.7.1 什么是挂载</font></h4><p>linux系统中每个分区都是一个文件系统，都有自己的目录层次结构。linux会将这些分属不同分区的、单独的文件系统按一定的方式形成一个系统的总的目录层次结构。这里所说的“按一定方式”就是指的挂载。</p>
<p>将一个文件系统的顶层目录挂到另一个文件系统的子目录上，使它们成为一个整体，称为挂载。把该子目录称为挂载点.</p>
<p>例如要读取硬盘中的一个格式化好的分区、光盘或软件等设备时，必须先把这些设备对应到某个目录上，而这个目录就称为“挂载点（mount point）”，这样才可以读取这些设备。 挂载后将物理分区细节屏蔽掉，用户只有统一的逻辑概念。所有的东西都是文件。</p>
<p><strong>注意：</strong></p>
<p>（1）挂载点必须是一个目录。</p>
<p>（2）一个分区挂载在一个已存在的目录上，这个目录可以不为空，但挂载后这个目录下以前的内容将不可用。</p>
<p>对于其他操作系统建立的文件系统的挂载也是这样。但是需要理解的是：光盘、软盘、其他操作系统使用的文件系统的格式与linux使用的文件系统格式是不一样的。光盘是ISO9660；软盘是fat16或ext2；windows NT是fat16、NTFS；windows98是fat16、fat32；windows2000和windowsXP是fat16、fat32、 NTFS。挂载前要了解linux是否支持所要挂载的文件系统格式。</p>
<h4 id="3-7-2-挂载命令"><a href="#3-7-2-挂载命令" class="headerlink" title="3.7.2 挂载命令"></a><font size=3>3.7.2 挂载命令</font></h4><p>挂载时使用mount命令，其格式：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount [-参数] [设备名称] [挂载点]</span><br></pre></td></tr></table></figure>

<p>其中常用的参数有：</p>
<p>-t 指定设备的文件系统类型（什么提到的文件类型）</p>
<p>-o 指定挂载文件系统时的选项。有些也可用在&#x2F;etc&#x2F;fstab中。常用的有</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">codepage=XXX 代码页</span><br><span class="line">iocharset=XXX 字符集</span><br><span class="line">ro 以只读方式挂载</span><br><span class="line">rw 以读写方式挂载</span><br><span class="line">nouser 使一般用户无法挂载</span><br><span class="line">user 可以让一般用户挂载设备</span><br></pre></td></tr></table></figure>

<h4 id="3-7-3-挂载实例"><a href="#3-7-3-挂载实例" class="headerlink" title="3.7.3 挂载实例"></a><font size=3>3.7.3 挂载实例</font></h4><ul>
<li><strong>挂载windows的文件系统：</strong></li>
</ul>
<p>（1）首先我们使用sudo fdisk -l查看挂载的设备，例如最下面有：&#x2F;dev&#x2F;hda5</p>
<p>（2）mkdir创建一个目录，这里的目录是作为挂在目录，就是要把E盘挂到这个目录下：mkdir &#x2F;mnt&#x2F;winc</p>
<p>（3）windows和linux使用的不是一个文件系统，一般情况下linux不挂载windows文件系统，所以要手动mount：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount -t vfat /dev/hda5 /mnt/winc #  -t vfat指出这里的文件系统fat32</span><br></pre></td></tr></table></figure>

<p>现在就可以进入&#x2F;mnt&#x2F;winc等目录读写这些文件了。</p>
<ul>
<li><strong>挂载光盘</strong></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir /mnt/cdrom</span><br><span class="line">mount -t iso9660 /dev/cdrom /mnt/cdrom # (光盘的名字一般都是cdrom，这条命令一般都通用)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>虚拟机共享文件夹</strong></li>
</ul>
<p>例如在VirtualBox下，主机是Windows，Ubuntu是Guest。共分三步</p>
<p>（1)首先要安装虚拟电脑工具包：</p>
<p>在VirtualBox的菜单里选择”设备”&rarr;”安装虚拟电脑工具包”，会发现在Ubuntu桌面上多出一个光盘图标，这张光盘默认被自动加载到了文件夹&#x2F;media&#x2F;cdom0，而且&#x2F;cdrom自动指向这个文件夹。默认设置下文件管理器会自动打开这张光盘，可以看到里面有个”VBoxLinuxAdditions.run”文件。打开一个命令行终端，依次输入”cd &#x2F;cdrom”和”sudo sh .&#x2F;VBoxLinuxAdditions.run”，不含双引号，开始安装工具包。安装完毕，会用英文提示要重启Ubuntu，建议立刻重启。重启后，比较明显的变化是鼠标是共享模式，并且剪贴板也和Windows共享了。如果有这些变化，说明虚拟电脑工具包已经装成功。</p>
<p>（2）下一步设置共享文件夹。</p>
<p>在共享文件夹设置窗口中，单击右侧的”添加一个共享文件夹”，路径选择你想要共享的Windows文件夹，共享名任取一个自己喜欢的，比如”myshare”，选项read-only是指是否只允许ubuntu读这个文件夹，请根据需要选择这个选项。</p>
<p>（3）在ubuntu下挂载这个共享文件夹:sudo mount -t vboxsf myshare &#x2F;media&#x2F;share，其中”myshare”是之前取的共享文件夹的名字，”&#x2F;media&#x2F;share”是要挂载到的目标文件.</p>
<h3 id="3-8-自动挂载windows分区"><a href="#3-8-自动挂载windows分区" class="headerlink" title="3.8 自动挂载windows分区"></a><font size=3>3.8 自动挂载windows分区</font></h3><p>每次开机访问windows分区都要运行mount命令显然太烦琐，为什么访问其他的linux分区不用使用mount命令呢？</p>
<p>其实，每次开机时，linux自动将需要挂载的linux分区挂载上了。那么我们是不是可以设定让linux在启动的时候也挂载我们希望挂载的分区，如windows分区，以实现文件系统的自动挂载呢？这是完全可以的。在&#x2F;etc目录下有个fstab文件，它里面列出了linux开机时自动挂载的文件系统的列表。我的&#x2F;etc&#x2F;fstab文件如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">/dev/hda2 / ext3 defaults 1 1</span><br><span class="line">/dev/hda1 /boot ext3 defaults 1 2</span><br><span class="line">none /dev/pts devpts gid=5,mode=620 0 0</span><br><span class="line">none /proc proc defaults 0 0</span><br><span class="line">none /dev/shm tmpfs defaults 0 0</span><br><span class="line">/dev/hda3 swap swap defaults 0 0</span><br><span class="line">/dev/cdrom /mnt/cdrom iso9660 noauto,codepage=936,iocharset=gb2312 0 0</span><br><span class="line">/dev/fd0 /mnt/floppy auto noauto,owner,kudzu 0 0</span><br><span class="line">/dev/hdb1 /mnt/winc vfat defaults,codepage=936,iocharset=cp936 0 0</span><br><span class="line">/dev/hda5 /mnt/wind vfat defaults,codepage=936,iocharset=cp936 0 0</span><br></pre></td></tr></table></figure>

<p>在&#x2F;etc&#x2F;fstab文件里，第一列是挂载的文件系统的设备名，第二列是挂载点，第三列是挂载的文件系统类型，第四列是挂载的选项，选项间用逗号分隔。第五六列不知道是什么意思，还望高手指点。</p>
<p>在最后两行是手工添加的windows下的C；D盘，加了codepage&#x3D;936和iocharset&#x3D;cp936参数以支持中文文件名。参数defaults实际上包含了一组默认参数：</p>
<ul>
<li><p>rw 以可读写模式挂载</p>
</li>
<li><p>suid 开启用户ID和群组ID设置位</p>
</li>
<li><p>dev 可解读文件系统上的字符或区块设备</p>
</li>
<li><p>exec 可执行二进制文件</p>
</li>
<li><p>auto 自动挂载</p>
</li>
<li><p>nouser 使一般用户无法挂载</p>
</li>
<li><p>async 以非同步方式执行文件系统的输入输出操作</p>
</li>
</ul>
<p>大家可以看到在这个列表里，光驱和软驱是不自动挂载的，参数设置为noauto。（如果非要设成自动挂载，要确保每次开机时你的光驱和软驱里都要有盘。)</p>
<h3 id="3-9-文件的两种链接"><a href="#3-9-文件的两种链接" class="headerlink" title="3.9 文件的两种链接"></a><font size=3>3.9 文件的两种链接</font></h3><p>可以用ln命令对一个已经存在的文件再建立一个新的链接，而不复制文件的内容。连接有软链接和硬链接之分，软链接又叫符号链接。它们各自的特点是：</p>
<p><strong>硬链接：</strong>原文件名和连接文件名都指向相同的物理地址。目录不能有硬链接；硬链接不能跨越文件系统（不能跨越不同的分区）文件在磁盘中只有一个拷贝，节省硬盘空间。当修改其中一个，与其链接的文件同时被修改。如果删除其中任意一个其余的文件将不受影响。由于删除文件要在同一个索引节点属于唯一的链接时才能成功，因此可以防止不必要的误删除。</p>
<p><strong>符号链接：</strong>也叫软链接，用ln -s命令建立文件的符号链接符号连接是linux特殊文件的一种，作为一个文件，它的数据是它所连接的文件的路径名。类似windows下的快捷方式。当然删除这个链接文件，也不会影响到源文件，但对链接文件的使用、引用都是直接调用源文件的。也可以删除原有的文件而保存链接文件，但这个时候这个链接文件失效不可用，没有防止误删除功能。</p>
<p>具体关系可以看下图：</p>
<p><img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-01-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%E5%9F%BA%E7%A1%80/img/linux-system-9.jpg" alt="带你真正认识Linux 系统结构带你真正认识Linux 系统结构"></p>
<p>从图上可以看出硬链接和软链接的区别：</p>
<p>（1）硬链接原文件和新文件的inode编号一致。而软链接不一样。</p>
<p>（2）对原文件删除，会导致软链接不可用，而硬链接不受影响。</p>
<p>（3）对原文件的修改，软、硬链接文件内容也一样的修改，因为都是指向同一个文件内容的。</p>
<h3 id="3-10-文件目录管理命令"><a href="#3-10-文件目录管理命令" class="headerlink" title="3.10 文件目录管理命令"></a><font size=3>3.10 文件目录管理命令</font></h3><p>磁盘和文件空间 ：fdisk df du</p>
<p>文件目录与管理： cd pwd mkdir rmdir ls cp rm mv</p>
<p>查看文件内容 cat、tac、more、less、head 、tail</p>
<p>文件目录与权限 ：chmod chown chgrp umask</p>
<p>文件查找：which、whereis、locate、find、find</p>
<h2 id="4-linux-应用"><a href="#4-linux-应用" class="headerlink" title="4. linux 应用"></a><font size=3>4. linux 应用</font></h2><p>标准的Linux系统一般都有一套都有称为应用程序的程序集，它包括文本编辑器、编程语言、X Window、办公套件、Internet工具和数据库等。</p>
<h2 id="5-linux内核参数优化"><a href="#5-linux内核参数优化" class="headerlink" title="5. linux内核参数优化"></a><font size=3>5. linux内核参数优化</font></h2><p>内核参数是用户和系统内核之间交互的一个接口，通过这个接口，用户可以在系统运行的同时动态更新内核配置，而这些内核参数是通过Linux Proc文件系统存在的。因此，可以通过调整Proc文件系统达到优化Linux性能的目的。</p>
<h1 id="四、驱动程序分类"><a href="#四、驱动程序分类" class="headerlink" title="四、驱动程序分类"></a><font size=3>四、驱动程序分类</font></h1><p>Linux驱动分为三个基础大类：<strong>字符设备驱动，块设备驱动，网络设备驱动</strong>。</p>
<h2 id="1-三类驱动程序"><a href="#1-三类驱动程序" class="headerlink" title="1. 三类驱动程序"></a><font size=3>1. 三类驱动程序</font></h2><h3 id="1-1-字符设备"><a href="#1-1-字符设备" class="headerlink" title="1.1 字符设备"></a><font size=3>1.1 字符设备</font></h3><p>准确的说应该叫“字节设备”，指应用程序按字节&#x2F;字符来读写数据的设备。 这些设备节点通常为传真、虚拟终端和串口调制解调器、键盘之类设备提供流通信服务， 它通常不支持随机存取数据。字符设备在实现时，大多不使用缓存器。</p>
<p>系统直接从设备读取&#x2F;写入每一个字符。 例如，键盘这种设备提供的就是一个数据流，当我们敲入“cnblogs”这个字符串时， 键盘驱动程序会按照和输入完全相同的顺序返回这个由七个字符组成的数据流。它们是顺序的，先返回c，最后是s。</p>
<p>对字符设备发出读&#x2F;写请求时，实际的硬件I&#x2F;O操作一般紧接着发生。字符设备驱动程序通常至少要实现open、close、read和write系统调用。比如我们常见的lcd、触摸屏、键盘、led、串口等等，他们一般对应具体的硬件都是进行出具的采集、处理、传输。</p>
<h3 id="1-2-块设备"><a href="#1-2-块设备" class="headerlink" title="1.2 块设备"></a><font size=3>1.2 块设备</font></h3><p>块设备被应用程序操作时是以块（多个字节构成的一个单位）为单位的。通常支持随机存取和寻址，并使用缓存器。 操作系统为输入输出分配了缓存，以存储一块数据。当程序向设备发送了读取或者写入数据的请求时， 系统把数据中的每一个字符存储在适当的缓存中。当缓存被填满时，会采取适当的操作（把数据传走）， 而后系统清空缓存。</p>
<p>它与字符设备不同之处就是，是否支持随机存储。字符型是流形式，逐一存储。 典型的块设备有硬盘、SD卡、闪存等，应用程序可以寻址磁盘上的任何位置，并由此读取数据。 此外，数据的读写只能以块的倍数进行。</p>
<blockquote>
<p>设备的块大小是设备本身设计时定义好的，软件是不能去更改的，不同设备的块大小可以不一样。</p>
</blockquote>
<h3 id="1-3-网络设备"><a href="#1-3-网络设备" class="headerlink" title="1.3 网络设备"></a><font size=3>1.3 网络设备</font></h3><p>一种特殊设备，它并不存在于&#x2F;dev下面，主要用于网络数据的收发。任何网络事务都经过一个网络接口形成，即一个能够和其他主机交换数据的设备。</p>
<p>访问网络接口的方法仍然是给它们分配一个唯一的名字（比如eth0），但这个名字在文件系统中不存在对应的节点。</p>
<p>内核和网络设备驱动程序间的通信，完全不同于内核和字符以及块驱动程序之间的通信，内核调用一套和数据包传输相关的函（socket函数）而不是read、write等。</p>
<p>哪些是网络设备？比如我们常见的网卡设备、蓝牙设备。</p>
<h2 id="2-三个对象"><a href="#2-三个对象" class="headerlink" title="2. 三个对象"></a><font size=3>2. 三个对象</font></h2><p>Linux内核中处处体现面向对象的设计思想，为了统一形形色色的设备，Linux系统将设备分别抽象为struct cdev, struct block_device, struct net_devce 三个对象，具体的设备都可以包含着三种对象从而继承和三种对象属性和操作， 并通过各自的对象添加到相应的驱动模型中，从而进行统一的管理和操作。</p>
<p>后续我们再详细的去学习这三类驱动程序。</p>
<blockquote>
<p>参考资料</p>
<p><a target="_blank" rel="noopener" href="https://www.linuxprobe.com/linux-system-structure.html">带你真正认识Linux 系统结构 | 《Linux就该这么学》 (linuxprobe.com)</a></p>
<p><a target="_blank" rel="noopener" href="http://www.wowotech.net/linux_kenrel/11.html">Linux内核的整体架构</a></p>
</blockquote>

    </div>

    
    
    

    <footer class="post-footer">




    <div>
        
            <div style="text-align:center;color: #ccc;font-size:14px;">
            ----------本文结束
            <i class="fas fa-fan fa-spin" style="color: #FF1493; font-size: 1rem"></i>
            感谢您的阅读----------
            </div>
        
    </div>





  
  <div class="my_post_copyright"> 
    <p><span>文章标题:</span><a href="/post/333e1a11.html">LV06-01-驱动程序-01-驱动程序基础</a></p>
    <p><span>文章作者:</span><a href="/" title="欢迎访问 《苏木》 的学习笔记">苏木</a></p>
    <p><span>发布时间:</span>2024年11月16日 - 20:07</p>
    <p><span>最后更新:</span>2025年06月14日 - 00:25</p>
    <p><span>原始链接:</span><a href="/post/333e1a11.html" title="LV06-01-驱动程序-01-驱动程序基础">https://sumumm.github.io/post/333e1a11.html</a></p>
    <p><span>许可协议:</span><i class="fab fa-creative-commons"></i> <a rel="license" href= "https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">署名-非商业性使用-禁止演绎 4.0 国际</a> 转载请保留原文链接及作者。</p>  
  </div>
  


          <div class="post-tags">
              <a href="/tags/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/" rel="tag"><i class="fa fa-tag"></i> LV06-驱动开发</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/post/33b7631f.html" rel="prev" title="LV06-01-驱动程序-02-驱动开发环境搭建">
                  <i class="fa fa-angle-left"></i> LV06-01-驱动程序-02-驱动开发环境搭建
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/post/efc7a624.html" rel="next" title="LV04-02-GPIO-05-根据dis文件分析代码运行">
                  LV04-02-GPIO-05-根据dis文件分析代码运行 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2017 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">苏木</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>站点总字数：</span>
    <span title="站点总字数">3.7m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">225:26</span>
  </span>
</div>




    <span id="sitetime"></span>
    <script defer language=javascript>
        function siteTime()
        {
            window.setTimeout("siteTime()", 1000);
            var seconds = 1000;
            var minutes = seconds * 60;
            var hours = minutes * 60;
            var days = hours * 24;
            var years = days * 365;
            var today = new Date();
            var todayYear = today.getFullYear();
            var todayMonth = today.getMonth()+1;
            var todayDate = today.getDate();
            var todayHour = today.getHours();
            var todayMinute = today.getMinutes();
            var todaySecond = today.getSeconds();
            /*==================================================
            Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)
            year        - 作为date对象的年份，为4位年份值
            month       - 0-11之间的整数，做为date对象的月份
            day         - 1-31之间的整数，做为date对象的天数
            hours       - 0(午夜24点)-23之间的整数，做为date对象的小时数
            minutes     - 0-59之间的整数，做为date对象的分钟数
            seconds     - 0-59之间的整数，做为date对象的秒数
            microseconds - 0-999之间的整数，做为date对象的毫秒数
            ==================================================*/
            var t1 = Date.UTC(2017, 
                              5, 
                              19, 
                              0, 
                              0, 
                              0); //北京时间
            var t2 = Date.UTC(todayYear,todayMonth,todayDate,todayHour,todayMinute,todaySecond);
            var diff = t2-t1;
            var diffYears = Math.floor(diff/years);
            var diffDays = Math.floor((diff/days)-diffYears*365);
            var diffHours = Math.floor((diff-(diffYears*365+diffDays)*days)/hours);
            var diffMinutes = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours)/minutes);
            var diffSeconds = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours-diffMinutes*minutes)/seconds);
            document.getElementById("sitetime").innerHTML="已在这里 "+diffYears+" 年 "+diffDays+" 天 "+diffHours+" 小时 "+diffMinutes+" 分钟 "+diffSeconds+" 秒";
        }
        siteTime();
    </script>



    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.28/fancybox/fancybox.umd.js" integrity="sha256-ytMJGN3toR+a84u7g7NuHm91VIR06Q41kMWDr2pq7Zo=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/fancybox.js"></script>

  <script src="/js/third-party/pace.js"></script>


  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


 
        <div id="click-show-text"
            data-mobile = false
            data-text = 富强,民主,文明,和谐,自由,平等,公正,法制,爱国,敬业,诚信,友善
            data-fontsize = 15px
            data-random= false>
        </div>
       

      
        <script async src=https://cdn.jsdelivr.net/npm/hexo-next-mouse-effect@latest/click/showText.js></script>
      

      
    




    <script async src="/js/fancybox_param.js"></script>





<!-- APlayer本体 -->



</body>
</html>
