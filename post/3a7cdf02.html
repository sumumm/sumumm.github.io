<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha256-wiz7ZSCn/btzhjKDQBms9Hx4sSeUYsDrTLg7roPstac=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.28/fancybox/fancybox.css" integrity="sha256-6cQIC71/iBIYXFK+0RHAvwmjwWzkWd+r7v/BX3/vZDc=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/green/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"sumumm.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.19.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"fold":{"enable":true,"height":300},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":true,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="æ€ä¹ˆå†™ä¸€ä¸ªè®¾å¤‡æ ‘æ–‡ä»¶ï¼Œæ€ä¹ˆä¿®æ”¹ï¼Ÿè‹¥ç¬”è®°ä¸­æœ‰é”™è¯¯æˆ–è€…ä¸åˆé€‚çš„åœ°æ–¹ï¼Œæ¬¢è¿æ‰¹è¯„æŒ‡æ­£ğŸ˜ƒã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="LV06-10-è®¾å¤‡æ ‘-02-è®¾å¤‡æ ‘è¯­æ³•">
<meta property="og:url" content="https://sumumm.github.io/post/3a7cdf02.html">
<meta property="og:site_name" content="è‹æœ¨">
<meta property="og:description" content="æ€ä¹ˆå†™ä¸€ä¸ªè®¾å¤‡æ ‘æ–‡ä»¶ï¼Œæ€ä¹ˆä¿®æ”¹ï¼Ÿè‹¥ç¬”è®°ä¸­æœ‰é”™è¯¯æˆ–è€…ä¸åˆé€‚çš„åœ°æ–¹ï¼Œæ¬¢è¿æ‰¹è¯„æŒ‡æ­£ğŸ˜ƒã€‚">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250218090419908.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250218185719092.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250309151938826.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250309152429056.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250309152522796.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250218191119287.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250220091647571.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250220092740884.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250220093228164.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250220163438114.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250220092740884.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250221093009766.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250221093125213.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250221093144491.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250221092855296.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250221093541551.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250221093551160.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250221095145496.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250221095201552.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250221100143833.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250221100203516.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250221100310837.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250221100328129.png">
<meta property="og:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250221100415836.png">
<meta property="article:published_time" content="2025-03-16T23:45:51.000Z">
<meta property="article:modified_time" content="2025-06-13T16:25:57.054Z">
<meta property="article:author" content="è‹æœ¨">
<meta property="article:tag" content="LV06-é©±åŠ¨å¼€å‘">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250218090419908.png">


<link rel="canonical" href="https://sumumm.github.io/post/3a7cdf02.html">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":"","permalink":"https://sumumm.github.io/post/3a7cdf02.html","path":"post/3a7cdf02.html","title":"LV06-10-è®¾å¤‡æ ‘-02-è®¾å¤‡æ ‘è¯­æ³•"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>LV06-10-è®¾å¤‡æ ‘-02-è®¾å¤‡æ ‘è¯­æ³• | è‹æœ¨</title>
  








    <script src="/js/browser_tools_disable.js"></script>

  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<!-- hexo injector head_end start --><link rel="stylesheet" href="https://unpkg.com/hexo-next-tags-plus@latest/lib/tag_plus.css" media="defer" onload="this.media='all'"><!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ " role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">è‹æœ¨</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">æˆ‘çš„å­¦ä¹ ä¹‹è·¯</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="æœç´¢" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>è‹æœ¨çš„å®¶</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»é¡µ<span class="badge">42</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£é¡µ<span class="badge">673</span></a></li><li class="menu-item menu-item-flink"><a href="/flink/" rel="section"><i class="fa fa-link fa-fw"></i>å‹äººå¸</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äºæˆ‘</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95"><span class="nav-text">ä¸€ã€åŸºæœ¬è¯­æ³•</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-DTS-%E6%96%87%E4%BB%B6%E7%9A%84%E6%A0%BC%E5%BC%8F"><span class="nav-text">1.Â DTS æ–‡ä»¶çš„æ ¼å¼   </span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-%E6%A0%B9%E8%8A%82%E7%82%B9"><span class="nav-text">1.1 æ ¹èŠ‚ç‚¹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-%E5%AD%90%E8%8A%82%E7%82%B9"><span class="nav-text">1.2Â å­èŠ‚ç‚¹  </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%A4%BA%E4%BE%8B"><span class="nav-text">1.3 ä¸€ä¸ªç®€å•ç¤ºä¾‹</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E8%8A%82%E7%82%B9%E5%B1%9E%E6%80%A7"><span class="nav-text">2. èŠ‚ç‚¹å±æ€§</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-%E5%B1%9E%E6%80%A7%E6%A0%BC%E5%BC%8F"><span class="nav-text">2.1 å±æ€§æ ¼å¼</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-1-Property-%E6%A0%BC%E5%BC%8F-1"><span class="nav-text">2.1.1Â Property æ ¼å¼ 1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-2-Property-%E6%A0%BC%E5%BC%8F-2-%E6%B2%A1%E6%9C%89%E5%80%BC"><span class="nav-text">2.1.2Â Property æ ¼å¼ 2(æ²¡æœ‰å€¼)</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-%E5%B8%B8%E7%94%A8%E5%B1%9E%E6%80%A7"><span class="nav-text">2.2 å¸¸ç”¨å±æ€§</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-1-compatible"><span class="nav-text">2.2.1Â compatible  </span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-2-mode"><span class="nav-text">2.2.2 mode</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-3-status"><span class="nav-text">2.2.3Â status  </span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-4-reg"><span class="nav-text">2.2.4Â reg  </span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-5-address-cells-%E5%92%8C-size-cells"><span class="nav-text">2.2.5Â address-cells å’Œ size-cells </span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-6-ranges"><span class="nav-text">2.2.6Â ranges  </span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-7-name"><span class="nav-text">2.2.7 name</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-8-device-type"><span class="nav-text">2.2.8Â device_type</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-9-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B1%9E%E6%80%A7"><span class="nav-text">2.2.9 è‡ªå®šä¹‰å±æ€§</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-%E4%BF%AE%E6%94%B9%E8%8A%82%E7%82%B9"><span class="nav-text">2.3 ä¿®æ”¹èŠ‚ç‚¹</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-1-%E4%BF%AE%E6%94%B9%E6%96%B9%E5%BC%8F"><span class="nav-text">2.3.1 ä¿®æ”¹æ–¹å¼</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-2-%E4%BF%AE%E6%94%B9%E5%AE%9E%E4%BE%8B"><span class="nav-text">2.3.2 ä¿®æ”¹å®ä¾‹</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E7%89%B9%E6%AE%8A%E8%8A%82%E7%82%B9"><span class="nav-text">3. ç‰¹æ®ŠèŠ‚ç‚¹</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-%E6%A0%B9%E8%8A%82%E7%82%B9"><span class="nav-text">3.1 æ ¹èŠ‚ç‚¹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-CPU-%E8%8A%82%E7%82%B9"><span class="nav-text">3.2Â CPU èŠ‚ç‚¹  </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-memory-%E8%8A%82%E7%82%B9"><span class="nav-text">3.3Â memory èŠ‚ç‚¹  </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-chosen-%E8%8A%82%E7%82%B9"><span class="nav-text">3.4Â chosen èŠ‚ç‚¹  </span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-4-1-%E8%8A%82%E7%82%B9%E8%AF%B4%E6%98%8E"><span class="nav-text">3.4.1 èŠ‚ç‚¹è¯´æ˜</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-4-2-%E8%8A%82%E7%82%B9%E7%A4%BA%E4%BE%8B"><span class="nav-text">3.4.2 èŠ‚ç‚¹ç¤ºä¾‹</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-4-3-%E5%8F%82%E6%95%B0%E7%9A%84%E4%BC%A0%E9%80%92"><span class="nav-text">3.4.3 å‚æ•°çš„ä¼ é€’</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-5-aliases-%E8%8A%82%E7%82%B9"><span class="nav-text">3.5Â aliases èŠ‚ç‚¹</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E5%AE%9E%E4%BE%8B%E5%88%86%E6%9E%90"><span class="nav-text">äºŒã€å®ä¾‹åˆ†æ</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E4%B8%AD%E6%96%AD"><span class="nav-text">1. ä¸­æ–­</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-%E4%B8%AD%E6%96%AD%E7%9B%B8%E5%85%B3%E5%B1%9E%E6%80%A7"><span class="nav-text">1.1 ä¸­æ–­ç›¸å…³å±æ€§</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-1-interrupts"><span class="nav-text">1.1.1Â interrupts  </span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-2-interrupt-controller"><span class="nav-text">1.1.2Â interrupt-controller  </span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-3-interrupt-parent"><span class="nav-text">1.1.3Â interrupt-parent  </span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-4-interrupt-cells"><span class="nav-text">1.1.4Â #interrupt-cells  </span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-%E4%B8%AD%E6%96%AD%E5%AE%9E%E4%BE%8B"><span class="nav-text">1.2 ä¸­æ–­å®ä¾‹</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-1-%E7%A1%AC%E4%BB%B6%E5%8E%9F%E7%90%86%E5%9B%BE"><span class="nav-text">1.2.1 ç¡¬ä»¶åŸç†å›¾</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-2-%E4%B8%AD%E6%96%AD%E5%8F%B7%E6%80%8E%E4%B9%88%E7%A1%AE%E5%AE%9A%EF%BC%9F"><span class="nav-text">1.2.2 ä¸­æ–­å·æ€ä¹ˆç¡®å®šï¼Ÿ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-3-%E8%A7%A6%E5%8F%91%E6%96%B9%E5%BC%8F%E9%80%89%E6%8B%A9"><span class="nav-text">1.2.3 è§¦å‘æ–¹å¼é€‰æ‹©</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-4-%E6%8C%89%E9%94%AE%E4%B8%AD%E6%96%AD%E8%8A%82%E7%82%B9"><span class="nav-text">1.2.4 æŒ‰é”®ä¸­æ–­èŠ‚ç‚¹</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E6%97%B6%E9%92%9F"><span class="nav-text">2. æ—¶é’Ÿ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-%E6%97%B6%E9%92%9F%E7%94%9F%E4%BA%A7%E8%80%85%EF%BC%88clock-provider%EF%BC%89"><span class="nav-text">2.1Â æ—¶é’Ÿç”Ÿäº§è€…ï¼ˆclock providerï¼‰</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-%E6%97%B6%E9%92%9F%E6%B6%88%E8%B4%B9%E8%80%85%EF%BC%88clock-consumer%EF%BC%89"><span class="nav-text">2.2Â æ—¶é’Ÿæ¶ˆè´¹è€…ï¼ˆclock consumerï¼‰</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-CPU"><span class="nav-text">3. CPU</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-cpus-%E8%8A%82%E7%82%B9"><span class="nav-text">3.1Â cpus èŠ‚ç‚¹  </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-cpu-map%E3%80%81-socket%E3%80%81-cluster-%E8%8A%82%E7%82%B9"><span class="nav-text">3.2Â cpu-mapã€ socketã€ cluster èŠ‚ç‚¹  </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-core%E3%80%81-thread-%E8%8A%82%E7%82%B9"><span class="nav-text">3.3Â coreã€ thread èŠ‚ç‚¹  </span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-GPIO"><span class="nav-text">4. GPIO</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-gpio%E7%9B%B8%E5%85%B3%E5%B1%9E%E6%80%A7"><span class="nav-text">4.1 gpioç›¸å…³å±æ€§</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-1-gpio-controller"><span class="nav-text">4.1.1Â gpio-controller</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-2-gpio-cells"><span class="nav-text">4.1.2Â #gpio-cells  </span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-3-gpio-ranges"><span class="nav-text">4.1.3Â gpio-ranges</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-4-gpio-%E5%BC%95%E8%84%9A%E6%8F%8F%E8%BF%B0%E5%B1%9E%E6%80%A7"><span class="nav-text">4.1.4Â gpio å¼•è„šæè¿°å±æ€§  </span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-5-%E5%85%B6%E4%BB%96%E5%B1%9E%E6%80%A7"><span class="nav-text">4.1.5Â å…¶ä»–å±æ€§  </span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-GPIO%E5%AE%9E%E4%BE%8B"><span class="nav-text">4.2 GPIOå®ä¾‹</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-2-1-%E7%A1%AC%E4%BB%B6%E5%8E%9F%E7%90%86%E5%9B%BE"><span class="nav-text">4.2.1 ç¡¬ä»¶åŸç†å›¾</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-2-2-led%E7%81%AF%E8%8A%82%E7%82%B9"><span class="nav-text">4.2.2 ledç¯èŠ‚ç‚¹</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-pinctrl"><span class="nav-text">5.Â pinctrl  </span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-pinmux-%E7%AE%80%E4%BB%8B"><span class="nav-text">5.1Â pinmux ç®€ä»‹Â Â </span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-1-1-%E4%BB%80%E4%B9%88%E6%98%AFpinmux"><span class="nav-text">5.1.1 ä»€ä¹ˆæ˜¯pinmux</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-1-2-imx6ull%E7%9A%84%E5%BC%95%E8%84%9A%E5%A4%8D%E7%94%A8"><span class="nav-text">5.1.2 imx6ullçš„å¼•è„šå¤ç”¨</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-1-3-RK3568%E7%9A%84%E5%BC%95%E8%84%9A%E5%A4%8D%E7%94%A8"><span class="nav-text">5.1.3 RK3568çš„å¼•è„šå¤ç”¨</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-1-4-%E6%80%BB%E7%BB%93"><span class="nav-text">5.1.4 æ€»ç»“</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-RK3568%E4%B8%AD%E4%BD%BF%E7%94%A8-pinctrl-%E8%AE%BE%E7%BD%AE%E5%A4%8D%E7%94%A8%E5%85%B3%E7%B3%BB"><span class="nav-text">5.2 RK3568ä¸­ä½¿ç”¨ pinctrl è®¾ç½®å¤ç”¨å…³ç³»  </span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-1-%E5%AE%A2%E6%88%B7%E7%AB%AF%EF%BC%88client%EF%BC%89"><span class="nav-text">5.2.1 å®¢æˆ·ç«¯ï¼ˆclientï¼‰</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-2-%E6%9C%8D%E5%8A%A1%E7%AB%AF%EF%BC%88server%EF%BC%89"><span class="nav-text">5.2.2 æœåŠ¡ç«¯ï¼ˆserverï¼‰</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-RK3568%E5%BC%80%E5%8F%91%E6%9D%BF%E7%9A%84%E4%B8%80%E4%B8%AA%E5%AE%9E%E4%BE%8B"><span class="nav-text">5.3 RK3568å¼€å‘æ¿çš„ä¸€ä¸ªå®ä¾‹</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="è‹æœ¨"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">è‹æœ¨</p>
  <div class="site-description" itemprop="description">è«é“æ¡‘æ¦†æ™šï¼Œä¸ºéœå°šæ»¡å¤©</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">673</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">42</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">43</span>
        <span class="site-state-item-name">æ ‡ç­¾</span>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/sumumm" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;sumumm" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://sumumm.github.io/post/3a7cdf02.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="è‹æœ¨">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è‹æœ¨">
      <meta itemprop="description" content="è«é“æ¡‘æ¦†æ™šï¼Œä¸ºéœå°šæ»¡å¤©">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="LV06-10-è®¾å¤‡æ ‘-02-è®¾å¤‡æ ‘è¯­æ³• | è‹æœ¨">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          LV06-10-è®¾å¤‡æ ‘-02-è®¾å¤‡æ ‘è¯­æ³•
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2025-03-17 07:45:51" itemprop="dateCreated datePublished" datetime="2025-03-17T07:45:51+08:00">2025-03-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">åµŒå…¥å¼å¼€å‘</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/" itemprop="url" rel="index"><span itemprop="name">02IMX6ULLå¹³å°</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">LV06-é©±åŠ¨å¼€å‘</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>21k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>1:18</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>æ€ä¹ˆå†™ä¸€ä¸ªè®¾å¤‡æ ‘æ–‡ä»¶ï¼Œæ€ä¹ˆä¿®æ”¹ï¼Ÿè‹¥ç¬”è®°ä¸­æœ‰é”™è¯¯æˆ–è€…ä¸åˆé€‚çš„åœ°æ–¹ï¼Œæ¬¢è¿æ‰¹è¯„æŒ‡æ­£ğŸ˜ƒã€‚</p>
<span id="more"></span>

<!-- Photo: https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/ -->

<details class="folding-tag" blue><summary> ç‚¹å‡»æŸ¥çœ‹ä½¿ç”¨å·¥å…·åŠç‰ˆæœ¬ </summary>
              <div class='content'>
              <table>    <tr>        <td align="center" rowspan="5">PCç«¯å¼€å‘ç¯å¢ƒ</td>        <td align="center" width=150px>Windows</td>        <td align="left">Windows11</td>    </tr>    <tr>        <td align="center">Ubuntu</td>        <td align="left">Ubuntu20.04.2çš„64ä½ç‰ˆæœ¬</td>      </tr>    <tr>        <td align="center">VMwareÂ® Workstation 17 Pro</td>        <td align="left">17.6.0 build-24238078</td>      </tr>    <tr>        <td align="center">ç»ˆç«¯è½¯ä»¶</td>        <td align="left">MobaXterm(Professional Edition v23.0 Build 5042 (license))</td>    </tr>    <tr>        <td align="center">Win32DiskImager</td>        <td align="left">Win32DiskImager v1.0</td>      </tr>    <tr>        <td align="center" rowspan="3">Linuxå¼€å‘æ¿ç¯å¢ƒ</td>        <td align="center">Linuxå¼€å‘æ¿</td>        <td align="left">æ­£ç‚¹åŸå­ i.MX6ULL Linux é˜¿å°”æ³•å¼€å‘æ¿</td>      </tr>    <tr>        <td align="center">uboot</td>        <td align="left">NXPå®˜æ–¹æä¾›çš„ubootï¼Œä½¿ç”¨çš„ubootç‰ˆæœ¬ä¸ºU-Boot 2019.04</td>      </tr>    <tr>        <td align="center">linuxå†…æ ¸</td>        <td align="left">linux-4.19.71(NXPå®˜æ–¹æä¾›)</td>      </tr></table>
              </div>
            </details>

<details class="folding-tag" blue><summary> ç‚¹å‡»æŸ¥çœ‹æœ¬æ–‡å‚è€ƒèµ„æ–™ </summary>
              <div class='content'>
              <table>    <tr>        <td align="center">åˆ†ç±»</td>        <td align="center">ç½‘å€</td>        <td align="center">è¯´æ˜</td>    </tr>    <tr>        <td align="center" rowspan="5">å®˜æ–¹ç½‘ç«™</td>        <td align="left"><a href="https://www.arm.com/" target="_blank">https://www.arm.com/</a></td>        <td align="left">ARMå®˜æ–¹ç½‘ç«™ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°Cotex-Mxä»¥åŠARMVxçš„ä¸€äº›æ–‡æ¡£</td>    </tr>    <tr>        <td align="left"><a href="https://www.nxp.com.cn/" target="_blank">https://www.nxp.com.cn/ </a></td>        <td align="left">NXPå®˜æ–¹ç½‘ç«™</td>    </tr>    <tr>        <td align="left"><a href="https://www.nxpic.org.cn/" target="_blank">https://www.nxpic.org.cn/</a></td><td align="left">NXP å®˜æ–¹ç¤¾åŒº</td>    </tr>    <tr>        <td align="left"><a href="https://u-boot.readthedocs.io/en/latest/" target="_blank">https://u-boot.readthedocs.io/en/latest/</a></td><td align="left">u-bootå®˜ç½‘</td>    </tr>    <tr>        <td align="left"><a href="https://www.kernel.org/" target="_blank">https://www.kernel.org/</a></td><td align="left">linuxå†…æ ¸å®˜ç½‘</td>    </tr></table>
              </div>
            </details>

<details class="folding-tag" blue><summary> ç‚¹å‡»æŸ¥çœ‹ç›¸å…³æ–‡ä»¶ä¸‹è½½ </summary>
              <div class='content'>
              <table>    <tr>        <td align="center">åˆ†ç±»</td>        <td align="center">ç½‘å€</td>        <td align="center">è¯´æ˜</td>    </tr>    <tr>        <td align="center" rowspan="3">NXP</td>        <td align="left"><a href="https://github.com/nxp-imx" target="_blank">https://github.com/nxp-imx</a></td>        <td align="left">NXP imxå¼€å‘èµ„æºGitHubç»„ç»‡ï¼Œé‡Œè¾¹ä¼šæœ‰u-bootå’Œlinuxå†…æ ¸çš„ä»“åº“</td>    </tr>    <tr>        <td align="left"><a href="https://github.com/nxp-imx/linux-imx/releases/tag/v4.19.71" target="_blank">nxp-imx/linux-imx/releases/tag/v4.19.71</a></td>        <td align="left">NXP linuxå†…æ ¸ä»“åº“tagsä¸­çš„v4.19.71</td>    </tr>    <tr>        <td align="left"><a href="https://github.com/nxp-imx/uboot-imx/releases/tag/rel_imx_4.19.35_1.1.0" target="_blank">nxp-imx/uboot-imx/releases/tag/rel_imx_4.19.35_1.1.0</a></td>        <td align="left">NXP u-bootä»“åº“tagsä¸­çš„rel_imx_4.19.35_1.1.0</td>    </tr>    <tr>        <td align="center" rowspan="2">I.MX6ULL</td>        <td align="left"><a href="https://www.nxp.com.cn/docs/en/data-sheet/IMX6ULLIEC.pdf" target="_blank">i.MX 6ULL Applications Processors for Industrial Products</a></td>        <td align="left">I.MX6ULL èŠ¯ç‰‡æ‰‹å†Œï¼ˆdatasheetï¼Œå¯ä»¥åœ¨çº¿æŸ¥çœ‹ï¼‰</td>    </tr>    <tr>        <td align="left"><a href="https://www.nxp.com.cn/webapp/Download?colCode=IMX6ULLRM&lang_cd=zh" target="_blank">i.MX 6ULL Applications ProcessorReference Manual</a></td>        <td align="left">I.MX6ULL å‚è€ƒæ‰‹å†Œï¼ˆä¸‹è½½åæ‰èƒ½æŸ¥çœ‹ï¼Œéœ€è¦ç™»å½•NXPå®˜ç½‘ï¼‰</td>    </tr>    <tr>        <td align="center" rowspan="3">Source Code</td>        <td align="left"><a href="https://elixir.bootlin.com/linux/latest/source" target="_blank">https://elixir.bootlin.com/linux/latest/source</a></td>        <td align="left">linux kernelæºç </td>    </tr>    <tr>        <td align="left"><a href="https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tree/?h=v4.19.71&id=e7d2672c66e4d3675570369bf20856296da312c4" target="_blank">kernel/git/stable/linux.git - Linux kernel stable tree</a></td>        <td align="left">linux kernelæºç (å®˜ç½‘,tag 4.19.71)</td>    </tr>    <tr>        <td align="left"><a href="https://elixir.bootlin.com/u-boot/latest/source" target="_blank">https://elixir.bootlin.com/u-boot/latest/source</a></td>        <td align="left">ubootæºç </td>    </tr></table>
              </div>
            </details>

<h1 id="ä¸€ã€åŸºæœ¬è¯­æ³•"><a href="#ä¸€ã€åŸºæœ¬è¯­æ³•" class="headerlink" title="ä¸€ã€åŸºæœ¬è¯­æ³•"></a><font size=3>ä¸€ã€åŸºæœ¬è¯­æ³•</font></h1><h2 id="1-DTS-æ–‡ä»¶çš„æ ¼å¼"><a href="#1-DTS-æ–‡ä»¶çš„æ ¼å¼" class="headerlink" title="1.Â DTS æ–‡ä»¶çš„æ ¼å¼   "></a><font size=3>1.Â DTS æ–‡ä»¶çš„æ ¼å¼   </font></h2><h3 id="1-1-æ ¹èŠ‚ç‚¹"><a href="#1-1-æ ¹èŠ‚ç‚¹" class="headerlink" title="1.1 æ ¹èŠ‚ç‚¹"></a><font size=3>1.1 æ ¹èŠ‚ç‚¹</font></h3><p>è®¾å¤‡æ ‘ä½¿ç”¨ä¸€ç§å±‚æ¬¡ç»“æ„ï¼Œ å…¶ä¸­çš„æ ¹èŠ‚ç‚¹ï¼ˆRoot Nodeï¼‰ æ˜¯æ•´ä¸ªè®¾å¤‡æ ‘çš„èµ·å§‹ç‚¹å’Œé¡¶å±‚èŠ‚ç‚¹ã€‚ æ ¹èŠ‚ç‚¹ç”±ä¸€ä¸ªä»¥ &#x2F;å¼€å¤´çš„æ ‡è¯†ç¬¦æ¥è¡¨ç¤ºï¼Œ ç„¶åä½¿ç”¨{}æ¥åŒ…å«æ ¹èŠ‚ç‚¹æ‰€åœ¨çš„å†…å®¹  ï¼ŒDTS æ–‡ä»¶å¸ƒå±€(layout):  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/dts-v1/; <span class="comment">// è®¾å¤‡æ ‘ç‰ˆæœ¬ä¿¡æ¯</span></span><br><span class="line">[memory reservations] <span class="comment">// æ ¼å¼ä¸º: /memreserve/ &lt;address&gt; &lt;length&gt;;</span></span><br><span class="line">/ &#123;</span><br><span class="line">    [property definitions]</span><br><span class="line">    [child nodes]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ç¬¬ä¸€è¡Œçš„è®¾å¤‡æ ‘ä¸­çš„ç‰ˆæœ¬ä¿¡æ¯è¡Œ dts-v1 æ˜¯å¯é€‰çš„ï¼Œ å¯ä»¥æ ¹æ®éœ€è¦é€‰æ‹©æ˜¯å¦ä¿ç•™ã€‚ è¿™è¡Œæ³¨é‡Šé€šå¸¸ç”¨äºæŒ‡å®šè®¾å¤‡æ ‘çš„è¯­æ³•ç‰ˆæœ¬ã€‚ å¦‚æœä¸éœ€è¦åœ¨è®¾å¤‡æ ‘ä¸­æŒ‡å®šç‰ˆæœ¬ä¿¡æ¯ï¼Œ å¯ä»¥å°†å…¶åˆ é™¤ã€‚  </p>
<h3 id="1-2-å­èŠ‚ç‚¹"><a href="#1-2-å­èŠ‚ç‚¹" class="headerlink" title="1.2Â å­èŠ‚ç‚¹  "></a><font size=3>1.2Â å­èŠ‚ç‚¹  </font></h3><p>è®¾å¤‡æ ‘ä¸­çš„å­èŠ‚ç‚¹æ˜¯æ ¹èŠ‚ç‚¹çš„ç›´æ¥å­é¡¹ï¼Œ ç”¨äºæè¿°å…·ä½“çš„ç¡¬ä»¶è®¾å¤‡æˆ–è®¾å¤‡é›†åˆã€‚ å­èŠ‚ç‚¹é‡‡ç”¨ä»¥ä¸‹ç‰¹å®šçš„æ ¼å¼æ¥è¡¨ç¤º ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[label:] node-name@[unit-address] &#123;</span><br><span class="line">    [properties definitions]</span><br><span class="line">    [child nodes]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ1ï¼‰ èŠ‚ç‚¹æ ‡ç­¾ï¼ˆLabelï¼‰ ï¼ˆå¯é€‰ï¼‰ ï¼š èŠ‚ç‚¹æ ‡ç­¾æ˜¯ä¸€ä¸ªå¯é€‰çš„æ ‡è¯†ç¬¦ï¼Œ ç”¨äºåœ¨è®¾å¤‡æ ‘ä¸­å¼•ç”¨è¯¥èŠ‚ç‚¹ã€‚ æ ‡ç­¾å…è®¸å…¶ä»–èŠ‚ç‚¹ç›´æ¥å¼•ç”¨æ­¤èŠ‚ç‚¹ï¼Œ ä»¥ä¾¿åœ¨è®¾å¤‡æ ‘ä¸­å»ºç«‹å¼•ç”¨å…³ç³»ã€‚  </p>
<p>ï¼ˆ2ï¼‰ èŠ‚ç‚¹åç§°ï¼ˆNode Nameï¼‰ ï¼š èŠ‚ç‚¹åç§°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œ ç”¨äºå”¯ä¸€æ ‡è¯†è¯¥èŠ‚ç‚¹åœ¨è®¾å¤‡æ ‘ä¸­çš„ä½ç½®ã€‚ èŠ‚ç‚¹åç§°é€šå¸¸æ˜¯ç¡¬ä»¶è®¾å¤‡çš„åç§°ï¼Œ ä½†å¿…é¡»åœ¨è®¾å¤‡æ ‘ä¸­æ˜¯å”¯ä¸€çš„ã€‚  </p>
<p>ï¼ˆ 3ï¼‰ å•å…ƒåœ°å€ï¼ˆUnit Addressï¼‰ ï¼ˆ å¯é€‰ï¼‰ ï¼š å•å…ƒåœ°å€ç”¨äºæ ‡è¯†è®¾å¤‡çš„å®ä¾‹ã€‚ å®ƒå¯ä»¥æ˜¯ä¸€ä¸ªæ•´æ•°ã€ ä¸€ä¸ªåå…­è¿›åˆ¶å€¼æˆ–ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œ å…·ä½“å–å†³äºè®¾å¤‡çš„è¦æ±‚ã€‚ å•å…ƒåœ°å€çš„ç›®çš„æ˜¯åŒºåˆ†ç›¸åŒç±»å‹çš„è®¾å¤‡çš„ä¸åŒå®ä¾‹ï¼Œ ä¾‹å¦‚åœ¨ä¸‹å›¾ä¸­åä¸º cpu çš„èŠ‚ç‚¹é€šè¿‡å®ƒä»¬çš„å•å…ƒåœ°å€å€¼ 0 å’Œ 1 æ¥åŒºåˆ†ï¼Œ åç§°ä¸º ethernet çš„èŠ‚ç‚¹é€šè¿‡å…¶å•å…ƒåœ°å€å€¼ fe002000 å’Œ fe003000 æ¥åŒºåˆ†ã€‚  </p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250218090419908.png" alt="image-20250218090419908" style="zoom:50%;" />

<p>ï¼ˆ 4ï¼‰ å±æ€§å®šä¹‰ï¼ˆ Properties Definitionsï¼‰ ï¼š å±æ€§å®šä¹‰æ˜¯ä¸€ç»„é”®å€¼å¯¹ï¼Œ ç”¨äºæè¿°è®¾å¤‡çš„é…ç½®å’Œç‰¹æ€§ã€‚ å±æ€§å¯ä»¥æ ¹æ®è®¾å¤‡çš„éœ€æ±‚è¿›è¡Œå®šä¹‰ï¼Œ ä¾‹å¦‚å¯„å­˜å™¨åœ°å€ã€ ä¸­æ–­å·ã€ æ—¶é’Ÿé¢‘ç‡ç­‰ï¼Œ å…³äºè¿™äº›å±æ€§ä¼šåœ¨åé¢çš„å°èŠ‚ä¸­å­¦ä¹ ã€‚</p>
<p>ï¼ˆ 5ï¼‰ å­èŠ‚ç‚¹ï¼ˆ Child Nodesï¼‰ ï¼š å­èŠ‚ç‚¹æ˜¯å½“å‰èŠ‚ç‚¹çš„å­é¡¹ï¼Œ ç”¨äºè¿›ä¸€æ­¥æè¿°ç¡¬ä»¶è®¾å¤‡çš„å­ç»„ä»¶æˆ–é…ç½®ã€‚ å­èŠ‚ç‚¹å¯ä»¥åŒ…å«è‡ªå·±çš„å±æ€§å®šä¹‰å’Œæ›´æ·±å±‚æ¬¡çš„å­èŠ‚ç‚¹ï¼Œ å½¢æˆè®¾å¤‡æ ‘çš„å±‚æ¬¡ç»“æ„ã€‚</p>
<h3 id="1-3-ä¸€ä¸ªç®€å•ç¤ºä¾‹"><a href="#1-3-ä¸€ä¸ªç®€å•ç¤ºä¾‹" class="headerlink" title="1.3 ä¸€ä¸ªç®€å•ç¤ºä¾‹"></a><font size=3>1.3 ä¸€ä¸ªç®€å•ç¤ºä¾‹</font></h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/dts-v1/;</span><br><span class="line">/ &#123;</span><br><span class="line">    uart0: uart@fe001000 &#123;</span><br><span class="line">        compatible=<span class="string">&quot;ns16550&quot;</span>;</span><br><span class="line">        reg=&lt;<span class="number">0xfe001000</span> <span class="number">0x100</span>&gt;;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="2-èŠ‚ç‚¹å±æ€§"><a href="#2-èŠ‚ç‚¹å±æ€§" class="headerlink" title="2. èŠ‚ç‚¹å±æ€§"></a><font size=3>2. èŠ‚ç‚¹å±æ€§</font></h2><p>èŠ‚ç‚¹æ˜¯ç”±ä¸€å †çš„å±æ€§ç»„æˆï¼ŒèŠ‚ç‚¹éƒ½æ˜¯å…·ä½“çš„è®¾å¤‡ï¼Œä¸åŒçš„è®¾å¤‡éœ€è¦çš„å±æ€§ä¸åŒï¼Œç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰å±æ€§ã€‚é™¤äº†ç”¨æˆ·è‡ªå®šä¹‰å±æ€§ï¼Œæœ‰å¾ˆå¤šå±æ€§æ˜¯æ ‡å‡†å±æ€§ï¼Œ Linux ä¸‹çš„å¾ˆå¤šå¤–è®¾é©±åŠ¨éƒ½ä¼šä½¿ç”¨è¿™äº›æ ‡å‡†å±æ€§ã€‚</p>
<h3 id="2-1-å±æ€§æ ¼å¼"><a href="#2-1-å±æ€§æ ¼å¼" class="headerlink" title="2.1 å±æ€§æ ¼å¼"></a><font size=3>2.1 å±æ€§æ ¼å¼</font></h3><p>ç®€å•åœ°è¯´ï¼Œ properties å°±æ˜¯â€œname&#x3D;valueâ€ï¼Œ value æœ‰å¤šç§å–å€¼æ–¹å¼ã€‚  </p>
<h4 id="2-1-1-Property-æ ¼å¼-1"><a href="#2-1-1-Property-æ ¼å¼-1" class="headerlink" title="2.1.1Â Property æ ¼å¼ 1"></a><font size=3>2.1.1Â Property æ ¼å¼ 1</font></h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[label:] property-name = value;</span><br></pre></td></tr></table></figure>

<p>Property å–å€¼å¯ä»¥æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p>
<ul>
<li>arrays of cells(1 ä¸ªæˆ–å¤šä¸ª 32 ä½æ•°æ®, 64 ä½æ•°æ®ä½¿ç”¨ 2 ä¸ª 32 ä½æ•°æ®è¡¨ç¤º)ã€‚cell å°±æ˜¯ä¸€ä¸ª 32 ä½çš„æ•°æ®ï¼Œç”¨å°–æ‹¬å·åŒ…å›´èµ·æ¥</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">interrupts = &lt;<span class="number">17</span> <span class="number">0xc</span>&gt;;</span><br></pre></td></tr></table></figure>

<p>64bit æ•°æ®ä½¿ç”¨ 2 ä¸ª cell æ¥è¡¨ç¤ºï¼Œç”¨å°–æ‹¬å·åŒ…å›´èµ·æ¥:  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clock-frequency = &lt;<span class="number">0x00000001</span> <span class="number">0x00000000</span>&gt;;</span><br></pre></td></tr></table></figure>

<ul>
<li>string(å­—ç¬¦ä¸²)</li>
</ul>
<p>A null-terminated string (æœ‰ç»“æŸç¬¦çš„å­—ç¬¦ä¸²)ï¼Œç”¨åŒå¼•å·åŒ…å›´èµ·æ¥:  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">compatible = <span class="string">&quot;simple-bus&quot;</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>bytestring(1 ä¸ªæˆ–å¤šä¸ªå­—èŠ‚)</li>
</ul>
<p>A bytestring(å­—èŠ‚åºåˆ—) ï¼Œç”¨ä¸­æ‹¬å·åŒ…å›´èµ·æ¥:  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">local-mac-address = [<span class="number">00</span> <span class="number">00</span> <span class="number">12</span> <span class="number">34</span> <span class="number">56</span> <span class="number">78</span>]; <span class="comment">// æ¯ä¸ª byte ä½¿ç”¨ 2 ä¸ª 16 è¿›åˆ¶æ•°æ¥è¡¨ç¤º</span></span><br><span class="line">local-mac-address = [<span class="number">000012345678</span>]; <span class="comment">// æ¯ä¸ª byte ä½¿ç”¨ 2 ä¸ª 16 è¿›åˆ¶æ•°æ¥è¡¨ç¤º</span></span><br></pre></td></tr></table></figure>

<ul>
<li>ä¹Ÿå¯ä»¥æ˜¯å„ç§å€¼çš„ç»„åˆ, ç”¨é€—å·éš”å¼€:</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">compatible = <span class="string">&quot;ns16550&quot;</span>, <span class="string">&quot;ns8250&quot;</span>;</span><br><span class="line">example = &lt;<span class="number">0xf00f0000</span> <span class="number">19</span>&gt;, <span class="string">&quot;a strange property format&quot;</span>;</span><br></pre></td></tr></table></figure>

<h4 id="2-1-2-Property-æ ¼å¼-2-æ²¡æœ‰å€¼"><a href="#2-1-2-Property-æ ¼å¼-2-æ²¡æœ‰å€¼" class="headerlink" title="2.1.2Â Property æ ¼å¼ 2(æ²¡æœ‰å€¼)"></a><font size=3>2.1.2Â Property æ ¼å¼ 2(æ²¡æœ‰å€¼)</font></h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[label:] property-name;</span><br></pre></td></tr></table></figure>

<h3 id="2-2-å¸¸ç”¨å±æ€§"><a href="#2-2-å¸¸ç”¨å±æ€§" class="headerlink" title="2.2 å¸¸ç”¨å±æ€§"></a><font size=3>2.2 å¸¸ç”¨å±æ€§</font></h3><h4 id="2-2-1-compatible"><a href="#2-2-1-compatible" class="headerlink" title="2.2.1Â compatible  "></a><font size=3>2.2.1Â compatible  </font></h4><p>åœ¨è®¾å¤‡æ ‘ä¸­ï¼Œ compatible å±æ€§ç”¨äºæè¿°è®¾å¤‡çš„å…¼å®¹æ€§ä¿¡æ¯ã€‚ å®ƒæ˜¯è®¾å¤‡æ ‘ä¸­é‡è¦çš„å±æ€§ä¹‹ä¸€ï¼Œç”¨äºè¯†åˆ«è®¾å¤‡èŠ‚ç‚¹ä¸é©±åŠ¨ç¨‹åºä¹‹é—´çš„åŒ¹é…å…³ç³»ã€‚  </p>
<p>compatible å±æ€§çš„å€¼æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–å­—ç¬¦ä¸²åˆ—è¡¨ï¼Œ ç”¨äºæŒ‡å®šè®¾å¤‡èŠ‚ç‚¹ä¸ç›¸åº”çš„é©±åŠ¨ç¨‹åºæˆ–è®¾å¤‡æè¿°ç¬¦å…¼å®¹çš„è§„åˆ™ã€‚ é€šå¸¸ï¼Œ compatible å±æ€§çš„å€¼ç”±è®¾å¤‡çš„å‚å•†å®šä¹‰ï¼Œ å¹¶ä¸”åœ¨è®¾å¤‡æ ‘ä¸­ä½¿ç”¨ã€‚  </p>
<p>ä¸€èˆ¬æ ¼å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;manufacturer,model&quot;</span></span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ manufacturer è¡¨ç¤ºå‚å•†ï¼Œ model ä¸€èˆ¬æ˜¯æ¨¡å—å¯¹åº”çš„é©±åŠ¨åå­—ã€‚æ¯”å¦‚ imx6ull-alpha-emmc.dts ä¸­ sound èŠ‚ç‚¹æ˜¯ I.MX6U-ALPHA å¼€å‘æ¿çš„éŸ³é¢‘è®¾å¤‡èŠ‚ç‚¹ï¼Œ I.MX6U-ALPHA å¼€å‘æ¿ä¸Šçš„éŸ³é¢‘èŠ¯ç‰‡é‡‡ç”¨çš„æ¬§èƒœ(WOLFSON)å‡ºå“çš„ WM8960ï¼Œ sound èŠ‚ç‚¹çš„ compatible å±æ€§å€¼å¦‚ä¸‹ï¼š    </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">compatible = <span class="string">&quot;fsl,imx6ul-evk-wm8960&quot;</span>,<span class="string">&quot;fsl,imx-audio-wm8960&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>å±æ€§å€¼æœ‰ä¸¤ä¸ªï¼Œåˆ†åˆ«ä¸ºâ€œfsl,imx6ul-evk-wm8960â€å’Œâ€œfsl,imx-audio-wm8960â€ï¼Œå…¶ä¸­â€œfslâ€è¡¨ç¤ºå‚å•†æ˜¯é£æ€å¡å°”ï¼Œâ€œimx6ul-evk-wm8960â€å’Œâ€œimx-audio-wm8960â€è¡¨ç¤ºé©±åŠ¨æ¨¡å—åå­—ã€‚ soundè¿™ä¸ªè®¾å¤‡é¦–å…ˆä½¿ç”¨ç¬¬ä¸€ä¸ªå…¼å®¹å€¼åœ¨ Linux å†…æ ¸é‡Œé¢æŸ¥æ‰¾ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½æ‰¾åˆ°ä¸ä¹‹åŒ¹é…çš„é©±åŠ¨æ–‡ä»¶ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°çš„è¯å°±ä½¿ç”¨ç¬¬äºŒä¸ªå…¼å®¹å€¼æŸ¥ã€‚</p>
<p>ä¸€èˆ¬é©±åŠ¨ç¨‹åºæ–‡ä»¶éƒ½ä¼šæœ‰ä¸€ä¸ª OF åŒ¹é…è¡¨ï¼Œæ­¤ OF åŒ¹é…è¡¨ä¿å­˜ç€ä¸€äº› compatible å€¼ï¼Œå¦‚æœè®¾å¤‡èŠ‚ç‚¹çš„ compatible å±æ€§å€¼å’Œ OF åŒ¹é…è¡¨ä¸­çš„ä»»ä½•ä¸€ä¸ªå€¼ç›¸ç­‰ï¼Œé‚£ä¹ˆå°±è¡¨ç¤ºè®¾å¤‡å¯ä»¥ä½¿ç”¨è¿™ä¸ªé©±åŠ¨ã€‚æ¯”å¦‚åœ¨æ–‡ä»¶ imx-wm8960.c ä¸­æœ‰å¦‚ä¸‹å†…å®¹ï¼š  </p>
  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="class"><span class="keyword">struct</span> <span class="title">of_device_id</span> <span class="title">imx_wm8960_dt_ids</span>[] =</span> &#123;</span><br><span class="line">    &#123;</span><br><span class="line">        .compatible = <span class="string">&quot;fsl,imx-audio-wm8960&quot;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;<span class="comment">/* sentinel */</span>&#125;&#125;;</span><br><span class="line">MODULE_DEVICE_TABLE(of, imx_wm8960_dt_ids);</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">platform_driver</span> <span class="title">imx_wm8960_driver</span> =</span> &#123;</span><br><span class="line">    .driver = &#123;</span><br><span class="line">        .name = <span class="string">&quot;imx-wm8960&quot;</span>,</span><br><span class="line">        .pm = &amp;snd_soc_pm_ops,</span><br><span class="line">        .of_match_table = imx_wm8960_dt_ids,</span><br><span class="line">    &#125;,</span><br><span class="line">    .probe = imx_wm8960_probe,</span><br><span class="line">    .remove = imx_wm8960_remove,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>ç¬¬ 1 - 5 è¡Œï¼šæ•°ç»„ imx_wm8960_dt_ids å°±æ˜¯ imx-wm8960.c è¿™ä¸ªé©±åŠ¨æ–‡ä»¶çš„åŒ¹é…è¡¨ï¼Œæ­¤åŒ¹é…è¡¨åªæœ‰ä¸€ä¸ªåŒ¹é…å€¼â€œfsl,imx-audio-wm8960â€ã€‚å¦‚æœåœ¨è®¾å¤‡æ ‘ä¸­æœ‰å“ªä¸ªèŠ‚ç‚¹çš„ compatible å±æ€§å€¼ä¸æ­¤ç›¸ç­‰ï¼Œé‚£ä¹ˆè¿™ä¸ªèŠ‚ç‚¹å°±ä¼šä½¿ç”¨æ­¤é©±åŠ¨æ–‡ä»¶ã€‚</p>
<p>ç¬¬ 12 è¡Œï¼Œ wm8960 é‡‡ç”¨äº† platform_driver é©±åŠ¨æ¨¡å¼ï¼Œå…³äº platform_driver é©±åŠ¨åé¢ä¼šè®²è§£ã€‚æ­¤è¡Œè®¾ç½®.of_match_table ä¸º imx_wm8960_dt_idsï¼Œä¹Ÿå°±æ˜¯è®¾ç½®è¿™ä¸ª platform_driver æ‰€ä½¿ç”¨çš„OF åŒ¹é…è¡¨ã€‚    </p>
<blockquote>
<p>æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªå±æ€§å¯èƒ½çš„å–å€¼æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p>
<p>ï¼ˆ1ï¼‰ å•ä¸ªå­—ç¬¦ä¸²å€¼ï¼š ä¾‹å¦‚ â€œvendor,deviceâ€ï¼Œ ç”¨äºæŒ‡å®šè®¾å¤‡èŠ‚ç‚¹ä¸ç‰¹å®šå‚å•†çš„ç‰¹å®šè®¾å¤‡å…¼å®¹ã€‚</p>
<p>ï¼ˆ2ï¼‰ å­—ç¬¦ä¸²åˆ—è¡¨ï¼š ä¾‹å¦‚ [â€œvendor,device1â€, â€œvendor,device2â€]ï¼Œ ç”¨äºæŒ‡å®šè®¾å¤‡èŠ‚ç‚¹ä¸å¤šä¸ªè®¾å¤‡å…¼å®¹ï¼Œ é€šå¸¸ç”¨äºè®¾å¤‡èŠ‚ç‚¹å…·æœ‰å¤šç§å˜ä½“æˆ–é…ç½®ã€‚å¯ä»¥ç”¨äºæŒ‡å®šè®¾å¤‡èŠ‚ç‚¹ä¸å¤šä¸ªè®¾å¤‡æˆ–é©±åŠ¨ç¨‹åºçš„å…¼å®¹æ€§è§„åˆ™ã€‚   </p>
<p>ï¼ˆ3ï¼‰ é€šé…ç¬¦åŒ¹é…ï¼š ä¾‹å¦‚ â€œvendor,*â€ï¼Œ ç”¨äºæŒ‡å®šè®¾å¤‡èŠ‚ç‚¹ä¸ç‰¹å®šå‚å•†çš„æ‰€æœ‰è®¾å¤‡å…¼å®¹ï¼Œ ä¸è€ƒè™‘å…·ä½“çš„è®¾å¤‡æ ‡è¯†ã€‚ </p>
</blockquote>
<h4 id="2-2-2-mode"><a href="#2-2-2-mode" class="headerlink" title="2.2.2 mode"></a><font size=3>2.2.2 mode</font></h4><p>åœ¨è®¾å¤‡æ ‘ä¸­ï¼Œ model å±æ€§ç”¨äºæè¿°è®¾å¤‡çš„å‹å·æˆ–è€…åç§°ã€‚ å®ƒé€šå¸¸ä½œä¸ºè®¾å¤‡èŠ‚ç‚¹çš„ä¸€ä¸ªå±æ€§ï¼Œç”¨æ¥æä¾›å…³äºè®¾å¤‡çš„æ ‡è¯†ä¿¡æ¯ã€‚ model å±æ€§æ˜¯å¯é€‰çš„ï¼Œ ä½†åœ¨å®é™…åº”ç”¨ä¸­ç»å¸¸è¢«ä½¿ç”¨ã€‚  </p>
<p>model å±æ€§çš„å€¼æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œ å¯ä»¥æ˜¯è®¾å¤‡çš„å‹å·ã€ åç§°ã€ æˆ–è€…å…¶ä»–æ ‡è¯†ç¬¦ï¼Œ ç”¨æ¥è¯†åˆ«è®¾å¤‡ã€‚ è¯¥å€¼é€šå¸¸ç”±è®¾å¤‡çš„å‚å•†å®šä¹‰ï¼Œ å¹¶ä¸”åœ¨è®¾å¤‡æ ‘ä¸­ä½¿ç”¨ã€‚  </p>
<p>model å±æ€§ä¸ compatible å±æ€§æœ‰äº›ç±»ä¼¼ï¼Œä½†æ˜¯æœ‰å·®åˆ«ã€‚model å±æ€§é€šå¸¸ç”¨äºæ ‡è¯†å’ŒåŒºåˆ†ä¸åŒçš„è®¾å¤‡ï¼Œ ç‰¹åˆ«æ˜¯å½“è®¾å¤‡èŠ‚ç‚¹çš„ compatible å±æ€§ç›¸åŒæˆ–ç›¸ä¼¼æ—¶ã€‚ é€šè¿‡ä½¿ç”¨ä¸åŒçš„ model å±æ€§å€¼ï¼Œ å¯ä»¥æ›´åŠ å‡†ç¡®åœ°ç¡®å®šæ‰€ä½¿ç”¨çš„è®¾å¤‡ç±»å‹ã€‚  æ¯”å¦‚ compatible å±æ€§æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨ï¼Œè¡¨ç¤ºæˆ‘ä»¬çš„ç¡¬ä»¶å¯ä»¥å…¼å®¹ Aã€ Bã€ C ç­‰é©±åŠ¨ï¼›model ç”¨æ¥å‡†ç¡®åœ°å®šä¹‰è¿™ä¸ªç¡¬ä»¶æ˜¯ä»€ä¹ˆã€‚</p>
<p>æ¯”å¦‚æ ¹èŠ‚ç‚¹ä¸­å¯ä»¥è¿™æ ·å†™ï¼š  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">my_device &#123;</span><br><span class="line">    compatible = <span class="string">&quot;samsung,smdk2440&quot;</span>, <span class="string">&quot;samsung,mini2440&quot;</span>;</span><br><span class="line">    model = <span class="string">&quot;jz2440_v3&quot;</span>;</span><br><span class="line">    <span class="comment">// å…¶ä»–å±æ€§å’Œå­èŠ‚ç‚¹çš„å®šä¹‰</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>å®ƒè¡¨ç¤ºè¿™ä¸ªå•æ¿ï¼Œå¯ä»¥å…¼å®¹å†…æ ¸ä¸­çš„â€œ smdk2440â€ï¼Œä¹Ÿå…¼å®¹â€œ mini2440â€ã€‚ä» compatible å±æ€§ä¸­å¯ä»¥çŸ¥é“å®ƒå…¼å®¹å“ªäº›æ¿ï¼Œä½†æ˜¯å®ƒåˆ°åº•æ˜¯ä»€ä¹ˆæ¿ï¼Ÿç”¨model å±æ€§æ¥æ˜ç¡®ã€‚</p>
<h4 id="2-2-3-status"><a href="#2-2-3-status" class="headerlink" title="2.2.3Â status  "></a><font size=3>2.2.3Â status  </font></h4><p>åœ¨è®¾å¤‡æ ‘ä¸­ï¼Œ status å±æ€§ç”¨äºæè¿°è®¾å¤‡æˆ–èŠ‚ç‚¹çš„çŠ¶æ€ã€‚ å®ƒæ˜¯è®¾å¤‡æ ‘ä¸­å¸¸è§çš„å±æ€§ä¹‹ä¸€ï¼Œ ç”¨äºè¡¨ç¤ºè®¾å¤‡æˆ–èŠ‚ç‚¹çš„å¯ç”¨æ€§æˆ–æ“ä½œçŠ¶æ€ã€‚å¯é€‰çš„çŠ¶æ€å¦‚ä¸‹è¡¨ï¼š</p>
<table>
<thead>
<tr>
<th align="center">å€¼</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="center">â€œokayâ€</td>
<td>è¡¨æ˜è®¾å¤‡æ˜¯å¯æ“ä½œçš„ã€‚</td>
</tr>
<tr>
<td align="center">â€œdisabledâ€</td>
<td>è¡¨æ˜è®¾å¤‡å½“å‰æ˜¯ä¸å¯æ“ä½œçš„ï¼Œä½†æ˜¯åœ¨æœªæ¥å¯ä»¥å˜ä¸ºå¯æ“ä½œçš„ï¼Œæ¯”å¦‚çƒ­æ’æ‹”è®¾å¤‡æ’å…¥ä»¥åã€‚è‡³äº disabled çš„å…·ä½“å«ä¹‰è¿˜è¦çœ‹è®¾å¤‡çš„ç»‘å®šæ–‡æ¡£ã€‚</td>
</tr>
<tr>
<td align="center">â€œfailâ€</td>
<td>è¡¨æ˜è®¾å¤‡ä¸å¯æ“ä½œï¼Œè®¾å¤‡æ£€æµ‹åˆ°äº†ä¸€ç³»åˆ—çš„é”™è¯¯ï¼Œè€Œä¸”è®¾å¤‡ä¹Ÿä¸å¤§å¯èƒ½å˜å¾—å¯æ“ä½œã€‚</td>
</tr>
<tr>
<td align="center">â€œfail-sssâ€</td>
<td>å«ä¹‰å’Œâ€œfailâ€ç›¸åŒï¼Œåé¢çš„ sss éƒ¨åˆ†æ˜¯æ£€æµ‹åˆ°çš„é”™è¯¯å†…å®¹ã€‚</td>
</tr>
</tbody></table>
<p>dtsi æ–‡ä»¶ä¸­å®šä¹‰äº†å¾ˆå¤šè®¾å¤‡ï¼Œä½†æ˜¯åœ¨æˆ‘ä»¬çš„æ¿å­ä¸ŠæŸäº›è®¾å¤‡æ˜¯æ²¡æœ‰çš„ã€‚è¿™æ—¶å¯ä»¥ç»™è¿™ä¸ªè®¾å¤‡èŠ‚ç‚¹æ·»åŠ ä¸€ä¸ª status å±æ€§ï¼Œè®¾ç½®ä¸ºâ€œdisabledâ€ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&amp;uart1 &#123;</span><br><span class="line">    status = <span class="string">&quot;disabled&quot;</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡ä½¿ç”¨ status å±æ€§ï¼Œ è®¾å¤‡æ ‘å¯ä»¥åŠ¨æ€åœ°æ§åˆ¶è®¾å¤‡çš„å¯ç”¨å’Œç¦ç”¨çŠ¶æ€ã€‚ è¿™å¯¹äºåœ¨ç³»ç»Ÿå¯åŠ¨è¿‡ç¨‹ä¸­é€‰æ‹©æ€§åœ°å¯ç”¨æˆ–ç¦ç”¨è®¾å¤‡ï¼Œ æˆ–è€…åœ¨è¿è¡Œæ—¶æ ¹æ®ç‰¹å®šæ¡ä»¶è°ƒæ•´è®¾å¤‡çŠ¶æ€éå¸¸æœ‰ç”¨ã€‚  </p>
<h4 id="2-2-4-reg"><a href="#2-2-4-reg" class="headerlink" title="2.2.4Â reg  "></a><font size=3>2.2.4Â reg  </font></h4><p>reg çš„æœ¬æ„æ˜¯ registerï¼Œè¡¨ç¤ºå¯„å­˜å™¨åœ°å€ï¼Œå¾ˆå®¹æ˜“å°±çŸ¥é“è¿™ä¸ªå±æ€§ç”¨äºåœ¨è®¾å¤‡æ ‘ä¸­æŒ‡å®šè®¾å¤‡çš„å¯„å­˜å™¨åœ°å€å’Œå¤§å°ï¼Œ æä¾›äº†ä¸è®¾å¤‡æ ‘ä¸­çš„ç‰©ç†è®¾å¤‡ä¹‹é—´çš„å¯„å­˜å™¨æ˜ å°„å…³ç³»ã€‚  </p>
<p>åœ¨è®¾å¤‡æ ‘é‡Œï¼Œå®ƒå¯ä»¥ç”¨æ¥æè¿°ä¸€æ®µç©ºé—´ã€‚åæ­£å¯¹äº ARM ç³»ç»Ÿï¼Œå¯„å­˜å™¨å’Œå†…å­˜æ˜¯ç»Ÿä¸€ç¼–å€çš„ï¼Œå³è®¿é—®å¯„å­˜å™¨æ—¶ç”¨æŸå—åœ°å€ï¼Œè®¿é—®å†…å­˜æ—¶ç”¨æŸå—åœ°å€ï¼Œåœ¨è®¿é—®æ–¹æ³•ä¸Šæ²¡æœ‰åŒºåˆ«ã€‚  </p>
<p>reg å±æ€§å¯ä»¥åœ¨è®¾å¤‡èŠ‚ç‚¹ä¸­æœ‰å•ä¸ªå€¼æ ¼å¼å’Œåˆ—è¡¨å€¼æ ¼å¼è¿™ä¸¤ç§å¸¸è§æ ¼å¼ã€‚</p>
<ul>
<li>ï¼ˆ1ï¼‰ å•ä¸ªå€¼æ ¼å¼å¦‚ä¸‹ï¼š</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reg = &lt;address size&gt;;</span><br></pre></td></tr></table></figure>

<p>è¿™ç§æ ¼å¼é€‚ç”¨äºæè¿°å•ä¸ªå¯„å­˜å™¨çš„æƒ…å†µã€‚ å…¶ä¸­ï¼Œ address æ˜¯è®¾å¤‡çš„èµ·å§‹å¯„å­˜å™¨åœ°å€ï¼Œ å¯ä»¥æ˜¯ä¸€ä¸ªæ•´æ•°æˆ–åå…­è¿›åˆ¶å€¼ã€‚ size è¡¨ç¤ºå¯„å­˜å™¨çš„å¤§å°ï¼Œ å³å ç”¨çš„å­—èŠ‚æ•°ã€‚  </p>
<p>ä¾‹å¦‚ï¼Œ å‡è®¾æœ‰ä¸€ä¸ªè®¾å¤‡èŠ‚ç‚¹ my_deviceï¼Œ ä½¿ç”¨å•ä¸ªå€¼æ ¼å¼çš„ reg å±æ€§æ¥æè¿°ä¸€ä¸ª 4 å­—èŠ‚å¯„å­˜å™¨çš„åœ°å€å’Œå¤§å°ï¼Œ å¯ä»¥è¿™æ ·å®šä¹‰ï¼š  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">my_device &#123;</span><br><span class="line">    compatible = <span class="string">&quot;vendor,device&quot;</span>;</span><br><span class="line">    reg = &lt;<span class="number">0x1000</span> <span class="number">0x4</span>&gt;;</span><br><span class="line">    <span class="comment">// å…¶ä»–å±æ€§å’Œå­èŠ‚ç‚¹çš„å®šä¹‰</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œ <code>my_device</code> è®¾å¤‡èŠ‚ç‚¹çš„ <code>reg</code> å±æ€§å€¼ä¸º <code>&lt;0x1000 0x4&gt;</code>ï¼Œ è¡¨ç¤ºä»åœ°å€<code>0x1000</code> å¼€å§‹çš„ 4 å­—èŠ‚å¯„å­˜å™¨åŒºåŸŸã€‚</p>
<ul>
<li>ï¼ˆ2ï¼‰ åˆ—è¡¨å€¼æ ¼å¼å¦‚ä¸‹ï¼š</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reg = &lt;address1 size1 address2 size2 ...&gt;;</span><br></pre></td></tr></table></figure>

<p>å½“è®¾å¤‡å…·æœ‰å¤šä¸ªå¯„å­˜å™¨åŒºåŸŸæ—¶ï¼Œ å¯ä»¥ä½¿ç”¨åˆ—è¡¨å€¼æ ¼å¼çš„ reg å±æ€§æ¥æè¿°æ¯ä¸ªå¯„å­˜å™¨åŒºåŸŸçš„åœ°å€å’Œå¤§å°ã€‚ é€šè¿‡è¿™ç§æ–¹å¼ï¼Œ å¯ä»¥æŒ‡å®šå¤šä¸ªå¯„å­˜å™¨çš„ä½ç½®å’Œå¤§å°ï¼Œ ä»¥æè¿°è®¾å¤‡çš„å®Œæ•´å¯„å­˜å™¨æ˜ å°„ã€‚</p>
<p>ä¾‹å¦‚ï¼Œ è€ƒè™‘ä¸€ä¸ªè®¾å¤‡èŠ‚ç‚¹ my_deviceï¼Œ å®ƒå…·æœ‰ä¸¤ä¸ªå¯„å­˜å™¨åŒºåŸŸï¼Œ åˆ†åˆ«æ˜¯ 8 å­—èŠ‚å’Œ 4 å­—èŠ‚å¤§å°çš„å¯„å­˜å™¨ã€‚ å¯ä»¥ä½¿ç”¨åˆ—è¡¨å€¼æ ¼å¼çš„ reg å±æ€§æ¥æè¿°è¿™ç§æƒ…å†µï¼š  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">my_device &#123;</span><br><span class="line">    compatible = <span class="string">&quot;vendor,device&quot;</span>;</span><br><span class="line">    reg = &lt;<span class="number">0x1000</span> <span class="number">0x8</span> <span class="number">0x2000</span> <span class="number">0x4</span>&gt;;</span><br><span class="line">    <span class="comment">// å…¶ä»–å±æ€§å’Œå­èŠ‚ç‚¹çš„å®šä¹‰</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œ my_device è®¾å¤‡èŠ‚ç‚¹çš„ reg å±æ€§å€¼ä¸º &lt;0x1000 0x8 0x2000 0x4&gt;ï¼Œ è¡¨ç¤ºè®¾å¤‡æœ‰ä¸¤ä¸ªå¯„å­˜å™¨åŒºåŸŸã€‚ ç¬¬ä¸€ä¸ªå¯„å­˜å™¨åŒºåŸŸä»åœ°å€ 0x1000 å¼€å§‹ï¼Œ å¤§å°ä¸º 8 å­—èŠ‚ï¼› ç¬¬äºŒä¸ªå¯„å­˜å™¨åŒºåŸŸä»åœ°å€ 0x2000 å¼€å§‹ï¼Œ å¤§å°ä¸º 4 å­—èŠ‚ã€‚  </p>
<p>é€šè¿‡ä½¿ç”¨ reg å±æ€§ï¼Œ è®¾å¤‡æ ‘å¯ä»¥æä¾›æœ‰å…³è®¾å¤‡å¯„å­˜å™¨å¸ƒå±€å’Œå¯„å­˜å™¨è®¿é—®æ–¹å¼çš„ä¿¡æ¯ã€‚ è¿™å¯¹äºæ“ä½œç³»ç»Ÿçš„è®¾å¤‡é©±åŠ¨ç¨‹åºå¾ˆé‡è¦ï¼Œ å› ä¸ºå®ƒä»¬éœ€è¦äº†è§£è®¾å¤‡çš„å¯„å­˜å™¨æ˜ å°„ä»¥æ­£ç¡®åœ°ä¸è®¾å¤‡è¿›è¡Œäº¤äº’å’Œé…ç½®ã€‚  </p>
<h4 id="2-2-5-address-cells-å’Œ-size-cells"><a href="#2-2-5-address-cells-å’Œ-size-cells" class="headerlink" title="2.2.5Â address-cells å’Œ size-cells "></a><font size=3>2.2.5Â address-cells å’Œ size-cells </font></h4><p>#address-cells å’Œ #size-cells è¿™ä¸¤ä¸ªå±æ€§å¯ä»¥ç”¨åœ¨ä»»ä½•æ‹¥æœ‰å­èŠ‚ç‚¹çš„è®¾å¤‡ä¸­, ç”¨äºæŒ‡å®šregå±æ€§ä¸­è¦è®¾ç½®çš„è®¾å¤‡æ ‘ä¸­åœ°å€å•å…ƒå’Œå¤§å°å•å…ƒçš„ä½æ•°ã€‚ å®ƒä»¬æä¾›äº†è®¾å¤‡æ ‘è§£ææ‰€éœ€çš„å…ƒæ•°æ®ï¼Œ ä»¥æ­£ç¡®è§£é‡Šè®¾å¤‡çš„åœ°å€å’Œå¤§å°ä¿¡æ¯ã€‚</p>
<blockquote>
<p>Tipsï¼šæ€»çš„æ¥è¯´ï¼Œå°±æ˜¯#address-cells å’Œ#size-cells è¡¨æ˜äº†å­èŠ‚ç‚¹åº”è¯¥å¦‚ä½•ç¼–å†™ reg å±æ€§å€¼ ã€‚</p>
<ul>
<li>cell æŒ‡ä¸€ä¸ª 32 ä½çš„æ•°å€¼  </li>
<li>address-cellsï¼š address è¦ç”¨å¤šå°‘ä¸ª 32 ä½æ•°æ¥è¡¨ç¤º  </li>
<li>size-cellsï¼š size è¦ç”¨å¤šå°‘ä¸ª 32 ä½æ•°æ¥è¡¨ç¤º</li>
</ul>
<p>ä¹Ÿå°±æ˜¯è¯´#address-cells å±æ€§å€¼å†³å®šäº†å­èŠ‚ç‚¹ reg å±æ€§ä¸­åœ°å€ä¿¡æ¯æ‰€å ç”¨çš„å­—é•¿(32 ä½)ï¼Œ #size-cells å±æ€§å€¼å†³å®šäº†å­èŠ‚ç‚¹ reg å±æ€§ä¸­é•¿åº¦ä¿¡æ¯æ‰€å çš„å­—é•¿(32 ä½)ã€‚       </p>
</blockquote>
<ul>
<li>ï¼ˆ1ï¼‰ #address-cells å±æ€§</li>
</ul>
<p>#address-cells å±æ€§æ˜¯ä¸€ä¸ªä½äºè®¾å¤‡æ ‘æ ¹èŠ‚ç‚¹çš„ç‰¹æ®Šå±æ€§ï¼Œ å®ƒæŒ‡å®šäº†è®¾å¤‡æ ‘ä¸­åœ°å€å•å…ƒçš„ä½æ•°ã€‚ åœ°å€å•å…ƒæ˜¯è®¾å¤‡æ ‘ä¸­ç”¨äºè¡¨ç¤ºè®¾å¤‡åœ°å€çš„å•ä¸ªå•ä½ã€‚ å®ƒé€šå¸¸æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œ å¯ä»¥æ˜¯åè¿›åˆ¶æˆ–åå…­è¿›åˆ¶å€¼ã€‚  </p>
<p>#address-cells å±æ€§çš„å€¼å‘Šè¯‰è§£æè®¾å¤‡æ ‘çš„è½¯ä»¶åœ¨è§£é‡Šè®¾å¤‡åœ°å€æ—¶åº”è¯¥ä½¿ç”¨å¤šå°‘ä½æ¥è¡¨ç¤ºä¸€ä¸ªåœ°å€å•å…ƒã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œ #address-cells çš„å€¼ä¸º 2ï¼Œ è¡¨ç¤ºä½¿ç”¨ä¸¤ä¸ªå•å…ƒæ¥è¡¨ç¤ºä¸€ä¸ªè®¾å¤‡åœ°å€ã€‚ è¿™æ„å‘³ç€è®¾å¤‡çš„åœ°å€å°†ç”±ä¸¤ä¸ªæ•´æ•°ï¼ˆæ¯ä¸ªæ•´æ•°ä½¿ç”¨æŒ‡å®šä½æ•°çš„ä½ï¼‰ ç»„æˆã€‚</p>
<p>ä¾‹å¦‚ï¼Œ å¯¹äºä¸€ä¸ªä½¿ç”¨ä¸¤ä¸ª 32 ä½ï¼ˆ4 å­—èŠ‚ï¼‰ æ•´æ•°è¡¨ç¤ºåœ°å€çš„è®¾å¤‡ï¼Œ å¯ä»¥åœ¨è®¾å¤‡æ ‘çš„æ ¹èŠ‚ç‚¹ä¸­è®¾ç½® #address-cells å±æ€§ä¸º &lt;2&gt;ã€‚  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/ &#123;</span><br><span class="line">    <span class="meta">#address-cells = <span class="string">&lt;2&gt;</span>;</span></span><br><span class="line">    <span class="comment">//......</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ul>
<li>ï¼ˆ2ï¼‰ #size-cells å±æ€§</li>
</ul>
<p>#size-cells å±æ€§ä¹Ÿæ˜¯ä¸€ä¸ªä½äºè®¾å¤‡æ ‘æ ¹èŠ‚ç‚¹çš„ç‰¹æ®Šå±æ€§ï¼Œ å®ƒæŒ‡å®šäº†è®¾å¤‡æ ‘ä¸­å¤§å°å•å…ƒçš„ä½æ•°ã€‚ å¤§å°å•å…ƒæ˜¯è®¾å¤‡æ ‘ä¸­ç”¨äºè¡¨ç¤ºè®¾å¤‡å¤§å°çš„å•ä¸ªå•ä½ã€‚ å®ƒé€šå¸¸æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œ å¯ä»¥æ˜¯åè¿›åˆ¶æˆ–åå…­è¿›åˆ¶å€¼ã€‚#size-cells å±æ€§çš„å€¼å‘Šè¯‰è§£æè®¾å¤‡æ ‘çš„è½¯ä»¶åœ¨è§£é‡Šè®¾å¤‡å¤§å°æ—¶åº”è¯¥ä½¿ç”¨å¤šå°‘ä½æ¥è¡¨ç¤ºä¸€ä¸ªå¤§å°å•å…ƒã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ #size-cells çš„å€¼ä¸º 1ï¼Œ è¡¨ç¤ºä½¿ç”¨ä¸€ä¸ªå•å…ƒæ¥è¡¨ç¤ºä¸€ä¸ªè®¾å¤‡çš„å¤§å°ã€‚ è¿™æ„å‘³ç€è®¾å¤‡çš„å¤§å°å°†ç”±ä¸€ä¸ªæ•´æ•°ï¼ˆä½¿ç”¨æŒ‡å®šä½æ•°çš„ä½ï¼‰ è¡¨ç¤ºã€‚      </p>
<p>ä¾‹å¦‚ï¼Œ å¯¹äºä¸€ä¸ªä½¿ç”¨ä¸€ä¸ª 32 ä½ï¼ˆ4 å­—èŠ‚ï¼‰ æ•´æ•°è¡¨ç¤ºå¤§å°çš„è®¾å¤‡ï¼Œ å¯ä»¥åœ¨è®¾å¤‡æ ‘çš„æ ¹èŠ‚ç‚¹ä¸­è®¾ç½® #size-cells å±æ€§ä¸º &lt;1&gt;ã€‚  </p>
<p>è¿™ä¸¤ä¸ªå±æ€§çš„å­˜åœ¨æ˜¯ä¸ºäº†ä½¿è®¾å¤‡æ ‘èƒ½å¤Ÿçµæ´»åœ°æè¿°å„ç§è®¾å¤‡çš„åœ°å€å’Œå¤§å°è¡¨ç¤ºæ–¹å¼ã€‚ é€šè¿‡åœ¨è®¾å¤‡æ ‘çš„æ ¹èŠ‚ç‚¹ä¸­è®¾ç½®é€‚å½“çš„ #address-cells å’Œ #size-cells å€¼ï¼Œ è®¾å¤‡æ ‘è§£æè½¯ä»¶èƒ½å¤Ÿæ­£ç¡®åœ°è§£é‡Šè®¾å¤‡èŠ‚ç‚¹ä¸­çš„åœ°å€å’Œå¤§å°ä¿¡æ¯ã€‚  </p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong>  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">node1 &#123;</span><br><span class="line">    <span class="meta">#address-cells = <span class="string">&lt;1&gt;</span>;</span></span><br><span class="line">    <span class="meta">#size-cells = <span class="string">&lt;1&gt;</span>;</span></span><br><span class="line">    node1-child &#123;</span><br><span class="line">        reg = &lt;<span class="number">0x02200000</span> <span class="number">0x4000</span>&gt;;</span><br><span class="line">        <span class="comment">// å…¶ä»–å±æ€§å’Œå­èŠ‚ç‚¹çš„å®šä¹‰</span></span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œ node1-child èŠ‚ç‚¹çš„ reg å±æ€§ä½¿ç”¨äº† &lt;0x02200000 0x4000&gt; è¡¨ç¤ºåœ°å€å’Œå¤§å°ã€‚ç”±äº #address-cells çš„å€¼ä¸º &lt;1&gt;ï¼Œ è¡¨ç¤ºä½¿ç”¨ä¸€ä¸ªå•å…ƒæ¥è¡¨ç¤ºåœ°å€ã€‚ #size-cells çš„å€¼ä¹Ÿä¸º &lt;1&gt;ï¼Œ è¡¨ç¤ºä½¿ç”¨ä¸€ä¸ªå•å…ƒæ¥è¡¨ç¤ºå¤§å°ã€‚è§£é‡Šåçš„åœ°å€å’Œå¤§å°å€¼å¦‚ä¸‹ï¼š      </p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">åœ°å€éƒ¨åˆ†ï¼š 0x02200000 è¢«è§£é‡Šä¸ºä¸€ä¸ªåœ°å€å•å…ƒï¼Œ åœ°å€ä¸º 0x02200000ã€‚</span><br><span class="line">å¤§å°éƒ¨åˆ†ï¼š 0x4000 è¢«è§£é‡Šä¸ºä¸€ä¸ªå¤§å°å•å…ƒï¼Œ å¤§å°ä¸º 0x4000ã€‚</span><br></pre></td></tr></table></figure>

<p><strong>ç¤ºä¾‹ 2ï¼š</strong>  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">node1 &#123;</span><br><span class="line">    <span class="meta">#address-cells = <span class="string">&lt;2&gt;</span>;</span></span><br><span class="line">    <span class="meta">#size-cells = <span class="string">&lt;0&gt;</span>;</span></span><br><span class="line">    node1-child &#123;</span><br><span class="line">        reg = &lt;<span class="number">0x0000</span> <span class="number">0x0001</span>&gt;;</span><br><span class="line">        <span class="comment">// å…¶ä»–å±æ€§å’Œå­èŠ‚ç‚¹çš„å®šä¹‰</span></span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œ node1-child èŠ‚ç‚¹çš„ reg å±æ€§ä½¿ç”¨äº† &lt;0x0000 0x0001&gt; è¡¨ç¤ºåœ°å€ã€‚ ç”±äº #address-cells çš„å€¼ä¸º &lt;2&gt;ï¼Œ è¡¨ç¤ºä½¿ç”¨ä¸¤ä¸ªå•å…ƒæ¥è¡¨ç¤ºåœ°å€ã€‚ #size-cells çš„å€¼ä¸º &lt;0&gt;ï¼Œ è¡¨ç¤ºä¸ä½¿ç”¨å•å…ƒæ¥è¡¨ç¤ºå¤§å°ã€‚è§£é‡Šåçš„åœ°å€å€¼å¦‚ä¸‹ï¼š  </p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">åœ°å€éƒ¨åˆ†ï¼š0x0000 0x0001 è¢«è§£é‡Šä¸ºä¸¤ä¸ªåœ°å€å•å…ƒï¼Œ å…¶ä¸­ç¬¬ä¸€ä¸ªåœ°å€å•å…ƒä¸º 0x0000ï¼Œ ç¬¬äºŒä¸ªåœ°å€å•å…ƒä¸º 0x0001ã€‚</span><br><span class="line">å¤§å°éƒ¨åˆ†ï¼š#size-cellsä¸º0ï¼Œè¡¨ç¤ºæ²¡æœ‰å¤§å°éƒ¨åˆ†</span><br></pre></td></tr></table></figure>

<p><strong>ç¤ºä¾‹3ï¼š</strong></p>
<p>ä¸€æ®µå†…å­˜ï¼Œæ€ä¹ˆæè¿°å®ƒçš„èµ·å§‹åœ°å€å’Œå¤§å°ï¼Ÿå¦‚ä¸‹ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/ &#123;</span><br><span class="line">    <span class="meta">#address-cells = <span class="string">&lt;1&gt;</span>;</span></span><br><span class="line">    <span class="meta">#size-cells = <span class="string">&lt;1&gt;</span>;</span></span><br><span class="line">    memory &#123;</span><br><span class="line">        reg = &lt;<span class="number">0x80000000</span> <span class="number">0x20000000</span>&gt;;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>#address-cells ä¸º 1ï¼Œæ‰€ä»¥ reg ä¸­ç”¨ 1 ä¸ªæ•°æ¥è¡¨ç¤ºåœ°å€ï¼Œå³ç”¨0x80000000 æ¥è¡¨ç¤ºåœ°å€ï¼› #size-cells ä¸º 1ï¼Œæ‰€ä»¥ reg ä¸­ç”¨ 1 ä¸ªæ•°æ¥è¡¨ç¤ºå¤§å°ï¼Œå³ç”¨ 0x20000000 è¡¨ç¤ºå¤§å°  </p>
<p>è¿™ç§ä½¿ç”¨ #address-cells å’Œ #size-cells å±æ€§çš„æ–¹å¼ä½¿å¾—è®¾å¤‡æ ‘å¯ä»¥é€‚åº”ä¸åŒè®¾å¤‡çš„å¯„å­˜å™¨æ˜ å°„å’Œå¤§å°è¡¨ç¤ºæ–¹å¼ï¼Œ å¹¶ç¡®ä¿è®¾å¤‡æ ‘è§£æè½¯ä»¶èƒ½å¤Ÿæ­£ç¡®è§£é‡Šè®¾å¤‡çš„åœ°å€å’Œå¤§å°ä¿¡æ¯ã€‚  </p>
<h4 id="2-2-6-ranges"><a href="#2-2-6-ranges" class="headerlink" title="2.2.6Â ranges  "></a><font size=3>2.2.6Â ranges  </font></h4><p>rangeså±æ€§å€¼å¯ä»¥ä¸ºç©ºæˆ–è€…æŒ‰ç…§(child-bus-address,parent-bus-address,length)æ ¼å¼ç¼–å†™çš„æ•°å­—çŸ©é˜µï¼Œ ranges æ˜¯ä¸€ä¸ªåœ°å€æ˜ å°„&#x2F;è½¬æ¢è¡¨ï¼Œ ranges å±æ€§æ¯ä¸ªé¡¹ç›®ç”±å­åœ°å€ã€çˆ¶åœ°å€å’Œåœ°å€ç©ºé—´é•¿åº¦è¿™ä¸‰éƒ¨åˆ†ç»„æˆï¼š  </p>
<p><strong>child-bus-address</strong>ï¼šå­æ€»çº¿åœ°å€ç©ºé—´çš„ç‰©ç†åœ°å€ï¼Œç”±çˆ¶èŠ‚ç‚¹çš„#address-cells ç¡®å®šæ­¤ç‰©ç†åœ°å€æ‰€å ç”¨çš„å­—é•¿ã€‚</p>
<p><strong>parent-bus-address</strong>ï¼š çˆ¶æ€»çº¿åœ°å€ç©ºé—´çš„ç‰©ç†åœ°å€ï¼ŒåŒæ ·ç”±çˆ¶èŠ‚ç‚¹çš„#address-cells ç¡®å®šæ­¤ç‰©ç†åœ°å€æ‰€å ç”¨çš„å­—é•¿ã€‚</p>
<p><strong>length</strong>ï¼š å­åœ°å€ç©ºé—´çš„é•¿åº¦ï¼Œç”±çˆ¶èŠ‚ç‚¹çš„#size-cells ç¡®å®šæ­¤åœ°å€é•¿åº¦æ‰€å ç”¨çš„å­—é•¿ã€‚</p>
<p>å¦‚æœ ranges å±æ€§å€¼ä¸ºç©ºå€¼ï¼Œè¯´æ˜å­åœ°å€ç©ºé—´å’Œçˆ¶åœ°å€ç©ºé—´å®Œå…¨ç›¸åŒï¼Œä¸éœ€è¦è¿›è¡Œåœ°å€è½¬æ¢ï¼Œå¯¹äºæˆ‘ä»¬æ‰€ä½¿ç”¨çš„ I.MX6ULL æ¥è¯´ï¼Œå­åœ°å€ç©ºé—´å’Œçˆ¶åœ°å€ç©ºé—´å®Œå…¨ç›¸åŒï¼Œå› æ­¤ä¼šåœ¨ imx6ull.dtsiä¸­æ‰¾åˆ°å¤§é‡çš„å€¼ä¸ºç©ºçš„ ranges å±æ€§ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">soc &#123;</span><br><span class="line">	<span class="meta">#address-cells = <span class="string">&lt;1&gt;</span>;</span></span><br><span class="line">	<span class="meta">#size-cells = <span class="string">&lt;1&gt;</span>;</span></span><br><span class="line">	compatible = <span class="string">&quot;simple-bus&quot;</span>;</span><br><span class="line">	interrupt-parent = &lt;&amp;gpc&gt;;</span><br><span class="line">	ranges;</span><br><span class="line">	<span class="comment">//......</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ranges å±æ€§ä¸ä¸ºç©ºçš„ç¤ºä¾‹ä»£ç å¦‚ä¸‹:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">soc &#123;</span><br><span class="line">	compatible = <span class="string">&quot;simple-bus&quot;</span>;</span><br><span class="line">	<span class="meta">#address-cells = <span class="string">&lt;1&gt;</span>;</span></span><br><span class="line">	<span class="meta">#size-cells = <span class="string">&lt;1&gt;</span>;</span></span><br><span class="line">	ranges = &lt;<span class="number">0x0</span> <span class="number">0xe0000000</span> <span class="number">0x00100000</span>&gt;;</span><br><span class="line"></span><br><span class="line">	serial &#123;</span><br><span class="line">		device_type = <span class="string">&quot;serial&quot;</span>;</span><br><span class="line">		compatible = <span class="string">&quot;ns16550&quot;</span>;</span><br><span class="line">		reg = &lt;<span class="number">0x4600</span> <span class="number">0x100</span>&gt;;</span><br><span class="line">		clock-frequency = &lt;<span class="number">0</span>&gt;;</span><br><span class="line">		interrupts = &lt;<span class="number">0xA</span> <span class="number">0x8</span>&gt;;</span><br><span class="line">		interrupt-parent = &lt;&amp;ipic&gt;;</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>ç¬¬5è¡Œï¼šèŠ‚ç‚¹ soc å®šä¹‰çš„ ranges å±æ€§ï¼Œå€¼ä¸º&lt;0x0 0xe0000000 0x00100000&gt;ï¼Œæ­¤å±æ€§å€¼æŒ‡å®šäº†ä¸€ä¸ª 1024KB(0x00100000)çš„åœ°å€èŒƒå›´ï¼Œå­åœ°å€ç©ºé—´çš„ç‰©ç†èµ·å§‹åœ°å€ä¸º 0x0ï¼Œçˆ¶åœ°å€ç©ºé—´çš„ç‰©ç†èµ·å§‹åœ°å€ä¸º 0xe0000000ã€‚  </p>
<p>ç¬¬ 10 è¡Œï¼Œ serial æ˜¯ä¸²å£è®¾å¤‡èŠ‚ç‚¹ï¼Œ reg å±æ€§å®šä¹‰äº† serial è®¾å¤‡å¯„å­˜å™¨çš„èµ·å§‹åœ°å€ä¸º 0x4600ï¼Œå¯„å­˜å™¨é•¿åº¦ä¸º 0x100ã€‚ç»è¿‡åœ°å€è½¬æ¢ï¼Œ serial è®¾å¤‡å¯ä»¥ä» 0xe0004600 å¼€å§‹è¿›è¡Œè¯»å†™æ“ä½œï¼Œ 0xe0004600 &#x3D; 0x4600 + 0xe0000000ã€‚  </p>
<h4 id="2-2-7-name"><a href="#2-2-7-name" class="headerlink" title="2.2.7 name"></a><font size=3>2.2.7 name</font></h4><p>name å±æ€§å€¼ä¸ºå­—ç¬¦ä¸²ï¼Œ name å±æ€§ç”¨äºè®°å½•èŠ‚ç‚¹åå­—ï¼Œ name å±æ€§å·²ç»è¢«å¼ƒç”¨ï¼Œä¸æ¨èä½¿ç”¨name å±æ€§ï¼Œä¸€äº›è€çš„è®¾å¤‡æ ‘æ–‡ä»¶å¯èƒ½ä¼šä½¿ç”¨æ­¤å±æ€§ã€‚  </p>
<h4 id="2-2-8-device-type"><a href="#2-2-8-device-type" class="headerlink" title="2.2.8Â device_type"></a><font size=3>2.2.8Â device_type</font></h4><p>device_type å±æ€§å€¼ä¸ºå­—ç¬¦ä¸²ï¼Œ IEEE 1275 ä¼šç”¨åˆ°æ­¤å±æ€§ï¼Œç”¨äºæè¿°è®¾å¤‡çš„ FCodeï¼Œä½†æ˜¯è®¾å¤‡æ ‘æ²¡æœ‰ FCodeï¼Œæ‰€ä»¥æ­¤å±æ€§ä¹Ÿè¢«æŠ›å¼ƒäº†ã€‚æ­¤å±æ€§åªèƒ½ç”¨äº cpu èŠ‚ç‚¹æˆ–è€… memory èŠ‚ç‚¹ã€‚imx6ull.dtsi çš„ cpu0 èŠ‚ç‚¹ç”¨åˆ°äº†æ­¤å±æ€§ï¼Œå†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cpu0: cpu@<span class="number">0</span> &#123;</span><br><span class="line">	compatible = <span class="string">&quot;arm,cortex-a7&quot;</span>;</span><br><span class="line">	device_type = <span class="string">&quot;cpu&quot;</span>;</span><br><span class="line">	reg = &lt;<span class="number">0</span>&gt;;</span><br><span class="line">	<span class="comment">// ......</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>device_type èŠ‚ç‚¹çš„å­˜åœ¨æœ‰åŠ©äºæ“ä½œç³»ç»Ÿæˆ–å…¶ä»–è½¯ä»¶è¯†åˆ«å’Œå¤„ç†è®¾å¤‡ã€‚ å®ƒæä¾›äº†è®¾å¤‡çš„åŸºæœ¬åˆ†ç±»ä¿¡æ¯ï¼Œ ä½¿å¾—é©±åŠ¨ç¨‹åºã€ è®¾å¤‡æ ‘è§£æå™¨æˆ–å…¶ä»–ç³»ç»Ÿç»„ä»¶èƒ½å¤Ÿæ ¹æ®è®¾å¤‡çš„ç±»å‹æ‰§è¡Œç›¸åº”çš„æ“ä½œã€‚å¸¸è§çš„è®¾å¤‡ç±»å‹åŒ…æ‹¬ä½†ä¸é™äºï¼š</p>
<p>ï¼ˆ1ï¼‰ cpuï¼š è¡¨ç¤ºä¸­å¤®å¤„ç†å™¨ã€‚</p>
<p>ï¼ˆ2ï¼‰ memoryï¼š è¡¨ç¤ºå†…å­˜è®¾å¤‡ã€‚</p>
<p>ï¼ˆ3ï¼‰ displayï¼š è¡¨ç¤ºæ˜¾ç¤ºè®¾å¤‡ï¼Œ å¦‚æ¶²æ™¶æ˜¾ç¤ºå±ã€‚</p>
<p>ï¼ˆ4ï¼‰ serialï¼š è¡¨ç¤ºä¸²è¡Œé€šä¿¡è®¾å¤‡ï¼Œ å¦‚ä¸²å£ã€‚</p>
<p>ï¼ˆ5ï¼‰ ethernetï¼š è¡¨ç¤ºä»¥å¤ªç½‘è®¾å¤‡ã€‚</p>
<p>ï¼ˆ6ï¼‰ usbï¼š è¡¨ç¤ºé€šç”¨ä¸²è¡Œæ€»çº¿è®¾å¤‡ã€‚</p>
<p>ï¼ˆ7ï¼‰ i2cï¼š è¡¨ç¤ºä½¿ç”¨ I2C (Inter-Integrated Circuit) æ€»çº¿é€šä¿¡çš„è®¾å¤‡ã€‚</p>
<p>ï¼ˆ8ï¼‰ spiï¼š è¡¨ç¤ºä½¿ç”¨ SPI (Serial Peripheral Interface) æ€»çº¿é€šä¿¡çš„è®¾å¤‡ã€‚</p>
<p>ï¼ˆ9ï¼‰ gpioï¼š è¡¨ç¤ºé€šç”¨è¾“å…¥&#x2F;è¾“å‡ºè®¾å¤‡ã€‚</p>
<p>ï¼ˆ10ï¼‰ pwmï¼š è¡¨ç¤ºè„‰å®½è°ƒåˆ¶è®¾å¤‡ã€‚</p>
<p>è¿™äº›åªæ˜¯ä¸€äº›å¸¸è§çš„è®¾å¤‡ç±»å‹ç¤ºä¾‹ï¼Œ å®é™…ä¸Šï¼Œ è®¾å¤‡ç±»å‹å¯ä»¥æ ¹æ®å…·ä½“çš„ç¡¬ä»¶å’Œè®¾å¤‡æ ‘çš„ä½¿ç”¨æƒ…å†µè¿›è¡Œè‡ªå®šä¹‰å’Œæ‰©å±•ã€‚ æ ¹æ®è®¾å¤‡ç±»å‹ï¼Œ æ“ä½œç³»ç»Ÿæˆ–å…¶ä»–è½¯ä»¶å¯ä»¥åŠ è½½é€‚å½“çš„é©±åŠ¨ç¨‹åºã€ é…ç½®è®¾å¤‡èµ„æºã€ å»ºç«‹è®¾å¤‡ä¹‹é—´çš„è¿æ¥ç­‰ã€‚  </p>
<h4 id="2-2-9-è‡ªå®šä¹‰å±æ€§"><a href="#2-2-9-è‡ªå®šä¹‰å±æ€§" class="headerlink" title="2.2.9 è‡ªå®šä¹‰å±æ€§"></a><font size=3>2.2.9 è‡ªå®šä¹‰å±æ€§</font></h4><p>è®¾å¤‡æ ‘ä¸­çš„è‡ªå®šä¹‰å±æ€§æ˜¯ç”¨æˆ·æ ¹æ®ç‰¹å®šéœ€æ±‚æ·»åŠ çš„å±æ€§ã€‚ è¿™äº›å±æ€§å¯ä»¥ç”¨äºæä¾›é¢å¤–çš„ä¿¡æ¯ã€ é…ç½®å‚æ•°æˆ–å…ƒæ•°æ®ï¼Œ ä»¥æ»¡è¶³è®¾å¤‡æˆ–ç³»ç»Ÿçš„ç‰¹å®šè¦æ±‚ã€‚  </p>
<p>åœ¨è®¾å¤‡æ ‘ä¸­æ·»åŠ è‡ªå®šä¹‰å±æ€§æ—¶ï¼Œ å¯ä»¥åœ¨è®¾å¤‡èŠ‚ç‚¹æˆ–å…¶ä»–é€‚å½“çš„èŠ‚ç‚¹ä¸‹å®šä¹‰æ–°çš„å±æ€§ã€‚ è‡ªå®šä¹‰å±æ€§å¯ä»¥æ˜¯æ•´æ•°ã€ å­—ç¬¦ä¸²ã€ å¸ƒå°”å€¼æˆ–å…¶ä»–æ•°æ®ç±»å‹ã€‚ å®ƒä»¬çš„å‘½ååº”éµå¾ªè®¾å¤‡æ ‘çš„å‘½åçº¦å®šï¼Œå¹¶ä¸”åº”è¯¥ä¸å·²æœ‰çš„å±æ€§åç§°é¿å…å†²çªã€‚  </p>
<p>ä¾‹å¦‚å¯ä»¥åœ¨è®¾å¤‡æ ‘ä¸­è‡ªå®šä¹‰ä¸€ä¸ªç®¡è„šæ ‡å·çš„å±æ€§ pinnumï¼Œ æ·»åŠ å¥½çš„è®¾å¤‡æ ‘æºç å¦‚ä¸‹æ‰€ç¤º  ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">my_device &#123;</span><br><span class="line">    compatible = <span class="string">&quot;my_device&quot;</span>;</span><br><span class="line">    pinnum = &lt;<span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span>&gt;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>åœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œ my_device æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰è®¾å¤‡èŠ‚ç‚¹ï¼Œ å¹¶æ·»åŠ äº†ä¸€ä¸ªè‡ªå®šä¹‰å±æ€§ pinnumã€‚ è¯¥å±æ€§çš„å€¼ &lt;0 1 2 3 4&gt; æ˜¯ä¸€ä¸ªæ•´æ•°æ•°ç»„ï¼Œ è¡¨ç¤ºç®¡è„šçš„æ ‡å·ï¼ˆ PIN numberï¼‰ ã€‚  </p>
<p>é€šè¿‡è¿™æ ·å®šä¹‰ pinnum å±æ€§ï¼Œ å¯ä»¥åœ¨è®¾å¤‡æ ‘ä¸­ä¸ºç‰¹å®šè®¾å¤‡æŒ‡å®šç®¡æ•™æ ‡å·ï¼Œ ä»¥ä¾¿æ“ä½œç³»ç»Ÿã€é©±åŠ¨ç¨‹åºæˆ–å…¶ä»–è½¯ä»¶ç»„ä»¶ä½¿ç”¨ã€‚ è¿™å¯ä»¥ç”¨äºåœ¨è®¾å¤‡åˆå§‹åŒ–æˆ–é…ç½®è¿‡ç¨‹ä¸­å¯¹ç‰¹å®šç®¡æ•™è¿›è¡Œæ“ä½œæˆ–æ§åˆ¶ã€‚  </p>
<h3 id="2-3-ä¿®æ”¹èŠ‚ç‚¹"><a href="#2-3-ä¿®æ”¹èŠ‚ç‚¹" class="headerlink" title="2.3 ä¿®æ”¹èŠ‚ç‚¹"></a><font size=3>2.3 ä¿®æ”¹èŠ‚ç‚¹</font></h3><h4 id="2-3-1-ä¿®æ”¹æ–¹å¼"><a href="#2-3-1-ä¿®æ”¹æ–¹å¼" class="headerlink" title="2.3.1 ä¿®æ”¹æ–¹å¼"></a><font size=3>2.3.1 ä¿®æ”¹æ–¹å¼</font></h4><p>äº§å“å¼€å‘è¿‡ç¨‹ä¸­å¯èƒ½é¢ä¸´ç€é¢‘ç¹çš„éœ€æ±‚æ›´æ”¹ï¼Œè®¾å¤‡æ ‘èŠ‚ç‚¹å¯èƒ½ä¹Ÿéœ€è¦è¿›è¡Œä¿®æ”¹ï¼Œå¯ä»¥æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨æ ¹èŠ‚ç‚¹ä¹‹å¤–ä½¿ç”¨ label å¼•ç”¨ nodeï¼š</span></span><br><span class="line">&amp;uart0 &#123;</span><br><span class="line">	status = â€œdisabledâ€;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æˆ–åœ¨æ ¹èŠ‚ç‚¹ä¹‹å¤–ä½¿ç”¨å…¨è·¯å¾„ï¼š</span></span><br><span class="line">&amp;&#123;/uart@fe001000&#125; &#123;</span><br><span class="line">	status = â€œdisabledâ€;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-3-2-ä¿®æ”¹å®ä¾‹"><a href="#2-3-2-ä¿®æ”¹å®ä¾‹" class="headerlink" title="2.3.2 ä¿®æ”¹å®ä¾‹"></a><font size=3>2.3.2 ä¿®æ”¹å®ä¾‹</font></h4><p>æ¯”å¦‚ç¬¬ä¸€ç‰ˆç¡¬ä»¶ä¸Šæœ‰ä¸€ä¸ª IIC æ¥å£çš„å…­è½´èŠ¯ç‰‡ MPU6050ï¼Œç¬¬äºŒç‰ˆç¡¬ä»¶åˆè¦æŠŠè¿™ä¸ª MPU6050 æ›´æ¢ä¸º MPU9250 ç­‰ã€‚ä¸€æ—¦ç¡¬ä»¶ä¿®æ”¹äº†ï¼Œæˆ‘ä»¬å°±è¦åŒæ­¥çš„ä¿®æ”¹è®¾å¤‡æ ‘æ–‡ä»¶ï¼Œæ¯•ç«Ÿè®¾å¤‡æ ‘æ˜¯æè¿°æ¿å­ç¡¬ä»¶ä¿¡æ¯çš„æ–‡ä»¶ã€‚å‡è®¾ç°åœ¨æœ‰ä¸ªå…­è½´èŠ¯ç‰‡fxls8471ï¼Œ fxls8471 è¦æ¥åˆ° I.MX6U-ALPHA å¼€å‘æ¿çš„ I2C1 æ¥å£ä¸Šï¼Œé‚£ä¹ˆç›¸å½“äºéœ€è¦åœ¨ i2c1 è¿™ä¸ªèŠ‚ç‚¹ä¸Šæ·»åŠ ä¸€ä¸ª fxls8471 å­èŠ‚ç‚¹ã€‚  å…ˆçœ‹ä¸€ä¸‹ I2C1 æ¥å£å¯¹åº”çš„èŠ‚ç‚¹ï¼Œæ‰“å¼€æ–‡ä»¶ <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/v4.19.71/source/arch/arm/boot/dts/imx6ul.dtsi#L886">imx6ul.dtsi</a> æ–‡ä»¶ï¼Œæ‰¾åˆ°å¦‚ä¸‹æ‰€ç¤ºå†…å®¹ï¼š  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">i2c1: i2c@<span class="number">21</span>a0000 &#123;</span><br><span class="line">    <span class="meta">#address-cells = <span class="string">&lt;1&gt;</span>;</span></span><br><span class="line">    <span class="meta">#size-cells = <span class="string">&lt;0&gt;</span>;</span></span><br><span class="line">    compatible = <span class="string">&quot;fsl,imx6ul-i2c&quot;</span>, <span class="string">&quot;fsl,imx21-i2c&quot;</span>;</span><br><span class="line">    reg = &lt;<span class="number">0x021a0000</span> <span class="number">0x4000</span>&gt;;</span><br><span class="line">    interrupts = &lt;GIC_SPI <span class="number">36</span> IRQ_TYPE_LEVEL_HIGH&gt;;</span><br><span class="line">    clocks = &lt;&amp;clks IMX6UL_CLK_I2C1&gt;;</span><br><span class="line">    status = <span class="string">&quot;disabled&quot;</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªå°±æ˜¯ I.MX6ULL çš„ I2C1 èŠ‚ç‚¹ï¼Œç°åœ¨è¦åœ¨ i2c1 èŠ‚ç‚¹ä¸‹åˆ›å»ºä¸€ä¸ªå­èŠ‚ç‚¹ï¼Œè¿™ä¸ªå­èŠ‚ç‚¹å°±æ˜¯ fxls8471ï¼Œæœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯åœ¨ i2c1 ä¸‹ç›´æ¥æ·»åŠ ä¸€ä¸ªåä¸º fxls8471 çš„å­èŠ‚ç‚¹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">i2c1: i2c@<span class="number">21</span>a0000 &#123;</span><br><span class="line">    <span class="meta">#address-cells = <span class="string">&lt;1&gt;</span>;</span></span><br><span class="line">    <span class="meta">#size-cells = <span class="string">&lt;0&gt;</span>;</span></span><br><span class="line">    compatible = <span class="string">&quot;fsl,imx6ul-i2c&quot;</span>, <span class="string">&quot;fsl,imx21-i2c&quot;</span>;</span><br><span class="line">    reg = &lt;<span class="number">0x021a0000</span> <span class="number">0x4000</span>&gt;;</span><br><span class="line">    interrupts = &lt;GIC_SPI <span class="number">36</span> IRQ_TYPE_LEVEL_HIGH&gt;;</span><br><span class="line">    clocks = &lt;&amp;clks IMX6UL_CLK_I2C1&gt;;</span><br><span class="line">    status = <span class="string">&quot;disabled&quot;</span>;</span><br><span class="line">    <span class="comment">//fxls8471 å­èŠ‚ç‚¹</span></span><br><span class="line">    fxls8471@<span class="number">1</span>e &#123;</span><br><span class="line">        compatible = <span class="string">&quot;fsl,fxls8471&quot;</span>;</span><br><span class="line">        reg = &lt;<span class="number">0x1e</span>&gt;;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>ç¬¬ 10 ~ 12 è¡Œå°±æ˜¯æ·»åŠ çš„ fxls8471 è¿™ä¸ªèŠ¯ç‰‡å¯¹åº”çš„å­èŠ‚ç‚¹ã€‚ä½†æ˜¯è¿™æ ·ä¼šæœ‰ä¸ªé—®é¢˜ï¼ i2c1 èŠ‚ç‚¹æ˜¯å®šä¹‰åœ¨  <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/v4.19.71/source/arch/arm/boot/dts/imx6ul.dtsi#L886">imx6ul.dtsi</a> æ–‡ä»¶ä¸­çš„ï¼Œè€Œ <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/v4.19.71/source/arch/arm/boot/dts/imx6ul.dtsi#L886">imx6ul.dtsi</a> æ˜¯è®¾å¤‡æ ‘å¤´æ–‡ä»¶ï¼Œå…¶ä»–æ‰€æœ‰ä½¿ç”¨åˆ° I.MX6ULLè¿™é¢— SOC çš„æ¿å­éƒ½ä¼šå¼•ç”¨  <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/v4.19.71/source/arch/arm/boot/dts/imx6ul.dtsi#L886">imx6ul.dtsi</a> è¿™ä¸ªæ–‡ä»¶ã€‚ç›´æ¥åœ¨ i2c1 èŠ‚ç‚¹ä¸­æ·»åŠ  fxls8471 å°±ç›¸å½“äºåœ¨å…¶ä»–çš„æ‰€æœ‰æ¿å­ä¸Šéƒ½æ·»åŠ äº† fxls8471 è¿™ä¸ªè®¾å¤‡ï¼Œä½†æ˜¯å…¶ä»–çš„æ¿å­å¹¶æ²¡æœ‰è¿™ä¸ªè®¾å¤‡ï¼å› æ­¤ï¼ŒæŒ‰ç…§ä¸Šé¢è¿™æ ·å†™è‚¯å®šæ˜¯ä¸è¡Œçš„ã€‚  </p>
<p>è¿™é‡Œå°±è¦å¼•å…¥å¦å¤–ä¸€ä¸ªå†…å®¹ï¼Œé‚£å°±æ˜¯å¦‚ä½•å‘èŠ‚ç‚¹è¿½åŠ æ•°æ®ï¼Œæˆ‘ä»¬ç°åœ¨è¦è§£å†³çš„å°±æ˜¯å¦‚ä½•å‘i2c1 èŠ‚ç‚¹è¿½åŠ ä¸€ä¸ªåä¸º fxls8471 çš„å­èŠ‚ç‚¹ï¼Œè€Œä¸”ä¸èƒ½å½±å“åˆ°å…¶ä»–ä½¿ç”¨åˆ° I.MX6ULL çš„æ¿å­ã€‚I.MX6U-ALPHA å¼€å‘æ¿ä½¿ç”¨çš„è®¾å¤‡æ ‘æ–‡ä»¶ä¸º imx6ull-alpha-emmc.dtsï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åœ¨imx6ull-alpha-emmc.dts æ–‡ä»¶ä¸­å®Œæˆæ•°æ®è¿½åŠ çš„å†…å®¹ï¼Œæ–¹å¼å¦‚ä¸‹:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&amp;i2c1 &#123;</span><br><span class="line">	<span class="comment">/* è¦è¿½åŠ æˆ–ä¿®æ”¹çš„å†…å®¹ */</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>&amp;i2c1 è¡¨ç¤ºè¦è®¿é—® i2c1 è¿™ä¸ª label æ‰€å¯¹åº”çš„èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯ <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/v4.19.71/source/arch/arm/boot/dts/imx6ul.dtsi#L886">imx6ul.dtsi</a> ä¸­çš„â€œi2c1: i2c@021a0000â€ã€‚èŠ±æ‹¬å·å†…å°±æ˜¯è¦å‘ i2c1 è¿™ä¸ªèŠ‚ç‚¹æ·»åŠ çš„å†…å®¹ï¼ŒåŒ…æ‹¬ä¿®æ”¹æŸäº›å±æ€§çš„å€¼ã€‚  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&amp;i2c1 &#123;</span><br><span class="line">	clock-frequency = &lt;<span class="number">100000</span>&gt;;</span><br><span class="line">	pinctrl-names = <span class="string">&quot;default&quot;</span>;</span><br><span class="line">	pinctrl<span class="number">-0</span> = &lt;&amp;pinctrl_i2c1&gt;;</span><br><span class="line">	status = <span class="string">&quot;okay&quot;</span>;</span><br><span class="line">	<span class="comment">//fxls8471 å­èŠ‚ç‚¹</span></span><br><span class="line">	fxls8471@<span class="number">1</span>e &#123;</span><br><span class="line">		compatible = <span class="string">&quot;fsl,fxls8471&quot;</span>;</span><br><span class="line">		reg = &lt;<span class="number">0x1e</span>&gt;;</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>å› ä¸ºç¤ºä¾‹ä»£ç ä¸­çš„å†…å®¹æ˜¯ imx6ull-alpha-emmc.dts è¿™ä¸ªæ–‡ä»¶å†…çš„ï¼Œæ‰€ä»¥ä¸ä¼šå¯¹ä½¿ç”¨ I.MX6ULL è¿™é¢— SOC çš„å…¶ä»–æ¿å­é€ æˆä»»ä½•å½±å“ã€‚è¿™ä¸ªå°±æ˜¯å‘èŠ‚ç‚¹è¿½åŠ æˆ–ä¿®æ”¹å†…å®¹ï¼Œé‡ç‚¹å°±æ˜¯é€šè¿‡&amp;label æ¥è®¿é—®èŠ‚ç‚¹ï¼Œç„¶åç›´æ¥åœ¨é‡Œé¢ç¼–å†™è¦è¿½åŠ æˆ–è€…ä¿®æ”¹çš„å†…å®¹ã€‚  </p>
<h2 id="3-ç‰¹æ®ŠèŠ‚ç‚¹"><a href="#3-ç‰¹æ®ŠèŠ‚ç‚¹" class="headerlink" title="3. ç‰¹æ®ŠèŠ‚ç‚¹"></a><font size=3>3. ç‰¹æ®ŠèŠ‚ç‚¹</font></h2><h3 id="3-1-æ ¹èŠ‚ç‚¹"><a href="#3-1-æ ¹èŠ‚ç‚¹" class="headerlink" title="3.1 æ ¹èŠ‚ç‚¹"></a><font size=3>3.1 æ ¹èŠ‚ç‚¹</font></h3><p>dts æ–‡ä»¶ä¸­å¿…é¡»æœ‰ä¸€ä¸ªæ ¹èŠ‚ç‚¹ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/dts-v1/;</span><br><span class="line">/ &#123;</span><br><span class="line">    model = <span class="string">&quot;SMDK24440&quot;</span>;</span><br><span class="line">    compatible = <span class="string">&quot;samsung,smdk2440&quot;</span>;</span><br><span class="line">    <span class="meta">#address-cells = <span class="string">&lt;1&gt;</span>;</span></span><br><span class="line">    <span class="meta">#size-cells = <span class="string">&lt;1&gt;</span>;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ ¹èŠ‚ç‚¹ä¸­è‡³å°‘åº”è¯¥æœ‰è¿™äº›å±æ€§:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">compatible  <span class="comment">// å®šä¹‰ä¸€ç³»åˆ—çš„å­—ç¬¦ä¸², ç”¨æ¥æŒ‡å®šå†…æ ¸ä¸­å“ªä¸ª machine_desc å¯ä»¥æ”¯æŒæœ¬è®¾å¤‡</span></span><br><span class="line">			<span class="comment">// å³è¿™ä¸ªæ¿å­å…¼å®¹å“ªäº›å¹³å°</span></span><br><span class="line">			<span class="comment">// uImage : smdk2410 smdk2440 mini2440 ==&gt; machine_desc</span></span><br><span class="line">model       <span class="comment">// è¿™ä¸ªæ¿å­æ˜¯ä»€ä¹ˆ</span></span><br><span class="line">			<span class="comment">// æ¯”å¦‚æœ‰ 2 æ¬¾æ¿å­é…ç½®åŸºæœ¬ä¸€è‡´, å®ƒä»¬çš„ compatible æ˜¯ä¸€æ ·çš„</span></span><br><span class="line">			<span class="comment">// é‚£ä¹ˆå°±é€šè¿‡ model æ¥åˆ†è¾¨è¿™ 2 æ¬¾æ¿å­</span></span><br></pre></td></tr></table></figure>

<h3 id="3-2-CPU-èŠ‚ç‚¹"><a href="#3-2-CPU-èŠ‚ç‚¹" class="headerlink" title="3.2Â CPU èŠ‚ç‚¹  "></a><font size=3>3.2Â CPU èŠ‚ç‚¹  </font></h3><p>ä¸€èˆ¬ä¸éœ€è¦æˆ‘ä»¬è®¾ç½®ï¼Œåœ¨ dtsi æ–‡ä»¶ä¸­éƒ½å®šä¹‰å¥½äº†ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cpus &#123;</span><br><span class="line">    <span class="meta">#address-cells = <span class="string">&lt;1&gt;</span>;</span></span><br><span class="line">    <span class="meta">#size-cells = <span class="string">&lt;0&gt;</span>;</span></span><br><span class="line">    cpu0: cpu@<span class="number">0</span> &#123;</span><br><span class="line">    	<span class="comment">// .......</span></span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="3-3-memory-èŠ‚ç‚¹"><a href="#3-3-memory-èŠ‚ç‚¹" class="headerlink" title="3.3Â memory èŠ‚ç‚¹  "></a><font size=3>3.3Â memory èŠ‚ç‚¹  </font></h3><p>èŠ¯ç‰‡å‚å®¶ä¸å¯èƒ½äº‹å…ˆç¡®å®šæˆ‘ä»¬çš„æ¿å­ä½¿ç”¨å¤šå¤§çš„å†…å­˜ï¼Œæ‰€ä»¥ memory èŠ‚ç‚¹éœ€è¦æ¿å‚è®¾ç½®ï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">memory &#123;</span><br><span class="line">	reg = &lt;<span class="number">0x80000000</span> <span class="number">0x20000000</span>&gt;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="3-4-chosen-èŠ‚ç‚¹"><a href="#3-4-chosen-èŠ‚ç‚¹" class="headerlink" title="3.4Â chosen èŠ‚ç‚¹  "></a><font size=3>3.4Â chosen èŠ‚ç‚¹  </font></h3><h4 id="3-4-1-èŠ‚ç‚¹è¯´æ˜"><a href="#3-4-1-èŠ‚ç‚¹è¯´æ˜" class="headerlink" title="3.4.1 èŠ‚ç‚¹è¯´æ˜"></a><font size=3>3.4.1 èŠ‚ç‚¹è¯´æ˜</font></h4><p>chosen å¹¶ä¸æ˜¯ä¸€ä¸ªçœŸå®çš„è®¾å¤‡ï¼Œ chosen èŠ‚ç‚¹ä¸»è¦æ˜¯ä¸ºäº† uboot å‘ Linux å†…æ ¸ä¼ é€’æ•°æ®ï¼Œé‡ç‚¹æ˜¯ bootargs å‚æ•°ã€‚å®ƒä½äºè®¾å¤‡æ ‘çš„æ ¹éƒ¨ï¼Œ å¹¶å…·æœ‰è·¯å¾„&#x2F;chosenã€‚    </p>
<p>chosen èŠ‚ç‚¹é€šå¸¸åŒ…å«ä»¥ä¸‹å­èŠ‚ç‚¹å’Œå±æ€§ï¼š</p>
<p>ï¼ˆ1ï¼‰ bootargsï¼š ç”¨äºå­˜å‚¨å¼•å¯¼å†…æ ¸æ—¶ä¼ é€’çš„å‘½ä»¤è¡Œå‚æ•°ã€‚ å®ƒå¯ä»¥åŒ…å«è¯¸å¦‚å†…æ ¸å‚æ•°ã€ è®¾å¤‡æ ‘å‚æ•°ç­‰ä¿¡æ¯ã€‚ åœ¨å¼•å¯¼è¿‡ç¨‹ä¸­ï¼Œ æ“ä½œç³»ç»Ÿæˆ–å¼•å¯¼åŠ è½½ç¨‹åºå¯ä»¥è¯»å–è¯¥å±æ€§æ¥è·å–å¯åŠ¨å‚æ•°ã€‚</p>
<p>ï¼ˆ2ï¼‰ stdout-pathï¼š ç”¨äºæŒ‡å®šç”¨äºæ ‡å‡†è¾“å‡ºçš„è®¾å¤‡è·¯å¾„ã€‚ åœ¨å¼•å¯¼è¿‡ç¨‹ä¸­ï¼Œ æ“ä½œç³»ç»Ÿå¯ä»¥ä½¿ç”¨è¯¥å±æ€§æ¥ç¡®å®šå°†æ§åˆ¶å°è¾“å‡ºå‘é€åˆ°å“ªä¸ªè®¾å¤‡ï¼Œ ä¾‹å¦‚ä¸²å£æˆ–æ˜¾ç¤ºå±ã€‚</p>
<p>ï¼ˆ 3ï¼‰ firmware-nameï¼š ç”¨äºæŒ‡å®šç³»ç»Ÿå›ºä»¶çš„åç§°ã€‚ å®ƒå¯ä»¥ç”¨äºæ ‡è¯†æ‰€ä½¿ç”¨çš„å¼•å¯¼åŠ è½½ç¨‹åºæˆ–å›ºä»¶çš„ç±»å‹å’Œç‰ˆæœ¬ã€‚</p>
<p>ï¼ˆ 4ï¼‰ linux,initrd-start å’Œ linux,initrd-endï¼š è¿™äº›å±æ€§ç”¨äºæŒ‡å®š Linux å†…æ ¸åˆå§‹åŒ– RAM ç£ç›˜ï¼ˆ initrdï¼‰ çš„èµ·å§‹åœ°å€å’Œç»“æŸåœ°å€ã€‚ è¿™äº›ä¿¡æ¯åœ¨å¼•å¯¼è¿‡ç¨‹ä¸­è¢«å¼•å¯¼åŠ è½½ç¨‹åºä½¿ç”¨ï¼Œ ä»¥å°† initrd åŠ è½½åˆ°å†…å­˜ä¸­ä¾›å†…æ ¸ä½¿ç”¨ã€‚</p>
<p>ï¼ˆ 5ï¼‰ å…¶ä»–è‡ªå®šä¹‰å±æ€§ï¼š chosen èŠ‚ç‚¹è¿˜å¯ä»¥åŒ…å«å…¶ä»–è‡ªå®šä¹‰å±æ€§ï¼Œ ç”¨äºå­˜å‚¨ç‰¹å®šäºç³»ç»Ÿå¼•å¯¼å’Œé…ç½®çš„ä¿¡æ¯ã€‚ è¿™äº›å±æ€§çš„å…·ä½“å«ä¹‰å’Œç”¨æ³•å–å†³äºè®¾å¤‡æ ‘çš„ä½¿ç”¨å’Œä¸Šä¸‹æ–‡ã€‚</p>
<p>é€šè¿‡ä½¿ç”¨ chosen èŠ‚ç‚¹ï¼Œ ç³»ç»Ÿå¼•å¯¼è¿‡ç¨‹ä¸­çš„ç›¸å…³ä¿¡æ¯å¯ä»¥æ–¹ä¾¿åœ°ä¼ é€’ç»™æ“ä½œç³»ç»Ÿæˆ–å¼•å¯¼åŠ è½½ç¨‹åºã€‚ è¿™æ ·ï¼Œ ç³»ç»Ÿå¼•å¯¼å’Œé…ç½®çš„å„ä¸ªç»„ä»¶å¯ä»¥å…±äº«å’Œè®¿é—®è¿™äº›ä¿¡æ¯ï¼Œ ä»è€Œå®ç°æ›´çµæ´»å’Œå¯é…ç½®çš„ç³»ç»Ÿå¼•å¯¼æµç¨‹ã€‚ chosen èŠ‚ç‚¹æä¾›äº†ä¸€ç§é€šç”¨çš„æœºåˆ¶ï¼Œ ä½¿å¾—ä¸åŒçš„è®¾å¤‡æ ‘å’Œå¼•å¯¼ç³»ç»Ÿå¯ä»¥åœ¨ä¼ é€’ä¿¡æ¯æ–¹é¢ä¿æŒä¸€è‡´æ€§ï¼Œ å¹¶ä¸”å¯ä»¥æ ¹æ®å…·ä½“éœ€æ±‚æ‰©å±•å’Œè‡ªå®šä¹‰ã€‚  </p>
<h4 id="3-4-2-èŠ‚ç‚¹ç¤ºä¾‹"><a href="#3-4-2-èŠ‚ç‚¹ç¤ºä¾‹" class="headerlink" title="3.4.2 èŠ‚ç‚¹ç¤ºä¾‹"></a><font size=3>3.4.2 èŠ‚ç‚¹ç¤ºä¾‹</font></h4><p>å…³äº chosen èŠ‚ç‚¹çš„å®é™…ä¾‹å­å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">chosen &#123;</span><br><span class="line">        bootargs=<span class="string">&quot;quiet initcall_debug=y earlycon console=ttyS0,115200&quot;</span>;</span><br><span class="line">        <span class="built_in">stdout</span>-path = &amp;uart0;</span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹chosenèŠ‚ç‚¹ä¸­bootargsçš„å€¼ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/device-tree/chosen/bootargs</span><br></pre></td></tr></table></figure>

<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250218185719092.png" alt="image-20250218185719092"  />

<p>ä½†æ˜¯æœ‰ä¸€äº›chosenèŠ‚ç‚¹æ˜¯è¿™æ ·çš„ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹ <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/v4.19.71/source/arch/arm/boot/dts/imx6ul-14x14-evk.dtsi#L10">imx6ul-14x14-evk.dtsi</a>ï¼Œåœ¨ä¸€å¼€å§‹çš„æ—¶å€™ï¼Œè¿™ä¸ªè¯„ä¼°æ¿é»˜è®¤çš„è®¾å¤‡æ ‘ä¸­è¿™ä¸ªèŠ‚ç‚¹æ˜¯è¿™æ ·çš„ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chosen &#123;</span><br><span class="line">    <span class="built_in">stdout</span>-path = &amp;uart1;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹å‡ºï¼Œ chosen èŠ‚ç‚¹ä»…ä»…è®¾ç½®äº†å±æ€§â€œstdout-pathâ€ï¼Œè¡¨ç¤ºæ ‡å‡†è¾“å‡ºä½¿ç”¨ uart1ã€‚ä½†æ˜¯å½“æˆ‘ä»¬è¿›å…¥åˆ°&#x2F;proc&#x2F;device-tree&#x2F;chosen ç›®å½•é‡Œé¢ï¼Œä¼šå‘ç°å¤šäº† bootargs è¿™ä¸ªå±æ€§ï¼Œè¾“å…¥ cat å‘½ä»¤æŸ¥çœ‹ bootargs è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹ï¼Œç»“æœå¦‚å›¾:</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250309151938826.png"  />

<h4 id="3-4-3-å‚æ•°çš„ä¼ é€’"><a href="#3-4-3-å‚æ•°çš„ä¼ é€’" class="headerlink" title="3.4.3 å‚æ•°çš„ä¼ é€’"></a><font size=3>3.4.3 å‚æ•°çš„ä¼ é€’</font></h4><p>ä¸Šé¢imx6ullçš„ä¾‹å­ä¸­ï¼Œbootargs è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹ä¸ºâ€œconsole&#x3D;ttymxc0,115200â€¦â€¦â€ï¼Œä»”ç»†ä¸€çœ‹ï¼Œè¿™ä¸ªä¸å°±æ˜¯æˆ‘ä»¬åœ¨ uboot ä¸­è®¾ç½®çš„ bootargs ç¯å¢ƒå˜é‡çš„å€¼å—ï¼Ÿ</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250309152429056.png" alt="image-20250309152429056" />

<p>æ ¹æ®è®¾å¤‡æ ‘çš„chosenèŠ‚ç‚¹æƒ…å†µï¼Œç°åœ¨æœ‰ä¸¤ä¸ªç–‘ç‚¹ ï¼š</p>
<p>ï¼ˆ1ï¼‰æˆ‘ä»¬å¹¶æ²¡æœ‰åœ¨è®¾å¤‡æ ‘ä¸­è®¾ç½® chosen èŠ‚ç‚¹çš„ bootargs å±æ€§ï¼Œé‚£ä¹ˆå›¾ 43.6.2.1 ä¸­ bootargsè¿™ä¸ªå±æ€§æ˜¯æ€ä¹ˆäº§ç”Ÿçš„ï¼Ÿ</p>
<p>ï¼ˆ2ï¼‰ä¸ºä½• bootargs æ–‡ä»¶çš„å†…å®¹å’Œ uboot ä¸­ bootargs ç¯å¢ƒå˜é‡çš„å€¼ä¸€æ ·ï¼Ÿå®ƒä»¬ä¹‹é—´æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ</p>
<p>å‰é¢å­¦ä¹  uboot çš„æ—¶å€™åº”è¯¥æœ‰äº†è§£è¿‡ï¼Œ uboot åœ¨å¯åŠ¨ Linux å†…æ ¸çš„æ—¶å€™ä¼šå°† bootargs çš„å€¼ä¼ é€’ç»™ Linuxå†…æ ¸ï¼Œ bootargs ä¼šä½œä¸º Linux å†…æ ¸çš„å‘½ä»¤è¡Œå‚æ•°ï¼Œ Linux å†…æ ¸å¯åŠ¨çš„æ—¶å€™ä¼šæ‰“å°å‡ºå‘½ä»¤è¡Œå‚æ•°(ä¹Ÿå°±æ˜¯ uboot ä¼ é€’è¿›æ¥çš„ bootargs çš„å€¼)ï¼Œå¦‚å›¾ï¼š</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250309152522796.png" alt="image-20250309152522796" />

<p>æ—¢ç„¶ chosen èŠ‚ç‚¹çš„ bootargs å±æ€§ä¸æ˜¯æˆ‘ä»¬åœ¨è®¾å¤‡æ ‘é‡Œé¢è®¾ç½®çš„ï¼Œé‚£ä¹ˆåªæœ‰ä¸€ç§å¯èƒ½ï¼Œé‚£å°±æ˜¯ uboot è‡ªå·±åœ¨ chosen èŠ‚ç‚¹é‡Œé¢æ·»åŠ äº† bootargs å±æ€§ï¼å¹¶ä¸”è®¾ç½® bootargs å±æ€§çš„å€¼ä¸º bootargsç¯å¢ƒå˜é‡çš„å€¼ã€‚å› ä¸ºåœ¨å¯åŠ¨ Linux å†…æ ¸ä¹‹å‰ï¼Œåªæœ‰ uboot çŸ¥é“ bootargs ç¯å¢ƒå˜é‡çš„å€¼ï¼Œå¹¶ä¸” ubootä¹ŸçŸ¥é“.dtb è®¾å¤‡æ ‘æ–‡ä»¶åœ¨ DRAM ä¸­çš„ä½ç½®ã€‚åœ¨ uboot æºç ä¸­å…¨å±€æœç´¢â€œ chosenâ€è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œæœç„¶ä¸å‡ºæ‰€æ–™ï¼Œåœ¨<a target="_blank" rel="noopener" href="https://elixir.bootlin.com/u-boot/v2019.04/source/common/fdt_support.c#L274">fdt_support.c - common&#x2F;fdt_support.c</a> æ–‡ä»¶ä¸­å‘ç°äº†â€œchosenâ€çš„èº«å½±ï¼Œæ–‡ä»¶ä¸­æœ‰ä¸ª fdt_chosen å‡½æ•°ï¼Œæ­¤å‡½æ•°å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">fdt_chosen</span><span class="params">(<span class="type">void</span> *fdt)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span>   nodeoffset;</span><br><span class="line">	<span class="type">int</span>   err;</span><br><span class="line">	<span class="type">char</span>  *str;		<span class="comment">/* used to set string properties */</span></span><br><span class="line"></span><br><span class="line">	err = fdt_check_header(fdt);</span><br><span class="line">	<span class="keyword">if</span> (err &lt; <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;fdt_chosen: %s\n&quot;</span>, fdt_strerror(err));</span><br><span class="line">		<span class="keyword">return</span> err;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* find or create &quot;/chosen&quot; node. */</span></span><br><span class="line">	nodeoffset = fdt_find_or_add_subnode(fdt, <span class="number">0</span>, <span class="string">&quot;chosen&quot;</span>);</span><br><span class="line">	<span class="keyword">if</span> (nodeoffset &lt; <span class="number">0</span>)</span><br><span class="line">		<span class="keyword">return</span> nodeoffset;</span><br><span class="line"></span><br><span class="line">	str = env_get(<span class="string">&quot;bootargs&quot;</span>);</span><br><span class="line">	<span class="keyword">if</span> (str) &#123;</span><br><span class="line">		err = fdt_setprop(fdt, nodeoffset, <span class="string">&quot;bootargs&quot;</span>, str,</span><br><span class="line">				  <span class="built_in">strlen</span>(str) + <span class="number">1</span>);</span><br><span class="line">		<span class="keyword">if</span> (err &lt; <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;WARNING: could not set bootargs %s.\n&quot;</span>,</span><br><span class="line">			       fdt_strerror(err));</span><br><span class="line">			<span class="keyword">return</span> err;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> fdt_fixup_stdout(fdt, nodeoffset);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç¬¬ <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/u-boot/v2019.04/source/common/fdt_support.c#L287">287</a> è¡Œï¼Œè°ƒç”¨å‡½æ•° fdt_find_or_add_subnode ä»è®¾å¤‡æ ‘(.dtb)ä¸­æ‰¾åˆ° chosen èŠ‚ç‚¹ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°çš„è¯å°±ä¼šè‡ªå·±åˆ›å»ºä¸€ä¸ª chosen èŠ‚ç‚¹ã€‚</p>
<p>ç¬¬ <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/u-boot/v2019.04/source/common/fdt_support.c#L291">291</a> è¡Œï¼Œè¯»å– uboot ä¸­ bootargs ç¯å¢ƒå˜é‡çš„å†…å®¹ã€‚</p>
<p>ç¬¬ <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/u-boot/v2019.04/source/common/fdt_support.c#L293">293</a> è¡Œï¼Œè°ƒç”¨å‡½æ•° fdt_setprop å‘ chosen èŠ‚ç‚¹æ·»åŠ  bootargs å±æ€§ï¼Œå¹¶ä¸” bootargs å±æ€§çš„å€¼å°±æ˜¯ç¯å¢ƒå˜é‡ bootargs çš„å†…å®¹ã€‚</p>
<p>å°±æ˜¯ uboot ä¸­çš„ fdt_chosen å‡½æ•°åœ¨è®¾å¤‡æ ‘çš„ chosen èŠ‚ç‚¹ä¸­åŠ å…¥äº† bootargså±æ€§ï¼Œå¹¶ä¸”è¿˜è®¾ç½®äº† bootargs å±æ€§å€¼ã€‚fdt_chosen å‡½æ•°è°ƒç”¨æµç¨‹ å¦‚ä¸‹ï¼š</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250218191119287.png" alt="image-20250218191119287"  />

<p>æ¡†èµ·æ¥çš„éƒ¨åˆ†å°±æ˜¯å‡½æ•° <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/u-boot/v2019.04/source/arch/arm/lib/bootm.c#L412">do_bootm_linux()</a> å‡½æ•°çš„æ‰§è¡Œæµç¨‹ï¼Œä¹Ÿå°±æ˜¯è¯´ <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/u-boot/v2019.04/source/arch/arm/lib/bootm.c#L412">do_bootm_linux()</a> å‡½æ•°ä¼šé€šè¿‡ä¸€ç³»åˆ—å¤æ‚çš„è°ƒç”¨ï¼Œæœ€ç»ˆé€šè¿‡ <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/u-boot/v2019.04/source/common/fdt_support.c#L274">fdt_chosen()</a> å‡½æ•°åœ¨ chosen èŠ‚ç‚¹ä¸­åŠ å…¥äº† bootargs å±æ€§ã€‚è€Œæˆ‘ä»¬é€šè¿‡ bootz å‘½ä»¤å¯åŠ¨ Linux å†…æ ¸çš„æ—¶å€™ä¼šè¿è¡Œ <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/u-boot/v2019.04/source/arch/arm/lib/bootm.c#L412">do_bootm_linux()</a> å‡½æ•°ï¼Œè€Œè¿è¡Œåˆ°è¿™ä¸ªå‡½æ•°ï¼Œæ˜¯å› ä¸ºå¯åŠ¨çš„æ—¶å€™æ˜¯è¿™æ ·çš„ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bootz 80800000 â€“ 83000000</span><br></pre></td></tr></table></figure>

<p>å½“æˆ‘ä»¬è¾“å…¥ä¸Šè¿°å‘½ä»¤å¹¶æ‰§è¡Œä»¥åï¼Œ <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/u-boot/v2019.04/source/cmd/bootz.c#L60">do_bootz()</a> å‡½æ•°å°±ä¼šæ‰§è¡Œï¼Œç„¶åä¸€åˆ‡å°±æŒ‰ç…§ä¸Šå›¾ä¸­æ‰€ç¤ºçš„æµç¨‹å¼€å§‹è¿è¡Œã€‚  </p>
<h3 id="3-5-aliases-èŠ‚ç‚¹"><a href="#3-5-aliases-èŠ‚ç‚¹" class="headerlink" title="3.5Â aliases èŠ‚ç‚¹"></a><font size=3>3.5Â aliases èŠ‚ç‚¹</font></h3><p>aliases èŠ‚ç‚¹æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„èŠ‚ç‚¹ï¼Œ ç”¨äºå®šä¹‰è®¾å¤‡åˆ«åã€‚ è¯¥èŠ‚ç‚¹ä½äºè®¾å¤‡æ ‘çš„æ ¹éƒ¨ï¼Œ å¹¶å…·æœ‰èŠ‚ç‚¹è·¯å¾„ &#x2F;aliasesã€‚</p>
<p>aliases èŠ‚ç‚¹æ˜¯ä¸€ä¸ªå®¹å™¨èŠ‚ç‚¹ï¼Œ åŒ…å«ä¸€ç»„å±æ€§ï¼Œ æ¯ä¸ªå±æ€§éƒ½ä»£è¡¨ä¸€ä¸ªè®¾å¤‡åˆ«åã€‚ æ¯ä¸ªå±æ€§çš„åç§°æ˜¯åˆ«åçš„æ ‡è¯†ç¬¦ï¼Œ è€Œå±æ€§çš„å€¼æ˜¯è¢«å¼•ç”¨è®¾å¤‡èŠ‚ç‚¹çš„è·¯å¾„æˆ–è®¾å¤‡æ ‘ä¸­å…¶ä»–èŠ‚ç‚¹çš„è·¯å¾„ã€‚</p>
<p>å¦‚ä½•åœ¨è®¾å¤‡æ ‘ä¸­ä½¿ç”¨ aliases èŠ‚ç‚¹å‘¢ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹ä¸‹é¢çš„ä¾‹å­ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">aliases &#123;</span><br><span class="line">	mmc0 = &amp;sdmmc0;</span><br><span class="line">    mmc1 = &amp;sdmmc1;</span><br><span class="line">    mmc2 = &amp;sdhci;</span><br><span class="line">    serial0 = <span class="string">&quot;/simple@fe000000/seria1@11c500&quot;</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ1ï¼‰ mmc0 åˆ«åä¸è®¾å¤‡æ ‘ä¸­çš„ sdmmc0 èŠ‚ç‚¹ç›¸å…³è”ã€‚ é€šè¿‡ä½¿ç”¨åˆ«å mmc0ï¼Œ å…¶ä»–è®¾å¤‡èŠ‚ç‚¹æˆ–å®¢æˆ·ç«¯ç¨‹åºå¯ä»¥æ›´æ–¹ä¾¿åœ°å¼•ç”¨ sdmmc0 èŠ‚ç‚¹ï¼Œ è€Œä¸å¿…ç›´æ¥ä½¿ç”¨å…¶å®Œæ•´è·¯å¾„ã€‚</p>
<p>ï¼ˆ2ï¼‰ mmc1 åˆ«åä¸è®¾å¤‡æ ‘ä¸­çš„ sdmmc1 èŠ‚ç‚¹ç›¸å…³è”ã€‚ é€šè¿‡ä½¿ç”¨åˆ«å mmc1ï¼Œ å…¶ä»–è®¾å¤‡èŠ‚ç‚¹æˆ–å®¢æˆ·ç«¯ç¨‹åºå¯ä»¥æ›´æ–¹ä¾¿åœ°å¼•ç”¨ sdmmc1 èŠ‚ç‚¹ï¼Œ è€Œä¸å¿…ç›´æ¥ä½¿ç”¨å…¶å®Œæ•´è·¯å¾„ã€‚</p>
<p>ï¼ˆ3ï¼‰ mmc2 åˆ«åä¸è®¾å¤‡æ ‘ä¸­çš„ sdhci èŠ‚ç‚¹ç›¸å…³è”ã€‚ é€šè¿‡ä½¿ç”¨åˆ«å mmc2ï¼Œ å…¶ä»–è®¾å¤‡èŠ‚ç‚¹æˆ–å®¢æˆ·ç«¯ç¨‹åºå¯ä»¥æ›´æ–¹ä¾¿åœ°å¼•ç”¨ sdhci èŠ‚ç‚¹ï¼Œ è€Œä¸å¿…ç›´æ¥ä½¿ç”¨å…¶å®Œæ•´è·¯å¾„ã€‚</p>
<p>ï¼ˆ4ï¼‰ serial0 åˆ«åä¸è®¾å¤‡æ ‘ä¸­çš„è·¯å¾„ &#x2F;simple@fe000000&#x2F;seria1@11c500 ç›¸å…³è”ã€‚ é€šè¿‡ä½¿ç”¨åˆ«å serial0ï¼Œ å…¶ä»–è®¾å¤‡èŠ‚ç‚¹æˆ–å®¢æˆ·ç«¯ç¨‹åºå¯ä»¥æ›´æ–¹ä¾¿åœ°å¼•ç”¨è¯¥è·¯å¾„ï¼Œ è€Œä¸å¿…è®°ä½æ•´ä¸ªè·¯å¾„å­—ç¬¦ä¸²</p>
<p>åœ¨åˆ«åçš„å®šä¹‰ä¸­ï¼Œ &amp; ç¬¦å·ç”¨äºå¼•ç”¨è®¾å¤‡æ ‘ä¸­çš„èŠ‚ç‚¹ã€‚ åˆ«åçš„ç›®çš„æ˜¯æä¾›å¯è¯»æ€§æ›´é«˜çš„åç§°ï¼Œä½¿è®¾å¤‡æ ‘æ›´æ˜“äºç†è§£å’Œç»´æŠ¤ã€‚ é€šè¿‡ä½¿ç”¨åˆ«åï¼Œ å¯ä»¥ç®€åŒ–è®¾å¤‡èŠ‚ç‚¹ä¹‹é—´çš„å…³è”ï¼Œ å¹¶å‡å°‘é‡å¤è¾“å…¥è®¾å¤‡èŠ‚ç‚¹çš„è·¯å¾„ã€‚ä¸è¿‡æˆ‘ä»¬ä¸€èˆ¬ä¼šåœ¨èŠ‚ç‚¹å‘½åçš„æ—¶å€™ä¼šåŠ ä¸Š labelï¼Œç„¶åé€šè¿‡&amp;labelæ¥è®¿é—®èŠ‚ç‚¹ï¼Œè¿™æ ·ä¹Ÿå¾ˆæ–¹ä¾¿ï¼Œè€Œä¸”è®¾å¤‡æ ‘é‡Œé¢å¤§é‡çš„ä½¿ç”¨&amp;label çš„å½¢å¼æ¥è®¿é—®èŠ‚ç‚¹ã€‚  </p>
<p>å®¢æˆ·ç«¯ç¨‹åºå¯ä»¥ä½¿ç”¨åˆ«åå±æ€§åç§°æ¥å¼•ç”¨å®Œæ•´çš„è®¾å¤‡è·¯å¾„æˆ–éƒ¨åˆ†è·¯å¾„ã€‚ å½“å®¢æˆ·ç«¯ç¨‹åºå°†åˆ«åå­—ç¬¦ä¸²è§†ä¸ºè®¾å¤‡è·¯å¾„æ—¶ï¼Œ åº”æ£€æµ‹å¹¶ä½¿ç”¨åˆ«åã€‚ è¿™æ ·ï¼Œ è®¾å¤‡æ ‘çš„ä½¿ç”¨è€…å¯ä»¥æ›´æ–¹ä¾¿åœ°å¼•ç”¨è®¾å¤‡èŠ‚ç‚¹ï¼Œ è€Œä¸å¿…è®°ä½å¤æ‚çš„è·¯å¾„ç»“æ„ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ aliases èŠ‚ç‚¹ä¸­å®šä¹‰çš„åˆ«ååªåœ¨<strong>è®¾å¤‡æ ‘å†…éƒ¨å¯è§</strong>ï¼Œ ä¸èƒ½åœ¨è®¾å¤‡æ ‘ä¹‹å¤–å¼•ç”¨ã€‚å®ƒä»¬ä¸»è¦ç”¨äºè®¾å¤‡æ ‘çš„å†…éƒ¨ç»„ç»‡å’Œå¼•ç”¨ï¼Œ ä»¥æé«˜å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p>
<h1 id="äºŒã€å®ä¾‹åˆ†æ"><a href="#äºŒã€å®ä¾‹åˆ†æ" class="headerlink" title="äºŒã€å®ä¾‹åˆ†æ"></a><font size=3>äºŒã€å®ä¾‹åˆ†æ</font></h1><p>è¿™é‡Œæˆ‘ä»¬å¯¹ç€è®¾å¤‡æ ‘ä¸­ä¸åŒçš„èŠ‚ç‚¹åšå…·ä½“çš„åˆ†æï¼Œæ¥äº†è§£ä¸€ä¸‹å¸¸ç”¨çš„èŠ‚ç‚¹çš„ä¸€äº›å±æ€§çš„å†™æ³•ã€‚è¿™é‡Œæˆ‘æ˜¯çœ‹çš„rk3568çš„æ•™ç¨‹å­¦ä¹ çš„ï¼Œè¿™é‡Œå°±ä»¥rk3568ä¸ºä¾‹ï¼Œè™½ç„¶èŠ¯ç‰‡ä¸åŒï¼Œä½†æ˜¯è®¾å¤‡æ ‘çš„è¯­æ³•éƒ½æ˜¯ä¸€æ ·çš„ã€‚</p>
<h2 id="1-ä¸­æ–­"><a href="#1-ä¸­æ–­" class="headerlink" title="1. ä¸­æ–­"></a><font size=3>1. ä¸­æ–­</font></h2><h3 id="1-1-ä¸­æ–­ç›¸å…³å±æ€§"><a href="#1-1-ä¸­æ–­ç›¸å…³å±æ€§" class="headerlink" title="1.1 ä¸­æ–­ç›¸å…³å±æ€§"></a><font size=3>1.1 ä¸­æ–­ç›¸å…³å±æ€§</font></h3><p>ä¸‹é¢å±•ç¤ºçš„æ˜¯ iTOP-RK3568 å¼€å‘æ¿ SDK æºç ä¸­çš„ ft5x06 è®¾å¤‡æ ‘ï¼Œ å…¶ä¸­å°±æ˜¯å…³äºä¸­æ–­ç›¸å…³çš„æè¿°ï¼Œ åŒ…æ‹¬äº† interruptsã€ interrupt-controllerã€ #interrupt-cellsã€ interrupt-parentå››ç§å¸¸è§å±æ€§ï¼š </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">gpio0: gpio@fdd60000 &#123;</span><br><span class="line">    compatible = <span class="string">&quot;rockchip,gpio-bank&quot;</span>;</span><br><span class="line">    reg = &lt;<span class="number">0x0</span> <span class="number">0xfdd60000</span> <span class="number">0x0</span> <span class="number">0x100</span>&gt;;</span><br><span class="line">    interrupts = &lt;GIC_SPI <span class="number">33</span> IRQ_TYPE_LEVEL_HIGH&gt;;</span><br><span class="line">    clocks = &lt;&amp;pmucru PCLK_GPI00&gt;, &lt;&amp;pmucru DBCLK_GPI00&gt;;</span><br><span class="line">    gpio-controller;</span><br><span class="line">    <span class="meta">#gpio-cells = <span class="string">&lt;2&gt;</span>;</span></span><br><span class="line">    gpio-ranges = &lt;&amp;pinctrl <span class="number">0</span> <span class="number">0</span> <span class="number">32</span>&gt;;</span><br><span class="line">    interrupt-controller;</span><br><span class="line">    <span class="meta">#interrupt-cells = <span class="string">&lt;2&gt;</span>;</span></span><br><span class="line">&#125;;</span><br><span class="line">ft5x06: ft5x06@<span class="number">38</span> &#123;</span><br><span class="line">    status = <span class="string">&quot;disabled&quot;</span>;</span><br><span class="line">    compatible = <span class="string">&quot;edt,edt-ft5306&quot;</span>;</span><br><span class="line">    reg = &lt;<span class="number">0x38</span>&gt;;</span><br><span class="line">    touch-gpio = &lt;&amp;gpio0 RK_PB5 IRQ_TYPE_EDGE_RISING&gt;;</span><br><span class="line">    interrupt-parent = &lt;&amp;gpio0&gt;;</span><br><span class="line">    interrupts = &lt;RK_PB5 IRQ_TYPE_LEVEL_LOW&gt;;</span><br><span class="line">    reset-gpios = &lt;&amp;gpio0 RK_PB6 GPIO_ACTIVE_LOW&gt;;</span><br><span class="line">    touchscreen-size-x = &lt;<span class="number">800</span>&gt;;</span><br><span class="line">    touchscreen-size-y = &lt;<span class="number">1280</span>&gt;;</span><br><span class="line">    touch_type = &lt;<span class="number">1</span>&gt;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="1-1-1-interrupts"><a href="#1-1-1-interrupts" class="headerlink" title="1.1.1Â interrupts  "></a><font size=3>1.1.1Â interrupts  </font></h4><p>interrupts å±æ€§ç”¨äºæŒ‡å®šè®¾å¤‡çš„ä¸­æ–­ç›¸å…³ä¿¡æ¯ã€‚ å®ƒæè¿°äº†ä¸­æ–­æ§åˆ¶å™¨çš„ç±»å‹ã€ ä¸­æ–­å·ä»¥åŠä¸­æ–­è§¦å‘ç±»å‹ã€‚å‰é¢åˆ—ä¸¾çš„è®¾å¤‡æ ‘æºç ä¸­çš„gpio0èŠ‚ç‚¹å’Œft5x06èŠ‚ç‚¹éƒ½æ¶‰åŠåˆ°äº†interrupts å±æ€§ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š     </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">gpio0: gpio@fdd60000 &#123;</span><br><span class="line">    <span class="comment">//....</span></span><br><span class="line">    interrupts = &lt;GIC_SPI <span class="number">33</span> IRQ_TYPE_LEVEL_HIGH&gt;;</span><br><span class="line">    <span class="comment">//....</span></span><br><span class="line">&#125;;</span><br><span class="line">ft5x06: ft5x06@<span class="number">38</span> &#123;</span><br><span class="line">    <span class="comment">//....</span></span><br><span class="line">    interrupts = &lt;RK_PB5 IRQ_TYPE_LEVEL_LOW&gt;;</span><br><span class="line">    <span class="comment">//....</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>gpio0 èŠ‚ç‚¹çš„ interrupts å…·æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œ åˆ†åˆ«è¡¨ç¤ºä¸­æ–­æ§åˆ¶å™¨ç±»å‹ã€ ä¸­æ–­å·å’Œä¸­æ–­è§¦å‘ç±»å‹ï¼Œæ¯ä¸ªå‚æ•°çš„å…·ä½“æè¿°å¦‚ä¸‹æ‰€ç¤ºï¼š  </p>
<ul>
<li>ï¼ˆ1ï¼‰ ä¸­æ–­æ§åˆ¶å™¨ç±»å‹</li>
</ul>
<p>interrupts å±æ€§çš„ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šäº†ä¸­æ–­æ§åˆ¶å™¨çš„ç±»å‹ã€‚ å¸¸è§çš„ç±»å‹åŒ…æ‹¬ GIC (Generic Interrupt Controller)ã€ IRQ (Basic Interrupt Handling) ç­‰ã€‚ ä¾‹å¦‚ï¼Œ åœ¨ç»™å®šçš„ä»£ç ç‰‡æ®µä¸­ï¼Œ GIC_SPI è¡¨ç¤ºä¸­æ–­æ§åˆ¶å™¨çš„ç±»å‹ä¸º GIC SPI ä¸­æ–­ã€‚  </p>
<p>ä¸­æ–­æ§åˆ¶å™¨è´Ÿè´£ç®¡ç†ç³»ç»Ÿä¸­çš„ä¸­æ–­ä¿¡å·ï¼Œ å®ƒå¯ä»¥æ˜¯ç¡¬ä»¶ä¸­çš„ä¸“ç”¨ä¸­æ–­æ§åˆ¶å™¨ï¼Œ ä¹Ÿå¯ä»¥æ˜¯å¤„ç†å™¨å†…éƒ¨çš„ä¸­æ–­æ§åˆ¶å™¨ã€‚  </p>
<ul>
<li>ï¼ˆ2ï¼‰ä¸­æ–­å·</li>
</ul>
<p>interrupts å±æ€§çš„ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šäº†è®¾å¤‡æ‰€ä½¿ç”¨çš„ä¸­æ–­å·ã€‚ ä¸­æ–­å·æ˜¯ä¸€ä¸ªå”¯ä¸€æ ‡è¯†ç¬¦ï¼Œ ç”¨äºåŒºåˆ†ä¸åŒçš„ä¸­æ–­ä¿¡å·æºã€‚ ç³»ç»Ÿä½¿ç”¨ä¸­æ–­å·æ¥è¯†åˆ«ä¸­æ–­æºå¹¶è¿›è¡Œç›¸åº”çš„ä¸­æ–­å¤„ç†ã€‚</p>
<p>ä¸­æ–­å·å¯ä»¥æ˜¯ä¸€ä¸ªæ•´æ•°å€¼ï¼Œ ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå®å®šä¹‰æˆ–ç¬¦å·å¼•ç”¨ã€‚ åœ¨ç»™å®šçš„ä»£ç ç‰‡æ®µä¸­ï¼Œ 33 è¡¨ç¤ºè¯¥è®¾å¤‡ä½¿ç”¨çš„ä¸­æ–­å·ä¸º 33ã€‚</p>
<ul>
<li>ï¼ˆ3ï¼‰ ä¸­æ–­è§¦å‘ç±»å‹</li>
</ul>
<p>interrupts å±æ€§çš„ç¬¬ä¸‰ä¸ªå‚æ•°æŒ‡å®šäº†ä¸­æ–­çš„è§¦å‘ç±»å‹ï¼Œ å³ä¸­æ–­ä¿¡å·çš„è§¦å‘æ¡ä»¶ã€‚ å¸¸è§çš„è§¦å‘ç±»å‹åŒ…æ‹¬è¾¹æ²¿è§¦å‘å’Œç”µå¹³è§¦å‘ã€‚  </p>
<p>è¾¹æ²¿è§¦å‘è¡¨ç¤ºä¸­æ–­ä¿¡å·åœ¨ä»ä½ç”µå¹³åˆ°é«˜ç”µå¹³æˆ–ä»é«˜ç”µå¹³åˆ°ä½ç”µå¹³çš„å˜åŒ–æ—¶è§¦å‘ã€‚ è§¦å‘ç±»å‹å¯ä»¥æ˜¯ä¸Šå‡æ²¿è§¦å‘ã€ ä¸‹é™æ²¿è§¦å‘æˆ–åŒè¾¹æ²¿è§¦å‘ã€‚ ç”µå¹³è§¦å‘è¡¨ç¤ºä¸­æ–­ä¿¡å·åœ¨ä¿æŒç‰¹å®šç”µå¹³çŠ¶æ€æ—¶è§¦å‘ï¼Œ å¯ä»¥æ˜¯é«˜ç”µå¹³è§¦å‘æˆ–ä½ç”µå¹³è§¦å‘ã€‚</p>
<p>åœ¨ç»™å®šçš„ä»£ç ç‰‡æ®µä¸­ï¼Œ IRQ_TYPE_LEVEL_HIGH è¡¨ç¤ºä¸­æ–­çš„è§¦å‘ç±»å‹ä¸ºé«˜ç”µå¹³è§¦å‘ã€‚ è§¦å‘ç±»å‹çš„å®å®šä¹‰åœ¨å†…æ ¸æºç â€œ<a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/v4.19.71/source/include/dt-bindings/interrupt-controller/irq.h">irq.h - include&#x2F;dt-bindings&#x2F;interrupt-controller&#x2F;irq.h</a>â€ ç›®å½•ä¸‹ï¼Œ å…·ä½“å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š  </p>
  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> IRQ_TYPE_NONE 0 		<span class="comment">// æ— ä¸­æ–­è§¦å‘ç±»å‹</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> IRQ_TYPE_EDGE_RISING 1  <span class="comment">// ä¸Šå‡æ²¿è§¦å‘</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> IRQ_TYPE_EDGE_FALLING 2 <span class="comment">// ä¸‹é™æ²¿è§¦å‘</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> IRQ_TYPE_EDGE_BOTH (IRQ_TYPE_EDGE_FALLING | IRQ_TYPE_EDGE_RISING)<span class="comment">// åŒè¾¹æ²¿è§¦å‘</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> IRQ_TYPE_LEVEL_HIGH 4 	<span class="comment">// é«˜ç”µå¹³è§¦å‘</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> IRQ_TYPE_LEVEL_LOW 8 	<span class="comment">// ä½ç”µå¹³è§¦å‘</span></span></span><br></pre></td></tr></table></figure>

<p>è€Œåœ¨ ft5x06 èŠ‚ç‚¹ä¸­åªæœ‰ä¸­æ–­å·å’Œä¸­æ–­è§¦å‘ç±»å‹ä¸¤ä¸ªå‚æ•°ï¼Œ è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢?æˆ‘ä»¬ç»§ç»­å¾€ä¸‹å­¦ä¹ ã€‚</p>
<h4 id="1-1-2-interrupt-controller"><a href="#1-1-2-interrupt-controller" class="headerlink" title="1.1.2Â interrupt-controller  "></a><font size=3>1.1.2Â interrupt-controller  </font></h4><p>interrupt-controller å±æ€§æ˜¯è®¾å¤‡æ ‘ä¸­ç”¨äºæè¿°ä¸­æ–­æ§åˆ¶å™¨çš„å±æ€§ä¹‹ä¸€ã€‚ å®ƒæä¾›äº†å…³äºä¸­æ–­æ§åˆ¶å™¨çš„ç›¸å…³ä¿¡æ¯ï¼Œ ä»¥ä¾¿æ“ä½œç³»ç»Ÿå’Œå…¶ä»–è®¾å¤‡èƒ½å¤Ÿæ­£ç¡®é…ç½®å’Œä½¿ç”¨ä¸­æ–­ç³»ç»Ÿã€‚  </p>
<p>interrupt-controller å±æ€§ç”¨äºæ ‡è¯†å½“å‰èŠ‚ç‚¹æ‰€æè¿°çš„è®¾å¤‡æ˜¯ä¸€ä¸ªä¸­æ–­æ§åˆ¶å™¨ã€‚ ä¸­æ–­æ§åˆ¶å™¨æ˜¯ç¡¬ä»¶æˆ–è½¯ä»¶æ¨¡å—ï¼Œ è´Ÿè´£ç®¡ç†å’Œåˆ†å‘ä¸­æ–­ä¿¡å·ã€‚ å®ƒæ¥æ”¶æ¥è‡ªå„ç§è®¾å¤‡çš„ä¸­æ–­è¯·æ±‚ï¼Œ å¹¶æ ¹æ®ä¼˜å…ˆçº§å’Œé…ç½®è§„åˆ™åˆ†å‘ä¸­æ–­ç»™ç›¸åº”çš„å¤„ç†å™¨æˆ–è®¾å¤‡ã€‚  </p>
<p>interrupt-controller å±æ€§æœ¬èº«æ²¡æœ‰ç‰¹å®šçš„å±æ€§å€¼ï¼Œ åªéœ€å‡ºç°åœ¨èŠ‚ç‚¹çš„å±æ€§åˆ—è¡¨ä¸­å³å¯ã€‚ å‡ºç°è¯¥å±æ€§çš„å­˜åœ¨å³è¡¨ç¤ºè¯¥èŠ‚ç‚¹æè¿°çš„è®¾å¤‡æ˜¯ä¸­æ–­æ§åˆ¶å™¨ã€‚  </p>
<h4 id="1-1-3-interrupt-parent"><a href="#1-1-3-interrupt-parent" class="headerlink" title="1.1.3Â interrupt-parent  "></a><font size=3>1.1.3Â interrupt-parent  </font></h4><p>interrupt-parent å±æ€§æ˜¯è®¾å¤‡æ ‘ä¸­ç”¨äºå»ºç«‹ä¸­æ–­ä¿¡å·æºä¸ä¸­æ–­æ§åˆ¶å™¨ä¹‹é—´å…³è”çš„å±æ€§ã€‚ å®ƒæŒ‡å®šäº†ä¸­æ–­ä¿¡å·æºæ‰€å±çš„ä¸­æ–­æ§åˆ¶å™¨èŠ‚ç‚¹ï¼Œ ä»¥ç¡®ä¿æ­£ç¡®çš„ä¸­æ–­å¤„ç†å’Œåˆ†å‘ã€‚  </p>
<p>interrupt-parent å±æ€§ç”¨äºæŒ‡å®šä¸­æ–­ä¿¡å·æºæ‰€å±çš„ä¸­æ–­æ§åˆ¶å™¨ã€‚ ä¸­æ–­ä¿¡å·æºæ˜¯äº§ç”Ÿä¸­æ–­çš„è®¾å¤‡æˆ–å…¶ä»–ä¸­æ–­æºèŠ‚ç‚¹ã€‚ é€šè¿‡æŒ‡å®šä¸­æ–­æ§åˆ¶å™¨ï¼Œ æ“ä½œç³»ç»Ÿå¯ä»¥æ­£ç¡®åœ°å°†ä¸­æ–­è¯·æ±‚ä¼ é€’ç»™ç›¸åº”çš„ä¸­æ–­æ§åˆ¶å™¨èŠ‚ç‚¹è¿›è¡Œå¤„ç†å’Œåˆ†å‘ã€‚  </p>
<p>interrupt-parent å±æ€§å€¼æ˜¯ä¸€ä¸ªå¼•ç”¨ï¼Œ å®ƒæŒ‡å‘ä¸­æ–­æ§åˆ¶å™¨èŠ‚ç‚¹çš„è·¯å¾„æˆ–æ ‡ç­¾ã€‚ å¯ä»¥ä½¿ç”¨è·¯å¾„æ¥å¼•ç”¨ä¸­æ–­æ§åˆ¶å™¨èŠ‚ç‚¹ï¼Œ å¦‚&#x2F;interrupt-controller-nodeï¼Œ æˆ–ä½¿ç”¨æ ‡ç­¾æ¥å¼•ç”¨ä¸­æ–­æ§åˆ¶å™¨èŠ‚ç‚¹ï¼Œ å¦‚&amp;interrupt-controller-labelï¼Œ åœ¨å‰é¢ä¾‹å­ä¸­çš„ ft5x06 å°±æ˜¯é€šè¿‡ä¸­æ–­æ§åˆ¶å™¨èŠ‚ç‚¹å’Œ gpio0 ä¸­æ–­æ§åˆ¶å™¨å»ºç«‹äº†è”ç³»ï¼Œ å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ft5x06: ft5x06@<span class="number">38</span> &#123;</span><br><span class="line">    <span class="comment">//....</span></span><br><span class="line">    interrupt-parent = &lt;&amp;gpio0&gt;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>ä¸­æ–­ä¿¡å·æºèŠ‚ç‚¹ï¼ˆä¾‹å¦‚è®¾å¤‡èŠ‚ç‚¹æˆ–å…¶ä»–ä¸­æ–­æºèŠ‚ç‚¹ï¼‰ ä¸­çš„ interrupt-parent å±æ€§ç”¨äºæŒ‡å®šä¸­æ–­ä¿¡å·æºæ‰€å±çš„ä¸­æ–­æ§åˆ¶å™¨èŠ‚ç‚¹ã€‚ è¿™æ ·ï¼Œ ä¸­æ–­ä¿¡å·æºå°±å¯ä»¥å°†ä¸­æ–­è¯·æ±‚ä¼ é€’ç»™æ­£ç¡®çš„ä¸­æ–­æ§åˆ¶å™¨è¿›è¡Œå¤„ç†ã€‚ ä¸­æ–­ä¿¡å·æºèŠ‚ç‚¹çš„ interrupts å±æ€§ä¸­çš„ä¸­æ–­å·å’Œå…¶ä»–ç›¸å…³ä¿¡æ¯å°†ä¸æŒ‡å®šçš„ä¸­æ–­æ§åˆ¶å™¨å…³è”èµ·æ¥ã€‚  </p>
<p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œ ä¸­æ–­æ§åˆ¶å™¨å¯ä»¥å½¢æˆå¤šçº§ç»“æ„ï¼Œ å…¶ä¸­ä¸€ä¸ªä¸­æ–­æ§åˆ¶å™¨èŠ‚ç‚¹å¯èƒ½æ˜¯å¦ä¸€ä¸ªä¸­æ–­æ§åˆ¶å™¨çš„çˆ¶èŠ‚ç‚¹ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ interrupt-parent å±æ€§å¯ä»¥ç”¨äºæŒ‡å®šå±‚æ¬¡ç»“æ„ä¸­çš„ä¸Šçº§ä¸­æ–­æ§åˆ¶å™¨ã€‚  </p>
<h4 id="1-1-4-interrupt-cells"><a href="#1-1-4-interrupt-cells" class="headerlink" title="1.1.4Â #interrupt-cells  "></a><font size=3>1.1.4Â #interrupt-cells  </font></h4><p>#interrupt-cells å±æ€§ç”¨äºæè¿°ä¸­æ–­æ§åˆ¶å™¨ä¸­æ¯ä¸ªä¸­æ–­ä¿¡å·æºçš„ä¸­æ–­ç¼–å·å•å…ƒçš„æ•°é‡ã€‚ ä¸­æ–­ç¼–å·å•å…ƒæ˜¯æŒ‡ç”¨äºè¡¨ç¤ºä¸­æ–­å·å’Œå…¶ä»–ç›¸å…³ä¿¡æ¯çš„å›ºå®šå¤§å°çš„å•å…ƒã€‚ é€šè¿‡æŒ‡å®šä¸­æ–­ç¼–å·å•å…ƒçš„æ•°é‡ï¼Œ æ“ä½œç³»ç»Ÿå¯ä»¥æ­£ç¡®è§£æå’Œå¤„ç†ä¸­æ–­ä¿¡æ¯ï¼Œ å¹¶å°†å…¶ä¸ä¸­æ–­æ§åˆ¶å™¨å’Œä¸­æ–­ä¿¡å·æºè¿›è¡Œå…³è”ã€‚  </p>
<p>#interrupt-cells å±æ€§çš„å€¼æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œ è¡¨ç¤ºä¸­æ–­ç¼–å·å•å…ƒçš„æ•°é‡ã€‚ é€šå¸¸ï¼Œ è¿™ä¸ªå€¼æ˜¯ä¸€ä¸ªæ­£æ•´æ•°ï¼Œ ä¾‹å¦‚ 1ã€ 2 æˆ– 3ï¼Œ å–å†³äºä¸­æ–­æ§åˆ¶å™¨å’Œè®¾å¤‡çš„è¦æ±‚ã€‚  </p>
<p>åœ¨ gpio0 çš„ä¸­æ–­æ§åˆ¶å™¨ä¸º gicï¼Œ åœ¨ gic èŠ‚ç‚¹ä¸­#interrupt-cells å±æ€§è¢«è®¾ç½®ä¸º 3ï¼Œ è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆåœ¨ gpio0 èŠ‚ç‚¹ä¸­ interrupts å±æ€§æœ‰ä¸‰ä¸ªå€¼ï¼Œ è€Œ ft5x06 çš„ä¸­æ–­æ§åˆ¶å™¨ä¸º gpio0ï¼Œ åœ¨ gpio0 èŠ‚ç‚¹ä¸­#interrupt-cells å±æ€§è¢«è®¾ç½®ä¸º 2ï¼Œ æ‰€ä»¥ ft5x06 èŠ‚ç‚¹çš„ interrupts å±æ€§åªæœ‰ä¸¤ä¸ªå€¼ã€‚</p>
<h3 id="1-2-ä¸­æ–­å®ä¾‹"><a href="#1-2-ä¸­æ–­å®ä¾‹" class="headerlink" title="1.2 ä¸­æ–­å®ä¾‹"></a><font size=3>1.2 ä¸­æ–­å®ä¾‹</font></h3><h4 id="1-2-1-ç¡¬ä»¶åŸç†å›¾"><a href="#1-2-1-ç¡¬ä»¶åŸç†å›¾" class="headerlink" title="1.2.1 ç¡¬ä»¶åŸç†å›¾"></a><font size=3>1.2.1 ç¡¬ä»¶åŸç†å›¾</font></h4><p>è¿™é‡Œæˆ‘ä»¬è¿˜æ˜¯æ¥çœ‹æˆ‘ä»¬çš„imx6ullï¼Œalphaæœ‰ä¸€ä¸ªæŒ‰é”®ï¼š</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250220091647571.png" alt="image-20250220091647571" style="zoom: 33%;" />

<p>æŒ‰é”® KEY0 æ˜¯è¿æ¥åˆ° I.MX6U çš„ UART1_CTS è¿™ä¸ª IO ä¸Šçš„ï¼Œ KEY0æ¥äº†ä¸€ä¸ª 10K çš„ä¸Šæ‹‰ç”µé˜»ï¼Œå› æ­¤ KEY0 æ²¡æœ‰æŒ‰ä¸‹çš„æ—¶å€™ UART1_CTS åº”è¯¥æ˜¯é«˜ç”µå¹³ï¼Œå½“ KEY0æŒ‰ä¸‹ä»¥å UART1_CTS å°±æ˜¯ä½ç”µå¹³ã€‚æœä¸€ä¸‹å‚è€ƒæ‰‹å†Œå°±ä¼šå‘ç°ï¼Œè¿™ä¸ªå¼•è„šæ˜¯GPIO1_IO18  </p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250220092740884.png" alt="image-20250220092740884"  />

<h4 id="1-2-2-ä¸­æ–­å·æ€ä¹ˆç¡®å®šï¼Ÿ"><a href="#1-2-2-ä¸­æ–­å·æ€ä¹ˆç¡®å®šï¼Ÿ" class="headerlink" title="1.2.2 ä¸­æ–­å·æ€ä¹ˆç¡®å®šï¼Ÿ"></a><font size=3>1.2.2 ä¸­æ–­å·æ€ä¹ˆç¡®å®šï¼Ÿ</font></h4><p>å¯ä»¥çœ‹è¿™ä¸ªç¬”è®°ã€Š<a href="https://sumumm.github.io/post/b3d7ec66.html#2-%E5%A6%82%E4%BD%95%E7%A1%AE%E8%AE%A4%E4%B8%AD%E6%96%AD%E5%8F%B7">LV04-07-ä¸­æ–­ä¸å¼‚å¸¸-05-IMX6ULLæŒ‰é”®ä¸­æ–­å®ä¾‹ | è‹æœ¨</a>ã€‹è¿™é‡Œå†ç®€å•äº†è§£ä¸€ä¸‹ã€‚æˆ‘ä»¬å‰è¾¹çŸ¥é“äº†æŒ‰é”®æ¥åœ¨äº†GPIO1_IO18ä¸Šè¾¹ï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹ã€ŠI.MX6ULå‚è€ƒæ‰‹å†Œã€‹çš„3.2 Cortex A7 interruptsä¸€èŠ‚ï¼Œæ‰¾åˆ°è¿™ä¸ªGPIOç®¡è„šå¯¹åº”çš„ä¸­æ–­å·ï¼š</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250220093228164.png" alt="image-20250220093228164"  />

<p>å¯ä»¥çœ‹åˆ°GPIO1çš„0 -15ç®¡è„šä½¿ç”¨çš„æ˜¯66ï¼Œ16 - 31ä½¿ç”¨çš„æ˜¯67ï¼Œè¿™é‡Œåªæ˜¯IRQçš„ç¼–å·ï¼Œå¯¹åº”åˆ° GIC çš„ SPIä¸­æ–­å·éœ€è¦åœ¨æ­¤ç¼–å·åŸºç¡€ä¸ŠåŠ ä¸Š 32ï¼Œæ‰€ä»¥è¿™é‡Œçš„æŒ‰é”®ä¸­æ–­å·å®é™…ä¸º99ï¼ˆ67+32ï¼‰ã€‚ä½†æ˜¯å…¶å®åœ¨linuxä¸­å¼€å‘çš„æ—¶å€™ï¼Œä¼šæœ‰å‡½æ•°ï¼ˆä¾‹å¦‚<a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/v4.19.71/source/arch/arm/include/asm/gpio.h#L23">gpio_to_irq()</a>ï¼‰è‡ªåŠ¨å¸®æˆ‘ä»¬è®¡ç®—ï¼Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“æ˜¯å“ªä¸ªå¼•è„šå°±å¯ä»¥äº†ã€‚</p>
<h4 id="1-2-3-è§¦å‘æ–¹å¼é€‰æ‹©"><a href="#1-2-3-è§¦å‘æ–¹å¼é€‰æ‹©" class="headerlink" title="1.2.3 è§¦å‘æ–¹å¼é€‰æ‹©"></a><font size=3>1.2.3 è§¦å‘æ–¹å¼é€‰æ‹©</font></h4><p>è§¦å‘æ–¹å¼å°±å¯ä»¥çœ‹è¿™ä¸ª<a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/v4.19.71/source/include/dt-bindings/interrupt-controller/irq.h">irq.h - include&#x2F;dt-bindings&#x2F;interrupt-controller&#x2F;irq.h</a>ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> IRQ_TYPE_NONE 0 		<span class="comment">// æ— ä¸­æ–­è§¦å‘ç±»å‹</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> IRQ_TYPE_EDGE_RISING 1  <span class="comment">// ä¸Šå‡æ²¿è§¦å‘</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> IRQ_TYPE_EDGE_FALLING 2 <span class="comment">// ä¸‹é™æ²¿è§¦å‘</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> IRQ_TYPE_EDGE_BOTH (IRQ_TYPE_EDGE_FALLING | IRQ_TYPE_EDGE_RISING)<span class="comment">// åŒè¾¹æ²¿è§¦å‘</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> IRQ_TYPE_LEVEL_HIGH 4 	<span class="comment">// é«˜ç”µå¹³è§¦å‘</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> IRQ_TYPE_LEVEL_LOW 8 	<span class="comment">// ä½ç”µå¹³è§¦å‘</span></span></span><br></pre></td></tr></table></figure>

<h4 id="1-2-4-æŒ‰é”®ä¸­æ–­èŠ‚ç‚¹"><a href="#1-2-4-æŒ‰é”®ä¸­æ–­èŠ‚ç‚¹" class="headerlink" title="1.2.4 æŒ‰é”®ä¸­æ–­èŠ‚ç‚¹"></a><font size=3>1.2.4 æŒ‰é”®ä¸­æ–­èŠ‚ç‚¹</font></h4><p>æŒ‰é”® KEY0 ä½¿ç”¨ä¸­æ–­æ¨¡å¼ï¼Œéœ€è¦åœ¨â€œkeyâ€èŠ‚ç‚¹ä¸‹æ·»åŠ ä¸­æ–­ç›¸å…³å±æ€§ï¼Œæ·»åŠ å®Œæˆä»¥åçš„â€œkeyâ€èŠ‚ç‚¹å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">sdev_key &#123;</span><br><span class="line">    <span class="meta">#address-cells = <span class="string">&lt;1&gt;</span>;</span></span><br><span class="line">    <span class="meta">#size-cells = <span class="string">&lt;1&gt;</span>;</span></span><br><span class="line">    compatible = <span class="string">&quot;sdev_key&quot;</span>;</span><br><span class="line">    pinctrl-names = <span class="string">&quot;default&quot;</span>;</span><br><span class="line">    pinctrl<span class="number">-0</span> = &lt;&amp;pinctrl_key&gt;;</span><br><span class="line">    key-gpio = &lt;&amp;gpio1 <span class="number">18</span> GPIO_ACTIVE_LOW&gt;; <span class="comment">/* KEY0 */</span></span><br><span class="line">    interrupt-parent = &lt;&amp;gpio1&gt;;</span><br><span class="line">    interrupts = &lt;<span class="number">18</span> IRQ_TYPE_EDGE_BOTH&gt;; <span class="comment">/* FALLING RISING */</span></span><br><span class="line">    status = <span class="string">&quot;okay&quot;</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>ç¬¬ 8 è¡Œï¼Œè®¾ç½® interrupt-parent å±æ€§å€¼ä¸ºâ€œgpio1â€ï¼Œå› ä¸º KEY0 æ‰€ä½¿ç”¨çš„ GPIO ä¸ºGPIO1_IO18ï¼Œä¹Ÿå°±æ˜¯è®¾ç½® KEY0 çš„ GPIO ä¸­æ–­æ§åˆ¶å™¨ä¸º gpio1ã€‚</p>
<p>ç¬¬ 9 è¡Œï¼Œè®¾ç½® interrupts å±æ€§ï¼Œä¹Ÿå°±æ˜¯è®¾ç½®ä¸­æ–­æºï¼Œç¬¬ä¸€ä¸ª cells çš„ 18 è¡¨ç¤º GPIO1 ç»„çš„ 18å· IOã€‚</p>
<p>è¿™ä¸ªgpio1æ˜¯åœ¨ <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/v4.19.71/source/arch/arm/boot/dts/imx6ul.dtsi#L432">imx6ul.dtsi</a>ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">gpio1: gpio@<span class="number">209</span>c000 &#123;</span><br><span class="line">    compatible = <span class="string">&quot;fsl,imx6ul-gpio&quot;</span>, <span class="string">&quot;fsl,imx35-gpio&quot;</span>;</span><br><span class="line">    reg = &lt;<span class="number">0x0209c000</span> <span class="number">0x4000</span>&gt;;</span><br><span class="line">    interrupts = &lt;GIC_SPI <span class="number">66</span> IRQ_TYPE_LEVEL_HIGH&gt;,</span><br><span class="line">    &lt;GIC_SPI <span class="number">67</span> IRQ_TYPE_LEVEL_HIGH&gt;;</span><br><span class="line">    clocks = &lt;&amp;clks IMX6UL_CLK_GPIO1&gt;;</span><br><span class="line">    gpio-controller;</span><br><span class="line">    <span class="meta">#gpio-cells = <span class="string">&lt;2&gt;</span>;</span></span><br><span class="line">    interrupt-controller;</span><br><span class="line">    <span class="meta">#interrupt-cells = <span class="string">&lt;2&gt;</span>;</span></span><br><span class="line">    gpio-ranges = &lt;&amp;iomuxc  <span class="number">0</span> <span class="number">23</span> <span class="number">10</span>&gt;, &lt;&amp;iomuxc <span class="number">10</span> <span class="number">17</span> <span class="number">6</span>&gt;,</span><br><span class="line">    &lt;&amp;iomuxc <span class="number">16</span> <span class="number">33</span> <span class="number">16</span>&gt;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="2-æ—¶é’Ÿ"><a href="#2-æ—¶é’Ÿ" class="headerlink" title="2. æ—¶é’Ÿ"></a><font size=3>2. æ—¶é’Ÿ</font></h2><p>æ—¶é’Ÿï¼ˆClockï¼‰ ç”¨äºæè¿°ç¡¬ä»¶è®¾å¤‡å’Œç³»ç»Ÿä¸­çš„æ—¶é’Ÿæºä»¥åŠæ—¶é’Ÿç›¸å…³çš„é…ç½®å’Œè¿æ¥å…³ç³»ã€‚ æ—¶é’Ÿåœ¨è®¡ç®—æœºç³»ç»Ÿä¸­èµ·ç€è‡³å…³é‡è¦çš„ä½œç”¨ï¼Œ ç”¨äºåŒæ­¥å’Œå®šæ—¶å„ç§ç¡¬ä»¶è®¾å¤‡çš„æ“ä½œã€‚ æ—¶é’Ÿå¯ä»¥åˆ†ä¸ºä¸¤ä¸ªä¸»è¦è§’è‰²ï¼š æ—¶é’Ÿç”Ÿäº§è€…ï¼ˆclock providerï¼‰ å’Œæ—¶é’Ÿæ¶ˆè´¹è€…ï¼ˆclock consumerï¼‰ ã€‚</p>
<h3 id="2-1-æ—¶é’Ÿç”Ÿäº§è€…ï¼ˆclock-providerï¼‰"><a href="#2-1-æ—¶é’Ÿç”Ÿäº§è€…ï¼ˆclock-providerï¼‰" class="headerlink" title="2.1Â æ—¶é’Ÿç”Ÿäº§è€…ï¼ˆclock providerï¼‰"></a><font size=3>2.1Â æ—¶é’Ÿç”Ÿäº§è€…ï¼ˆclock providerï¼‰</font></h3><p>æ—¶é’Ÿç”Ÿäº§è€…æ˜¯è´Ÿè´£ç”Ÿæˆå’Œæä¾›æ—¶é’Ÿä¿¡å·çš„ç¡¬ä»¶æˆ–è½¯ä»¶æ¨¡å—ã€‚ å®ƒå¯ä»¥æ˜¯æ—¶é’Ÿæ§åˆ¶å™¨ã€PLLã€ æ—¶é’Ÿå‘ç”Ÿå™¨ç­‰ã€‚æ—¶é’ŸèŠ‚ç‚¹å±æ€§å¦‚ä¸‹ï¼š</p>
<ul>
<li>ï¼ˆ1ï¼‰ clock-cells</li>
</ul>
<p>å±æ€§ç”¨äºæŒ‡å®šæ—¶é’Ÿç¼–å·çš„ä½æ•°ã€‚ å®ƒæ˜¯ä¸€ä¸ªæ•´æ•°å€¼ï¼Œ è¡¨ç¤ºæ—¶é’Ÿç¼–å·çš„ä½æ•°ã€‚ é€šå¸¸æƒ…å†µä¸‹ï¼Œ å½“ clock-cells ä¸º 0 æ—¶è¡¨ç¤ºä¸€ä¸ªæ—¶é’Ÿï¼Œ ä¸º 1 è¡¨ç¤ºå¤šä¸ªæ—¶é’Ÿã€‚ å…·ä½“ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤º  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç¤ºä¾‹ 1ï¼š å•ä¸ªæ—¶é’Ÿ</span></span><br><span class="line">osc24m: osc24m &#123;</span><br><span class="line">    compatible = <span class="string">&quot;clock&quot;</span>;</span><br><span class="line">    clock-frequency = &lt;<span class="number">24000000</span>&gt;;</span><br><span class="line">    clock-output-names = <span class="string">&quot;osc24m&quot;</span>;</span><br><span class="line">    <span class="meta">#clock-cells = <span class="string">&lt;O&gt;</span>;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¤ºä¾‹ 2ï¼š å¤šä¸ªæ—¶é’Ÿ</span></span><br><span class="line">clock: clock &#123;</span><br><span class="line">    <span class="meta">#clock-cells = <span class="string">&lt;1&gt;</span>;</span></span><br><span class="line">    clock-output-names = <span class="string">&quot;clock1&quot;</span>, <span class="string">&quot;clock2&quot;</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ul>
<li>ï¼ˆ2ï¼‰ clock-frequency</li>
</ul>
<p>clock-frequency å±æ€§æ˜¯è®¾å¤‡æ ‘ä¸­ç”¨äºæŒ‡å®šæ—¶é’Ÿé¢‘ç‡çš„å±æ€§ã€‚ å®ƒç”¨äºæè¿°æ—¶é’ŸèŠ‚ç‚¹æ‰€æä¾›çš„æ—¶é’Ÿä¿¡å·çš„é¢‘ç‡ï¼Œ ä½¿ç”¨ Hertz (Hz) ä½œä¸ºå•ä½ã€‚ å¯¹äºæ—¶é’Ÿç”Ÿäº§è€…èŠ‚ç‚¹ï¼Œ clock-frequency å±æ€§è¡¨ç¤ºè¯¥èŠ‚ç‚¹ç”Ÿæˆçš„æ—¶é’Ÿä¿¡å·çš„é¢‘ç‡ã€‚ å®ƒç”¨äºæè¿°æ—¶é’Ÿæ§åˆ¶å™¨ã€ æ™¶æŒ¯ã€ PLL ç­‰äº§ç”Ÿæ—¶é’Ÿä¿¡å·çš„ç¡¬ä»¶æˆ–è½¯ä»¶æ¨¡å—çš„è¾“å‡ºé¢‘ç‡ï¼Œ ä¾‹å¦‚æŒ‡å®šæ—¶é’Ÿé¢‘ç‡ä¸º 24000000 çš„å…·ä½“ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºï¼š  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">osc24m: osc24m &#123;</span><br><span class="line">    compatible = <span class="string">&quot;clock&quot;</span>;</span><br><span class="line">    clock-frequency = &lt;<span class="number">24000000</span>&gt;;</span><br><span class="line">    clock-output-names = <span class="string">&quot;osc24m&quot;</span>;</span><br><span class="line">    <span class="meta">#clock-cells = <span class="string">&lt;O&gt;</span>;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ul>
<li>ï¼ˆ3ï¼‰ assigned-clocks å’Œ assigned-clock-rates</li>
</ul>
<p>assigned-clocks å’Œ assigned-clock-rates æ˜¯è®¾å¤‡æ ‘ä¸­ç”¨äºæè¿°å¤šè·¯æ—¶é’Ÿçš„å±æ€§ï¼Œ é€šå¸¸ä¸€èµ·ä½¿ç”¨ã€‚</p>
<p>assigned-clocks å±æ€§ç”¨äºæ ‡è¯†æ—¶é’Ÿæ¶ˆè´¹è€…èŠ‚ç‚¹æ‰€ä½¿ç”¨çš„æ—¶é’Ÿæºã€‚ å®ƒæ˜¯ä¸€ä¸ªæ•´æ•°æ•°ç»„ï¼Œ æ¯ä¸ªå…ƒç´ å¯¹åº”ä¸€ä¸ªæ—¶é’Ÿç¼–å·ã€‚ æ—¶é’Ÿç¼–å·æ˜¯æŒ‡æ—¶é’Ÿç”Ÿäº§è€…èŠ‚ç‚¹ï¼ˆå¦‚æ—¶é’Ÿæ§åˆ¶å™¨ï¼‰ æ‰€æä¾›çš„æ—¶é’Ÿæºçš„ç¼–å·ã€‚ é€šè¿‡åœ¨æ—¶é’Ÿæ¶ˆè´¹è€…èŠ‚ç‚¹ä¸­ä½¿ç”¨ assigned-clocks å±æ€§ï¼Œ å¯ä»¥æŒ‡å®šè¯¥èŠ‚ç‚¹æ‰€éœ€çš„æ—¶é’Ÿæºã€‚  </p>
<p>assigned-clock-rates å±æ€§ç”¨äºæŒ‡å®šæ¯ä¸ªæ—¶é’Ÿæºçš„æ—¶é’Ÿé¢‘ç‡ã€‚ å®ƒæ˜¯ä¸€ä¸ªæ•´æ•°æ•°ç»„ï¼Œ æ¯ä¸ªå…ƒç´ å¯¹åº”ä¸€ä¸ªæ—¶é’Ÿæºçš„é¢‘ç‡ã€‚ æ—¶é’Ÿé¢‘ç‡ä»¥ Hz (èµ«å…¹) ä¸ºå•ä½è¡¨ç¤ºã€‚ assigned-clock-rates å±æ€§çš„å…ƒç´ æ•°é‡å’Œé¡ºåºåº”ä¸ assigned-clocks å±æ€§ä¸­çš„æ—¶é’Ÿç¼–å·ç›¸å¯¹åº”ã€‚  </p>
<p>å…³äº assigned-clocks å’Œ assigned-clock-rates å±æ€§çš„ä¸€ä¸ªå…·ä½“ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºï¼š  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cru: clock-controller@fdd20000 &#123;</span><br><span class="line">    <span class="meta">#clock-cells = <span class="string">&lt;1&gt;</span>;</span></span><br><span class="line">    assigned-clocks = &lt;&amp;pmucru CLK_RTC_32K&gt;, &lt;&amp;cru ACLK_RKVDEC_PRE&gt;;</span><br><span class="line">    assigned-clock-rates = &lt;<span class="number">32768</span>&gt;, &lt;<span class="number">300000000</span>&gt;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ul>
<li>ï¼ˆ4ï¼‰ clock-indices</li>
</ul>
<p>clock-indices å±æ€§ç”¨äºæŒ‡å®šæ—¶é’Ÿæ¶ˆè´¹è€…èŠ‚ç‚¹æ‰€ä½¿ç”¨çš„æ—¶é’Ÿæºçš„ç´¢å¼•å€¼ã€‚å®ƒæ˜¯ä¸€ä¸ªæ•´æ•°æ•°ç»„ï¼Œ æ¯ä¸ªå…ƒç´ å¯¹åº”ä¸€ä¸ªæ—¶é’Ÿæºçš„ç´¢å¼•ã€‚</p>
<p>æ—¶é’Ÿç´¢å¼•æ˜¯æŒ‡æ—¶é’Ÿç”Ÿäº§è€…èŠ‚ç‚¹ï¼ˆå¦‚æ—¶é’Ÿæ§åˆ¶å™¨ï¼‰ æ‰€æä¾›çš„æ—¶é’Ÿæºçš„ç¼–å·ã€‚ é€šè¿‡åœ¨æ—¶é’Ÿæ¶ˆè´¹è€…èŠ‚ç‚¹ä¸­ä½¿ç”¨ clock-indices å±æ€§ï¼Œ å¯ä»¥æ˜ç¡®æŒ‡å®šè¯¥èŠ‚ç‚¹æ‰€éœ€çš„æ—¶é’Ÿæºï¼Œ å¹¶æŒ‰ç…§ç‰¹å®šçš„é¡ºåºè¿›è¡ŒåŒ¹é…ã€‚ ä¸€ä¸ª clock-indices ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºï¼š    </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">scpi_dvfs: clocks<span class="number">-0</span> &#123;</span><br><span class="line">    <span class="meta">#clock-cells = <span class="string">&lt;1&gt;</span>;</span></span><br><span class="line">    clock-indices = &lt;<span class="number">0</span>&gt;, &lt;<span class="number">1</span>&gt;, &lt;<span class="number">2</span>&gt;;</span><br><span class="line">    clock-output-names = <span class="string">&quot;atlclk&quot;</span>, <span class="string">&quot;aplclk&quot;</span>, <span class="string">&quot;gpuclk&quot;</span>;</span><br><span class="line">&#125;;</span><br><span class="line">scpi_clk: clocks<span class="number">-1</span> &#123;</span><br><span class="line">    <span class="meta">#clock-cells = <span class="string">&lt;1&gt;</span>;</span></span><br><span class="line">    clock-indices = &lt;<span class="number">3</span>&gt;;</span><br><span class="line">    clock-output-names = <span class="string">&quot;pxlclk&quot;</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>åœ¨ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ä¸­â€atlclkâ€, â€œaplclkâ€, â€œgpuclkâ€ä¸‰ä¸ªæ—¶é’Ÿæºçš„ç´¢å¼•å°±åˆ†åˆ«è¢«è®¾ç½®ä¸ºäº† 0ã€ 1ã€ 2ï¼Œ åœ¨ç¬¬äºŒä¸ªèŠ‚ç‚¹ä¸­â€pxlclkâ€æ—¶é’Ÿæºçš„ç´¢å¼•å€¼è¢«è®¾ç½®ä¸ºäº† 3.  </p>
<ul>
<li>ï¼ˆ5ï¼‰ assigned-clock-parents</li>
</ul>
<p>assigned-clock-parents å±æ€§ç”¨äºæŒ‡å®šæ—¶é’Ÿæ¶ˆè´¹è€…èŠ‚ç‚¹æ‰€ä½¿ç”¨çš„æ—¶é’Ÿæºçš„çˆ¶æ—¶é’Ÿæºã€‚å®ƒæ˜¯ä¸€ä¸ªæ—¶é’Ÿæºå¼•ç”¨çš„æ•°ç»„ï¼Œ æ¯ä¸ªå…ƒç´ å¯¹åº”ä¸€ä¸ªçˆ¶æ—¶é’Ÿæºçš„å¼•ç”¨ã€‚ åœ¨æ—¶é’Ÿçš„å±‚æ¬¡ç»“æ„ä¸­ï¼Œ æŸäº›æ—¶é’Ÿæºå¯èƒ½æ˜¯å…¶ä»–æ—¶é’Ÿæºçš„çˆ¶æ—¶é’Ÿæºï¼Œ å³å®ƒä»¬æä¾›æ—¶é’Ÿä¿¡å·ç»™å…¶ä»–æ—¶é’Ÿæºä½œä¸ºè¾“å…¥ã€‚ é€šè¿‡åœ¨æ—¶é’Ÿæ¶ˆè´¹è€…èŠ‚ç‚¹ä¸­ä½¿ç”¨ assigned-clock-parents å±æ€§ï¼Œ å¯ä»¥æ˜ç¡®æŒ‡å®šè¯¥èŠ‚ç‚¹æ‰€éœ€çš„çˆ¶æ—¶é’Ÿæºï¼Œ å¹¶æŒ‰ç…§ç‰¹å®šçš„é¡ºåºè¿›è¡ŒåŒ¹é…ã€‚ ä¸€ä¸ªå®é™…çš„ assigned-clock-parents å±æ€§ä¾‹å­å¦‚ä¸‹æ‰€ç¤ºï¼š  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">clock: clock &#123;</span><br><span class="line">    assigned-clocks = &lt;&amp;clkcon <span class="number">0</span>&gt;, &lt;&amp;pll <span class="number">2</span>&gt;;</span><br><span class="line">    assigned-clock-parents = &lt;&amp;pll <span class="number">2</span>&gt;;</span><br><span class="line">    assigned-clock-rates = &lt;<span class="number">115200</span>&gt;, &lt;<span class="number">9600</span>&gt;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>ä¸Šè¿°è®¾å¤‡æ ‘è¡¨ç¤ºäº†ä¸€ä¸ªåä¸º clock çš„æ—¶é’Ÿæ¶ˆè´¹è€…èŠ‚ç‚¹ï¼Œ å…·æœ‰ä»¥ä¸‹å±æ€§ï¼š  </p>
<p>assigned-clocks å±æ€§æŒ‡å®šäº†è¯¥èŠ‚ç‚¹ä½¿ç”¨çš„æ—¶é’Ÿæºï¼Œ å¼•ç”¨äº†ä¸¤ä¸ªæ—¶é’ŸæºèŠ‚ç‚¹ï¼š clkcon 0 å’Œ pll 2ã€‚assigned-clock-parents å±æ€§æŒ‡å®šäº†è¿™äº›æ—¶é’Ÿæºçš„çˆ¶æ—¶é’Ÿæºï¼Œ å¼•ç”¨äº† pll 2 æ—¶é’ŸæºèŠ‚ç‚¹ã€‚assigned-clock-rates å±æ€§æŒ‡å®šäº†æ¯ä¸ªæ—¶é’Ÿæºçš„æ—¶é’Ÿé¢‘ç‡ï¼Œ åˆ†åˆ«æ˜¯ 115200 å’Œ 9600ã€‚  </p>
<h3 id="2-2-æ—¶é’Ÿæ¶ˆè´¹è€…ï¼ˆclock-consumerï¼‰"><a href="#2-2-æ—¶é’Ÿæ¶ˆè´¹è€…ï¼ˆclock-consumerï¼‰" class="headerlink" title="2.2Â æ—¶é’Ÿæ¶ˆè´¹è€…ï¼ˆclock consumerï¼‰"></a><font size=3>2.2Â æ—¶é’Ÿæ¶ˆè´¹è€…ï¼ˆclock consumerï¼‰</font></h3><p>å®šä¹‰ï¼š æ—¶é’Ÿæ¶ˆè´¹è€…æ˜¯ä¾èµ–æ—¶é’Ÿä¿¡å·çš„ç¡¬ä»¶è®¾å¤‡æˆ–æ¨¡å—ã€‚ å®ƒä»¬é€šè¿‡å¼•ç”¨æ—¶é’Ÿç”Ÿäº§è€…èŠ‚ç‚¹æä¾›çš„æ—¶é’Ÿæºæ¥è·å–æ—¶é’Ÿä¿¡å·ã€‚  æ—¶é’Ÿæ¶ˆè´¹è€…å±æ€§å¦‚ä¸‹ï¼š</p>
<ul>
<li>ï¼ˆ1ï¼‰ clocks</li>
</ul>
<p>è¯¥å±æ€§ç”¨äºæŒ‡å®šæ—¶é’Ÿæ¶ˆè´¹è€…èŠ‚ç‚¹æ‰€éœ€çš„æ—¶é’Ÿæºã€‚ å®ƒæ˜¯ä¸€ä¸ªæ•´æ•°æ•°ç»„ï¼Œ æ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªæ—¶é’Ÿç¼–å·ï¼Œ è¡¨ç¤ºæ—¶é’Ÿæ¶ˆè´¹è€…éœ€è¦çš„ä¸€ä¸ªæ—¶é’Ÿæºã€‚  </p>
<ul>
<li>ï¼ˆ2ï¼‰ clock-names</li>
</ul>
<p>å¯é€‰å±æ€§ï¼Œ ç”¨äºæŒ‡å®šæ—¶é’Ÿæ¶ˆè´¹è€…èŠ‚ç‚¹æ‰€éœ€æ—¶é’Ÿæºçš„åç§°ã€‚ å®ƒæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œ ä¸ clocks æ•°ç»„ä¸€ä¸€å¯¹åº”ï¼Œ ç”¨äºæä¾›æ—¶é’Ÿæºçš„æè¿°æ€§åç§°ã€‚</p>
<p>ä¸€ä¸ªæ—¶é’Ÿæ¶ˆè´¹è€…ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">clock: clock &#123;</span><br><span class="line">    clocks = &lt;&amp;cru CLK_VOP&gt;;</span><br><span class="line">    clock-names = <span class="string">&quot;clk_vop&quot;</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>clocks å±æ€§æŒ‡å®šäº†è¯¥èŠ‚ç‚¹ä½¿ç”¨çš„æ—¶é’Ÿæºï¼Œ å¼•ç”¨äº† cru èŠ‚ç‚¹ä¸­çš„ CLK_VOP æ—¶é’Ÿæºã€‚clock-names å±æ€§æŒ‡å®šäº†æ—¶é’Ÿæºçš„åç§°ï¼Œ è¿™é‡Œæ˜¯ â€œclk_vopâ€ã€‚  </p>
<h2 id="3-CPU"><a href="#3-CPU" class="headerlink" title="3. CPU"></a><font size=3>3. CPU</font></h2><h3 id="3-1-cpus-èŠ‚ç‚¹"><a href="#3-1-cpus-èŠ‚ç‚¹" class="headerlink" title="3.1Â cpus èŠ‚ç‚¹  "></a><font size=3>3.1Â cpus èŠ‚ç‚¹  </font></h3><p>è®¾å¤‡æ ‘çš„ cpus èŠ‚ç‚¹æ˜¯ç”¨äºæè¿°ç³»ç»Ÿä¸­çš„å¤„ç†å™¨çš„ä¸€ä¸ªé‡è¦èŠ‚ç‚¹ã€‚ å®ƒæ˜¯å¤„ç†å™¨æ‹“æ‰‘ç»“æ„çš„é¡¶å±‚èŠ‚ç‚¹ï¼Œ åŒ…å«äº†æ‰€æœ‰å¤„ç†å™¨ç›¸å…³çš„ä¿¡æ¯ã€‚   </p>
<ul>
<li>èŠ‚ç‚¹ç»“æ„</li>
</ul>
<p>cpus èŠ‚ç‚¹æ˜¯ä¸€ä¸ªå®¹å™¨èŠ‚ç‚¹ï¼Œ å…¶ä¸‹åŒ…å«äº†ç³»ç»Ÿä¸­æ¯ä¸ªå¤„ç†å™¨çš„å­èŠ‚ç‚¹ã€‚ æ¯ä¸ªå­èŠ‚ç‚¹çš„åç§°é€šå¸¸ä¸º cpu@Xï¼Œ å…¶ä¸­ X æ˜¯å¤„ç†å™¨çš„ç´¢å¼•å·ã€‚ æ¯ä¸ªå­èŠ‚ç‚¹éƒ½åŒ…å«äº†ä¸å¤„ç†å™¨ç›¸å…³çš„å±æ€§ï¼Œ ä¾‹å¦‚æ—¶é’Ÿé¢‘ç‡ã€ ç¼“å­˜å¤§å°ç­‰ã€‚</p>
<ul>
<li>å¤„ç†å™¨å±æ€§</li>
</ul>
<p>cpu@X å­èŠ‚ç‚¹ä¸­çš„å±æ€§å¯ä»¥åŒ…æ‹¬ä»¥ä¸‹ä¿¡æ¯ï¼š  </p>
<p>ï¼ˆ1ï¼‰ device_typeï¼š æŒ‡ç¤ºè®¾å¤‡ç±»å‹ä¸ºå¤„ç†å™¨ï¼ˆâ€cpuâ€ï¼‰ ã€‚</p>
<p>ï¼ˆ2ï¼‰ regï¼š æŒ‡å®šå¤„ç†å™¨çš„åœ°å€èŒƒå›´ï¼Œ é€šå¸¸æ˜¯ç‰©ç†åœ°å€æˆ–å¯„å­˜å™¨åœ°å€ã€‚</p>
<p>ï¼ˆ3ï¼‰ compatibleï¼š æŒ‡å®šå¤„ç†å™¨çš„å…¼å®¹æ€§ä¿¡æ¯ï¼Œ ç”¨äºåŒ¹é…ç›¸åº”çš„è®¾å¤‡é©±åŠ¨ç¨‹åºã€‚</p>
<p>ï¼ˆ4ï¼‰ clock-frequencyï¼š æŒ‡å®šå¤„ç†å™¨çš„æ—¶é’Ÿé¢‘ç‡ã€‚</p>
<p>ï¼ˆ5ï¼‰ cache-sizeï¼š æŒ‡å®šå¤„ç†å™¨çš„ç¼“å­˜å¤§å°ã€‚</p>
<ul>
<li>å¤„ç†å™¨æ‹“æ‰‘å…³ç³»</li>
</ul>
<p>é™¤äº†å¤„ç†å™¨çš„åŸºæœ¬å±æ€§ï¼Œ cpus èŠ‚ç‚¹è¿˜å¯ä»¥åŒ…å«å…¶ä»–ç”¨äºæè¿°å¤„ç†å™¨æ‹“æ‰‘å…³ç³»çš„èŠ‚ç‚¹ï¼Œ ä»¥æä¾›æ›´è¯¦ç»†çš„å¤„ç†å™¨æ‹“æ‰‘ä¿¡æ¯ã€‚ è¿™äº›èŠ‚ç‚¹å¯ä»¥å¸®åŠ©æ“ä½œç³»ç»Ÿå’Œè½¯ä»¶äº†è§£å¤„ç†å™¨ä¹‹é—´çš„è¿æ¥å…³ç³»ã€ç»„ç»‡ç»“æ„å’Œç‰¹æ€§ã€‚  </p>
<p>ï¼ˆ1ï¼‰cpu-map èŠ‚ç‚¹ï¼š æè¿°å¤„ç†å™¨çš„æ˜ å°„å…³ç³»ï¼Œ é€šå¸¸åœ¨å¤šæ ¸å¤„ç†å™¨ç³»ç»Ÿä¸­ä½¿ç”¨ã€‚</p>
<p>ï¼ˆ2ï¼‰socket èŠ‚ç‚¹ï¼š æè¿°å¤šå¤„ç†å™¨ç³»ç»Ÿä¸­çš„ç‰©ç†æ’æ§½æˆ–èŠ¯ç‰‡ç»„ã€‚</p>
<p>ï¼ˆ3ï¼‰cluster èŠ‚ç‚¹ï¼š æè¿°å¤„ç†å™¨é›†ç¾¤ï¼Œ å³å°†å¤šä¸ªå¤„ç†å™¨ç»„ç»‡åœ¨ä¸€èµ·å½¢æˆçš„é€»è¾‘ç»„ã€‚</p>
<p>ï¼ˆ4ï¼‰core èŠ‚ç‚¹ï¼š æè¿°å¤„ç†å™¨æ ¸å¿ƒï¼Œ å³ä¸€ä¸ªç‰©ç†å¤„ç†å™¨å†…çš„ç‹¬ç«‹æ‰§è¡Œå•å…ƒã€‚</p>
<p>ï¼ˆ5ï¼‰thread èŠ‚ç‚¹ï¼š æè¿°å¤„ç†å™¨çº¿ç¨‹ï¼Œ å³ä¸€ä¸ªç‰©ç†å¤„ç†å™¨æ ¸å¿ƒå†…çš„çº¿ç¨‹ã€‚</p>
<p>è¿™äº›èŠ‚ç‚¹çš„åµŒå¥—å…³ç³»å¯ä»¥åœ¨ cpus èŠ‚ç‚¹ä¸‹å½¢æˆä¸€ä¸ªå±‚æ¬¡ç»“æ„ï¼Œ åæ˜ äº†å¤„ç†å™¨çš„æ‹“æ‰‘ç»“æ„ã€‚ä¸Šè¿°è¿™äº›èŠ‚ç‚¹ä¼šåœ¨åé¢çš„å°èŠ‚è¿›è¡Œä»‹ç»ã€‚ ä¸€ä¸ªå•æ ¸ CPU è®¾å¤‡æ ‘å’Œä¸€ä¸ªå››æ ¸ CPU è®¾å¤‡æ ‘ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºï¼š  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å•æ ¸CPU</span></span><br><span class="line">cpus &#123;</span><br><span class="line">    <span class="meta">#address-cells = <span class="string">&lt;1&gt;</span>;</span></span><br><span class="line">    <span class="meta">#size-cells = <span class="string">&lt;0&gt;</span>;</span></span><br><span class="line">    cpu0: cpu@<span class="number">0</span> &#123;</span><br><span class="line">        compatible = <span class="string">&quot;arm,cortex-a7&quot;</span>;</span><br><span class="line">        device_type = <span class="string">&quot;cpu&quot;</span>;</span><br><span class="line">        <span class="comment">// å…¶ä»–å±æ€§...</span></span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤šæ ¸CPU</span></span><br><span class="line">cpus &#123;</span><br><span class="line">    <span class="meta">#address-cells = <span class="string">&lt;1&gt;</span>;</span></span><br><span class="line">    <span class="meta">#size-cells = <span class="string">&lt;0&gt;</span>;</span></span><br><span class="line">    cpu0: cpu@<span class="number">0</span> &#123;</span><br><span class="line">        device_type = <span class="string">&quot;cpu&quot;</span>;</span><br><span class="line">        compatible = <span class="string">&quot;arm,cortex-a9&quot;</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    cpu1: cpu@<span class="number">1</span> &#123;</span><br><span class="line">        device_type = <span class="string">&quot;cpu&quot;</span>;</span><br><span class="line">        compatible = <span class="string">&quot;arm,cortex-a9&quot;</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    cpu2: cpu@<span class="number">2</span> &#123;</span><br><span class="line">        device_type = <span class="string">&quot;cpu&quot;</span>;</span><br><span class="line">        compatible = <span class="string">&quot;arm,cortex-a9&quot;</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    cpu3: cpu@<span class="number">3</span> &#123;</span><br><span class="line">        device_type = <span class="string">&quot;cpu&quot;</span>;</span><br><span class="line">        compatible = <span class="string">&quot;arm,cortex-a9&quot;</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>c pus èŠ‚ç‚¹æ˜¯ä¸€ä¸ªå®¹å™¨èŠ‚ç‚¹ï¼Œ åŒ…å«äº† cpu0 å­èŠ‚ç‚¹ã€‚ è¯¥èŠ‚ç‚¹ä½¿ç”¨äº† #address-cells å’Œ #size-cell s å±æ€§æ¥æŒ‡å®šåœ°å€å’Œå¤§å°çš„å•å…ƒæ•°é‡ã€‚cpu0 å­èŠ‚ç‚¹ä»£è¡¨ç¬¬ä¸€ä¸ªå¤„ç†å™¨ï¼Œcompatible å±æ€§æŒ‡å®šäº†å¤„ç†å™¨çš„å…¼å®¹æ€§ä¿¡æ¯ï¼Œdevice_type å±æ€§æŒ‡ç¤ºè®¾å¤‡ç±»å‹ä¸ºå¤„ç†å™¨ã€‚è¿˜å¯ä»¥åœ¨æ­¤åŸºç¡€ä¸Šç»§ç»­æ·»åŠ å…¶ä»–å±æ€§æ¥æè¿°å¤„ç†å™¨çš„ç‰¹æ€§ï¼Œ å¦‚æ—¶é’Ÿé¢‘ç‡ã€ ç¼“å­˜å¤§å°ç­‰ã€‚    </p>
<h3 id="3-2-cpu-mapã€-socketã€-cluster-èŠ‚ç‚¹"><a href="#3-2-cpu-mapã€-socketã€-cluster-èŠ‚ç‚¹" class="headerlink" title="3.2Â cpu-mapã€ socketã€ cluster èŠ‚ç‚¹  "></a><font size=3>3.2Â cpu-mapã€ socketã€ cluster èŠ‚ç‚¹  </font></h3><p>cpu-map èŠ‚ç‚¹æ˜¯è®¾å¤‡æ ‘ä¸­ç”¨äºæè¿°å¤§å°æ ¸æ¶æ„å¤„ç†å™¨çš„æ˜ å°„å…³ç³»çš„èŠ‚ç‚¹ä¹‹ä¸€ã€‚ å®ƒçš„çˆ¶èŠ‚ç‚¹å¿…é¡»æ˜¯ cpus èŠ‚ç‚¹ï¼Œ è€Œå­èŠ‚ç‚¹å¯ä»¥æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ª cluster å’Œ socket èŠ‚ç‚¹ã€‚ é€šè¿‡ cpu-map èŠ‚ç‚¹ï¼Œ å¯ä»¥å®šä¹‰ä¸åŒæ ¸å¿ƒå’Œé›†ç¾¤ä¹‹é—´çš„è¿æ¥å’Œç»„ç»‡ç»“æ„ã€‚  </p>
<p>socket èŠ‚ç‚¹ç”¨äºæè¿°å¤„ç†å™¨æ’æ§½ï¼ˆsocketï¼‰ ä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚ æ¯ä¸ª socket å­èŠ‚ç‚¹è¡¨ç¤ºä¸€ä¸ªå¤„ç†å™¨æ’æ§½ï¼Œ å¯ä»¥ä½¿ç”¨ cpu-map-mask å±æ€§æ¥æŒ‡å®šè¯¥æ’æ§½ä½¿ç”¨çš„æ ¸å¿ƒã€‚ é€šè¿‡ä¸ºæ¯ä¸ª socket å­èŠ‚ç‚¹æŒ‡å®šé€‚å½“çš„ cpu-map-maskï¼Œ å¯ä»¥å®šä¹‰ä¸åŒæ’æ§½ä¸­ä½¿ç”¨çš„æ ¸å¿ƒã€‚ è¿™æ ·ï¼Œ æ“ä½œç³»ç»Ÿå’Œè½¯ä»¶å¯ä»¥äº†è§£åˆ°ä¸åŒæ’æ§½ä¹‹é—´çš„æ ¸å¿ƒåˆ†é…æƒ…å†µã€‚    </p>
<p>cluster èŠ‚ç‚¹ç”¨äºæè¿°æ ¸å¿ƒï¼ˆclusterï¼‰ ä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚ æ¯ä¸ª cluster å­èŠ‚ç‚¹è¡¨ç¤ºä¸€ä¸ªæ ¸å¿ƒé›†ç¾¤ï¼Œ å¯ä»¥ä½¿ç”¨ cpu-map-mask å±æ€§æ¥æŒ‡å®šè¯¥é›†ç¾¤ä½¿ç”¨çš„æ ¸å¿ƒã€‚ é€šè¿‡ä¸ºæ¯ä¸ª cluster å­èŠ‚ç‚¹æŒ‡å®šé€‚å½“çš„ cpu-map-maskï¼Œ å¯ä»¥å®šä¹‰æ¯ä¸ªé›†ç¾¤ä¸­ä½¿ç”¨çš„æ ¸å¿ƒã€‚ è¿™æ ·ï¼Œ æ“ä½œç³»ç»Ÿå’Œè½¯ä»¶å¯ä»¥äº†è§£åˆ°ä¸åŒé›†ç¾¤ä¹‹é—´çš„æ ¸å¿ƒåˆ†é…æƒ…å†µã€‚  </p>
<p>é€šè¿‡åœ¨ cpu-map èŠ‚ç‚¹ä¸­å®šä¹‰ socket å’Œ cluster å­èŠ‚ç‚¹ï¼Œ å¹¶ä¸ºå®ƒä»¬æŒ‡å®šé€‚å½“çš„ cpu-map-maskï¼Œå¯ä»¥æä¾›å¤„ç†å™¨çš„æ‹“æ‰‘ç»“æ„ä¿¡æ¯ã€‚ è¿™å¯¹äºæ“ä½œç³»ç»Ÿå’Œè½¯ä»¶æ¥è¯´éå¸¸æœ‰ç”¨ï¼Œ å› ä¸ºå®ƒä»¬å¯ä»¥æ ¹æ®è¿™äº›ä¿¡æ¯è¿›è¡Œä»»åŠ¡è°ƒåº¦å’Œèµ„æºåˆ†é…çš„ä¼˜åŒ–ï¼Œ ä»¥å……åˆ†åˆ©ç”¨å¤§å°æ ¸æ¶æ„å¤„ç†å™¨çš„æ€§èƒ½å’Œèƒ½æ•ˆç‰¹æ€§ã€‚  </p>
<p>ä¸€ä¸ªå¤§å°æ ¸æ¶æ„çš„å…·ä½“ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºï¼š  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">cpus &#123;</span><br><span class="line">    <span class="meta">#address-cells = <span class="string">&lt;2&gt;</span>;</span></span><br><span class="line">    <span class="meta">#size-cells = <span class="string">&lt;0&gt;</span>;</span></span><br><span class="line">    cpu-<span class="built_in">map</span> &#123;</span><br><span class="line">        cluster0 &#123;</span><br><span class="line">            core0 &#123;</span><br><span class="line">                cpu = &lt;&amp;cpu_l0&gt;;</span><br><span class="line">            &#125;;</span><br><span class="line">            core1 &#123;</span><br><span class="line">                cpu = &lt;&amp;cpu_l1&gt;;</span><br><span class="line">            &#125;;</span><br><span class="line">            core2 &#123;</span><br><span class="line">                cpu = &lt;&amp;cpu_l2&gt;;</span><br><span class="line">            &#125;;</span><br><span class="line">            core3 &#123;</span><br><span class="line">                cpu = &lt;&amp;cpu_l3&gt;;</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;;</span><br><span class="line">        cluster1 &#123;</span><br><span class="line">            core0 &#123;</span><br><span class="line">                cpu = &lt;&amp;cpu_b0&gt;;</span><br><span class="line">            &#125;;</span><br><span class="line">            core1 &#123;</span><br><span class="line">                cpu = &lt;&amp;cpu_b1&gt;;</span><br><span class="line">            &#125;;</span><br><span class="line">		&#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">    cpu_l0: cpu@<span class="number">0</span> &#123;</span><br><span class="line">        device_type = <span class="string">&quot;cpu&quot;</span>;</span><br><span class="line">    	compatible = <span class="string">&quot;arm,cortex-a53&quot;</span>, <span class="string">&quot;arm,armv8&quot;</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    cpu_l1: cpu@<span class="number">1</span> &#123;</span><br><span class="line">        device_type = <span class="string">&quot;cpu&quot;</span>;</span><br><span class="line">        compatible = <span class="string">&quot;arm,cortex-a53&quot;</span>, <span class="string">&quot;arm,armv8&quot;</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    cpu_l2: cpu@<span class="number">2</span> &#123;</span><br><span class="line">        device_type = <span class="string">&quot;cpu&quot;</span>;</span><br><span class="line">        compatible = <span class="string">&quot;arm,cortex-a53&quot;</span>, <span class="string">&quot;arm,armv8&quot;</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    cpu_l3: cpu@<span class="number">3</span> &#123;</span><br><span class="line">        device_type = <span class="string">&quot;cpu&quot;</span>;</span><br><span class="line">        compatible = <span class="string">&quot;arm,cortex-a53&quot;</span>, <span class="string">&quot;arm,armv8&quot;</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    cpu_b0: cpu@<span class="number">100</span> &#123;</span><br><span class="line">        device_type = <span class="string">&quot;cpu&quot;</span>;</span><br><span class="line">        compatible = <span class="string">&quot;arm,cortex-a72&quot;</span>, <span class="string">&quot;arm,armv8&quot;</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    cpu_b1: cpu@<span class="number">101</span> &#123;</span><br><span class="line">        device_type = <span class="string">&quot;cpu&quot;</span>;</span><br><span class="line">        compatible = <span class="string">&quot;arm,cortex-a72&quot;</span>, <span class="string">&quot;arm,armv8&quot;</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªè®¾å¤‡æ ‘æè¿°äº†ä¸€ä¸ªå…·æœ‰å¤šä¸ª CPU æ ¸å¿ƒçš„ç³»ç»Ÿï¼Œ åŒ…æ‹¬å››ä¸ª Cortex-A53 æ ¸å¿ƒå’Œä¸¤ä¸ªCortex-A72 æ ¸å¿ƒã€‚ </p>
<p>ï¼ˆ1ï¼‰#address-cells &#x3D; &lt;2&gt;; å’Œ #size-cells &#x3D; &lt;0&gt;;ï¼š è¿™äº›å±æ€§æŒ‡å®šäº†è®¾å¤‡æ ‘ä¸­åœ°å€å’Œå¤§å°çš„ç¼–ç æ–¹å¼ã€‚</p>
<p>ï¼ˆ2ï¼‰cpu-map ï¼š è¿™ä¸ªèŠ‚ç‚¹å®šä¹‰äº†CPUçš„æ˜ å°„å…³ç³»ã€‚å®ƒåŒ…å«äº†ä¸¤ä¸ªç°‡ï¼ˆ clusters ï¼‰ ï¼š cluster0 å’Œ cluster1ã€‚ cluster0 åŒ…å«äº†å››ä¸ªæ ¸å¿ƒï¼š core0ã€ core1ã€ core2 å’Œ core3ï¼Œ åˆ†åˆ«å¯¹åº” cpu_l0ã€cpu_l1ã€ cpu_l2 å’Œ cpu_l3ã€‚ cluster1 åŒ…å«äº†ä¸¤ä¸ªæ ¸å¿ƒï¼š core0 å’Œ core1ï¼Œ åˆ†åˆ«å¯¹åº” cpu_b0 å’Œ cpu_b1ã€‚    </p>
<p>ï¼ˆ3ï¼‰cpu_l0ã€ cpu_l1ã€ cpu_l2 å’Œ cpu_l3ï¼š è¿™äº›èŠ‚ç‚¹æè¿°äº† Cortex-A53 æ ¸å¿ƒã€‚ å®ƒä»¬å…·æœ‰ç›¸åŒçš„è®¾å¤‡ç±»å‹ cpu å’Œå…¼å®¹æ€§å±æ€§ â€œarm,cortex-a53â€, â€œarm,armv8â€ã€‚  </p>
<p>ï¼ˆ4ï¼‰cpu_b0 å’Œ cpu_b1ï¼š è¿™äº›èŠ‚ç‚¹æè¿°äº† Cortex-A72 æ ¸å¿ƒã€‚ å®ƒä»¬å…·æœ‰ç›¸åŒçš„è®¾å¤‡ç±»å‹ cpu å’Œå…¼å®¹æ€§å±æ€§ â€œarm,cortex-a72â€, â€œarm,armv8â€ã€‚    </p>
<h3 id="3-3-coreã€-thread-èŠ‚ç‚¹"><a href="#3-3-coreã€-thread-èŠ‚ç‚¹" class="headerlink" title="3.3Â coreã€ thread èŠ‚ç‚¹  "></a><font size=3>3.3Â coreã€ thread èŠ‚ç‚¹  </font></h3><p>â€œcoreâ€ å’Œ â€œthreadâ€ èŠ‚ç‚¹é€šå¸¸ç”¨äºæè¿°å¤„ç†å™¨æ ¸å¿ƒå’Œçº¿ç¨‹çš„é…ç½®ã€‚</p>
<ul>
<li><p>Core èŠ‚ç‚¹ç”¨äºæè¿°å¤„ç†å™¨çš„æ ¸å¿ƒã€‚ ä¸€ä¸ªå¤„ç†å™¨é€šå¸¸ç”±å¤šä¸ªæ ¸å¿ƒç»„æˆï¼Œ æ¯ä¸ªæ ¸å¿ƒå¯ä»¥ç‹¬ç«‹æ‰§è¡ŒæŒ‡ä»¤å’Œä»»åŠ¡ã€‚</p>
</li>
<li><p>Thread èŠ‚ç‚¹ç”¨äºæè¿°å¤„ç†å™¨çš„çº¿ç¨‹ã€‚ çº¿ç¨‹æ˜¯åœ¨å¤„ç†å™¨æ ¸å¿ƒä¸Šæ‰§è¡Œçš„åŸºæœ¬æ‰§è¡Œå•å…ƒï¼Œ æ¯ä¸ªæ ¸å¿ƒå¯ä»¥æ”¯æŒå¤šä¸ªçº¿ç¨‹ã€‚</p>
</li>
</ul>
<p>é€šè¿‡ä½¿ç”¨ Core å’Œ Thread èŠ‚ç‚¹ï¼Œ è®¾å¤‡æ ‘å¯ä»¥å‡†ç¡®æè¿°å¤„ç†å™¨çš„æ ¸å¿ƒå’Œçº¿ç¨‹çš„é…ç½®ï¼Œ ä¾‹å¦‚å¯ä»¥ä½¿ç”¨è®¾å¤‡æ ‘æ¥æè¿°ä¸€ä¸ªå…·æœ‰ 16 ä¸ªæ ¸å¿ƒçš„ CPUï¼Œ ä¸€ä¸ªç‰©ç†æ’æ§½ï¼Œ æ¯ä¸ªé›†ç¾¤ä¸­æœ‰ä¸¤ä¸ªæ ¸å¿ƒï¼Œæ¯ä¸ªæ ¸å¿ƒæœ‰ä¸¤ä¸ªçº¿ç¨‹çš„è®¾å¤‡æ ‘ç¤ºä¾‹ï¼Œ å…·ä½“è®¾å¤‡æ ‘å¦‚ä¸‹æ‰€ç¤ºï¼š  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">cpus &#123;</span><br><span class="line">    <span class="meta">#address-cells = <span class="string">&lt;2&gt;</span>;</span></span><br><span class="line">    cpu-<span class="built_in">map</span> &#123;</span><br><span class="line">        socket0 &#123;</span><br><span class="line">            cluster0 &#123;</span><br><span class="line">                core0 &#123;</span><br><span class="line">                    thread0 &#123;</span><br><span class="line">                        cpu = &lt;&amp;CPU0&gt;;</span><br><span class="line">                    &#125;;</span><br><span class="line">                    thread1 &#123;</span><br><span class="line">                        cpu = &lt;&amp;CPU1&gt;;</span><br><span class="line">                    &#125;;</span><br><span class="line">                &#125;;</span><br><span class="line">                    core1 &#123;</span><br><span class="line">                    thread0 &#123;</span><br><span class="line">                        cpu = &lt;&amp;CPU2&gt;;</span><br><span class="line">                    &#125;;</span><br><span class="line">                    thread1 &#123;</span><br><span class="line">                        cpu = &lt;&amp;CPU3&gt;;</span><br><span class="line">                    &#125;;</span><br><span class="line">                &#125;;</span><br><span class="line">            &#125;;</span><br><span class="line">            cluster1 &#123;</span><br><span class="line">                core0 &#123;</span><br><span class="line">                    thread0 &#123;</span><br><span class="line">                        cpu = &lt;&amp;CPU4&gt;;</span><br><span class="line">                    &#125;;</span><br><span class="line">                    thread1 &#123;</span><br><span class="line">                        cpu = &lt;&amp;CPU5&gt;;</span><br><span class="line">                    &#125;;</span><br><span class="line">                &#125;;</span><br><span class="line">                core1 &#123;</span><br><span class="line">                    thread0 &#123;</span><br><span class="line">                        cpu = &lt;&amp;CPU6&gt;;</span><br><span class="line">                    &#125;;</span><br><span class="line">                    thread1 &#123;</span><br><span class="line">                        cpu = &lt;&amp;CPU7&gt;;</span><br><span class="line">                    &#125;;</span><br><span class="line">                &#125;;</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;;</span><br><span class="line">        socket1 &#123;</span><br><span class="line">            cluster0 &#123;</span><br><span class="line">                core0 &#123;</span><br><span class="line">                    thread0 &#123;</span><br><span class="line">                        cpu = &lt;&amp;CPU8&gt;;</span><br><span class="line">                    &#125;;</span><br><span class="line">                    thread1 &#123;</span><br><span class="line">                        cpu = &lt;&amp;CPU9&gt;;</span><br><span class="line">                    &#125;;</span><br><span class="line">                &#125;;</span><br><span class="line">                core1 &#123;</span><br><span class="line">                    thread0 &#123;</span><br><span class="line">                        cpu = &lt;&amp;CPU10&gt;;</span><br><span class="line">                    &#125;;</span><br><span class="line">                    thread1 &#123;</span><br><span class="line">                        cpu = &lt;&amp;CPU11&gt;;</span><br><span class="line">                    &#125;;</span><br><span class="line">                &#125;;</span><br><span class="line">            &#125;;</span><br><span class="line">            cluster1 &#123;</span><br><span class="line">                core0 &#123;</span><br><span class="line">                    thread0 &#123;</span><br><span class="line">                        cpu = &lt;&amp;CPU12&gt;;</span><br><span class="line">                    &#125;;</span><br><span class="line">                    thread1 &#123;</span><br><span class="line">                        cpu = &lt;&amp;CPU13&gt;;</span><br><span class="line">                    &#125;;</span><br><span class="line">                &#125;;</span><br><span class="line">                core1 &#123;</span><br><span class="line">                    thread0 &#123;</span><br><span class="line">                        cpu = &lt;&amp;CPU14&gt;;</span><br><span class="line">                    &#125;;</span><br><span class="line">                    thread1 &#123;</span><br><span class="line">                        cpu = &lt;&amp;CPU15&gt;;</span><br><span class="line">                    &#125;;</span><br><span class="line">                &#125;;</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="4-GPIO"><a href="#4-GPIO" class="headerlink" title="4. GPIO"></a><font size=3>4. GPIO</font></h2><h3 id="4-1-gpioç›¸å…³å±æ€§"><a href="#4-1-gpioç›¸å…³å±æ€§" class="headerlink" title="4.1 gpioç›¸å…³å±æ€§"></a><font size=3>4.1 gpioç›¸å…³å±æ€§</font></h3><p>ä¸‹é¢çš„æ˜¯ iTOP-RK3568 å¼€å‘æ¿ SDK æºç ä¸­çš„ ft5x06 è®¾å¤‡æ ‘ä¸­å…³äº gpio ç›¸å…³çš„æè¿°ï¼Œ åŒ…æ‹¬äº† interruptsã€ interrupt-controllerã€ #interrupt-cellsã€ interrupt-parentå››ç§å¸¸è§å±æ€§ï¼š  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">gpio0: gpio@fdd60000 &#123;</span><br><span class="line">    compatible = <span class="string">&quot;rockchip,gpio-bank&quot;</span>;</span><br><span class="line">    reg = &lt;<span class="number">0x0</span> <span class="number">0xfdd60000</span> <span class="number">0x0</span> <span class="number">0x100</span>&gt;;</span><br><span class="line">    interrupts = &lt;GIC_SPI <span class="number">33</span> IRQ_TYPE_LEVEL_HIGH&gt;;</span><br><span class="line">    clocks = &lt;&amp;pmucru PCLK_GPI00&gt;, &lt;&amp;pmucru DBCLK_GPI00&gt;;</span><br><span class="line">    gpio-controller;</span><br><span class="line">    <span class="meta">#gpio-cells = <span class="string">&lt;2&gt;</span>;</span></span><br><span class="line">    gpio-ranges = &lt;&amp;pinctrl <span class="number">0</span> <span class="number">0</span> <span class="number">32</span>&gt;;</span><br><span class="line">    interrupt-controller;</span><br><span class="line">    <span class="meta">#interrupt-cells = <span class="string">&lt;2&gt;</span>;</span></span><br><span class="line">&#125;;</span><br><span class="line">ft5x06: ft5x06@<span class="number">38</span> &#123;</span><br><span class="line">    status = <span class="string">&quot;disabled&quot;</span>;</span><br><span class="line">    compatible = <span class="string">&quot;edt,edt-ft5306&quot;</span>;</span><br><span class="line">    reg = &lt;<span class="number">0x38</span>&gt;;</span><br><span class="line">    touch-gpio = &lt;&amp;gpio0 RK_PB5 IRQ_TYPE_EDGE_RISING&gt;;</span><br><span class="line">    interrupt-parent = &lt;&amp;gpio0&gt;;</span><br><span class="line">    interrupts = &lt;RK_PB5 IRQ_TYPE_LEVEL_LOW&gt;;</span><br><span class="line">    reset-gpios = &lt;&amp;gpio0 RK_PB6 GPIO_ACTIVE_LOW&gt;;</span><br><span class="line">    touchscreen-size-x = &lt;<span class="number">800</span>&gt;;</span><br><span class="line">    touchscreen-size-y = &lt;<span class="number">1280</span>&gt;;</span><br><span class="line">    touch_type = &lt;<span class="number">1</span>&gt;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="4-1-1-gpio-controller"><a href="#4-1-1-gpio-controller" class="headerlink" title="4.1.1Â gpio-controller"></a><font size=3>4.1.1Â gpio-controller</font></h4><p>gpio-controller å±æ€§ç”¨äºæ ‡è¯†ä¸€ä¸ªè®¾å¤‡èŠ‚ç‚¹ä½œä¸º GPIO æ§åˆ¶å™¨ã€‚ GPIO æ§åˆ¶å™¨æ˜¯è´Ÿè´£ç®¡ç†å’Œæ§åˆ¶ GPIO å¼•è„šçš„ç¡¬ä»¶æ¨¡å—æˆ–é©±åŠ¨ç¨‹åºã€‚é€šå¸¸ä½œä¸ºè®¾å¤‡èŠ‚ç‚¹çš„ä¸€ä¸ªå±æ€§å‡ºç°ï¼Œ ä½äºè®¾å¤‡èŠ‚ç‚¹çš„å±æ€§åˆ—è¡¨ä¸­ã€‚    </p>
<p>å½“ä¸€ä¸ªè®¾å¤‡èŠ‚ç‚¹è¢«æ ‡è¯†ä¸º GPIO æ§åˆ¶å™¨æ—¶ï¼Œ å®ƒé€šå¸¸ä¼šå®šä¹‰ä¸€ç»„ GPIO å¼•è„šï¼Œ å¹¶æä¾›ç›¸å…³çš„GPIO æ§åˆ¶å’Œé…ç½®åŠŸèƒ½ã€‚ å…¶ä»–è®¾å¤‡èŠ‚ç‚¹å¯ä»¥ä½¿ç”¨è¯¥ GPIO æ§åˆ¶å™¨æ¥æ§åˆ¶å’Œç®¡ç†å…¶ GPIO å¼•è„šã€‚  </p>
<p>é€šè¿‡ä½¿ç”¨ gpio-controller å±æ€§ï¼Œ è®¾å¤‡æ ‘å¯ä»¥æ˜ç¡®æ ‡è¯†å‡º GPIO æ§åˆ¶å™¨è®¾å¤‡èŠ‚ç‚¹ï¼Œ ä½¿ç³»ç»Ÿå¯ä»¥æ­£ç¡®è¯†åˆ«å’Œç®¡ç† GPIO å¼•è„šçš„é…ç½®å’Œæ§åˆ¶ã€‚  </p>
<h4 id="4-1-2-gpio-cells"><a href="#4-1-2-gpio-cells" class="headerlink" title="4.1.2Â #gpio-cells  "></a><font size=3>4.1.2Â #gpio-cells  </font></h4><p>#gpio-cells å±æ€§ç”¨äºæŒ‡å®š GPIO å¼•è„šæè¿°ç¬¦çš„ç¼–ç æ–¹å¼ã€‚ GPIO å¼•è„šæè¿°ç¬¦æ˜¯ç”¨äºæ ‡è¯†å’Œé…ç½® GPIO å¼•è„šçš„ä¸€ç»„å€¼ï¼Œ ä¾‹å¦‚å¼•è„šç¼–å·ã€ å¼•è„šå±æ€§ç­‰ã€‚è¿™ä¸ªå±æ€§çš„å±æ€§å€¼æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œ è¡¨ç¤ºç”¨äºç¼–ç  GPIO å¼•è„šæè¿°ç¬¦çš„å•å…ƒæ•°ã€‚ é€šå¸¸ï¼Œè¿™ä¸ªå€¼ä¸º 2ã€‚  </p>
<p>åœ¨ç¤ºä¾‹ä¸­æœ‰ 1 ä¸ª gpio å¼•è„šæè¿°å±æ€§,ç”±äº#gpio-cells å±æ€§è¢«è®¾ç½®ä¸ºäº† 2ï¼Œ æ‰€ä»¥æ¯ä¸ªå¼•è„šæè¿°å±æ€§ä¸­ä¼šæœ‰ä¸¤ä¸ªæ•´æ•°ï¼Œ å…·ä½“å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ft5x06: ft5x06@<span class="number">38</span> &#123;</span><br><span class="line">    <span class="comment">//.....</span></span><br><span class="line">    reset-gpios = &lt;&amp;gpio0 RK_PB6 GPIO_ACTIVE_LOW&gt;;</span><br><span class="line">    <span class="comment">//.....</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡ä½¿ç”¨#gpio-cells å±æ€§ï¼Œ è®¾å¤‡æ ‘å¯ä»¥æŒ‡å®š GPIO å¼•è„šæè¿°ç¬¦çš„ç¼–ç æ–¹å¼ï¼Œ ä½¿ç³»ç»Ÿèƒ½å¤Ÿæ­£ç¡®è¯†åˆ«å’Œè§£æ GPIO å¼•è„šçš„é…ç½®å’Œæ§åˆ¶ã€‚  </p>
<h4 id="4-1-3-gpio-ranges"><a href="#4-1-3-gpio-ranges" class="headerlink" title="4.1.3Â gpio-ranges"></a><font size=3>4.1.3Â gpio-ranges</font></h4><p>gpio-ranges å±æ€§æ˜¯è®¾å¤‡æ ‘ä¸­ä¸€ä¸ªç”¨äºæè¿° GPIO èŒƒå›´æ˜ å°„çš„å±æ€§ã€‚ å®ƒé€šå¸¸ç”¨äºæè¿°å…·æœ‰å¤§é‡ GPIO å¼•è„šçš„ GPIO æ§åˆ¶å™¨ï¼Œ ä»¥ç®€åŒ– GPIO å¼•è„šçš„ç¼–ç å’Œè®¿é—®ã€‚  </p>
<p>åœ¨è®¾å¤‡æ ‘ä¸­ï¼Œ GPIO æ§åˆ¶å™¨çš„æ¯ä¸ªå¼•è„šéƒ½æœ‰ä¸€ä¸ªæœ¬åœ°ç¼–å·ï¼Œ ç”¨äºåœ¨æ§åˆ¶å™¨å†…éƒ¨è¿›è¡Œå¼•è„šå¯»å€ã€‚ ç„¶è€Œï¼Œ è¿™äº›æœ¬åœ°ç¼–å·å¹¶ä¸ä¸€å®šä¸å¤–éƒ¨å¼•è„šçš„ç‰©ç†ç¼–å·æˆ–å…¶ä»–ç³»ç»Ÿä¸­ä½¿ç”¨çš„ç¼–å·ä¸€è‡´ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œ å¯ä»¥ä½¿ç”¨ gpio-ranges å±æ€§å°†æœ¬åœ°ç¼–å·æ˜ å°„åˆ°å®é™…çš„å¼•è„šç¼–å·ã€‚  </p>
<p>gpio-rangeså±æ€§æ˜¯ä¸€ä¸ªåŒ…å«ä¸€ç³»åˆ—æ•´æ•°å€¼çš„åˆ—è¡¨ï¼Œ æ¯ä¸ªæ•´æ•°å€¼å¯¹åº”äºè®¾å¤‡æ ‘ä¸­çš„ä¸€ä¸ªGPIOæ§åˆ¶å™¨ã€‚ åˆ—è¡¨ä¸­çš„æ¯ä¸ªæ•´æ•°å€¼æŒ‰ç…§ç‰¹å®šçš„é¡ºåºæä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š  </p>
<p>ï¼ˆ1ï¼‰ å¤–éƒ¨å¼•è„šç¼–å·çš„èµ·å§‹å€¼ã€‚</p>
<p>ï¼ˆ2ï¼‰ GPIO æ§åˆ¶å™¨å†…éƒ¨æœ¬åœ°ç¼–å·çš„èµ·å§‹å€¼ã€‚</p>
<p>ï¼ˆ3ï¼‰ å¼•è„šèŒƒå›´çš„å¤§å°ï¼ˆå¼•è„šæ•°é‡ï¼‰ ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">gpio0: gpio@fdd60000 &#123;</span><br><span class="line">    <span class="comment">//......</span></span><br><span class="line">    gpio-controller;</span><br><span class="line">    <span class="meta">#gpio-cells = <span class="string">&lt;2&gt;</span>;</span></span><br><span class="line">    gpio-ranges = &lt;&amp;pinctrl <span class="number">0</span> <span class="number">0</span> <span class="number">32</span>&gt;;</span><br><span class="line">	<span class="comment">//......</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>gpio-ranges å±æ€§çš„å€¼ä¸º&lt;&amp;pinctrl 0 0 32&gt;ï¼Œ å…¶ä¸­&lt;&amp;pinctrl&gt;è¡¨ç¤ºå¼•ç”¨äº†åä¸º pinctrl çš„å¼•è„šæ§åˆ¶å™¨èŠ‚ç‚¹ï¼Œ 0 0 32 è¡¨ç¤ºå¤–éƒ¨å¼•è„šä» 0 å¼€å§‹ï¼Œ æ§åˆ¶å™¨æœ¬åœ°ç¼–å·ä» 0 å¼€å§‹ï¼Œ å…±æ˜ å°„äº† 32 ä¸ªå¼•è„šã€‚  </p>
<p>è¿™æ ·ï¼Œ gpio-ranges å±æ€§å°† GPIO æ§åˆ¶å™¨çš„æœ¬åœ°ç¼–å·ç›´æ¥æ˜ å°„åˆ°å¤–éƒ¨å¼•è„šç¼–å·ï¼Œ ä½¿å¾— GPIO å¼•è„šçš„ç¼–ç å’Œè®¿é—®æ›´åŠ ç®€æ´å’Œç›´è§‚ã€‚  </p>
<h4 id="4-1-4-gpio-å¼•è„šæè¿°å±æ€§"><a href="#4-1-4-gpio-å¼•è„šæè¿°å±æ€§" class="headerlink" title="4.1.4Â gpio å¼•è„šæè¿°å±æ€§  "></a><font size=3>4.1.4Â gpio å¼•è„šæè¿°å±æ€§  </font></h4><p>ç¤ºä¾‹ä¸­è®¾å¤‡æ ‘ä¸­å…³äº gpio å¼•è„šæè¿°å±æ€§ç›¸å…³å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">gpio0: gpio@fdd60000 &#123;</span><br><span class="line">    <span class="comment">//......</span></span><br><span class="line">    <span class="meta">#gpio-cells = <span class="string">&lt;2&gt;</span>;</span></span><br><span class="line">	<span class="comment">//......</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">ft5x06: ft5x06@<span class="number">38</span> &#123;</span><br><span class="line">    <span class="comment">//.....</span></span><br><span class="line">    reset-gpios = &lt;&amp;gpio0 RK_PB6 GPIO_ACTIVE_LOW&gt;;</span><br><span class="line">    <span class="comment">//.....</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>gpio å¼•è„šæè¿°å±æ€§ä¸ªæ•°ç”±#gpio-cells æ‰€å†³å®šï¼Œ å› ä¸º gpio0 èŠ‚ç‚¹ä¸­çš„#gpio-cells å±æ€§è®¾ç½®ä¸ºäº†2ï¼Œ æ‰€ä»¥ä¸Šé¢è®¾å¤‡æ ‘ gpio å¼•è„šæè¿°å±æ€§ä¸ªæ•°ä¹Ÿä¸º 2ã€‚  RK_PB6æ˜¯å¼•è„šåï¼ŒGPIO_ACTIVE_LOW  è¡¨ç¤ºè®¾ç½®ä¸ºä½ç”µå¹³ã€‚</p>
<h4 id="4-1-5-å…¶ä»–å±æ€§"><a href="#4-1-5-å…¶ä»–å±æ€§" class="headerlink" title="4.1.5Â å…¶ä»–å±æ€§  "></a><font size=3>4.1.5Â å…¶ä»–å±æ€§  </font></h4><p>æ ¹æ®ä¸‹é¢çš„è®¾å¤‡æ ‘ç¤ºä¾‹å­¦ä¹ ä¸€ä¸‹ gpio çš„å…¶ä»–é‡è¦å±æ€§ï¼Œ è®¾å¤‡æ ‘å…·ä½“å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">gpio-controller@<span class="number">00000000</span> &#123;</span><br><span class="line">    compatible = <span class="string">&quot;foo&quot;</span>;</span><br><span class="line">    reg = &lt;<span class="number">0x00000000</span> <span class="number">0x1000</span>&gt;;</span><br><span class="line">    gpio-controller;</span><br><span class="line">    <span class="meta">#gpio-cells = <span class="string">&lt;2&gt;</span>;</span></span><br><span class="line">    ngpios = &lt;<span class="number">18</span>&gt;;</span><br><span class="line">    gpio-reserved-ranges = &lt;<span class="number">0</span> <span class="number">4</span>&gt;, &lt;<span class="number">12</span> <span class="number">2</span>&gt;;</span><br><span class="line">    gpio-line-names = <span class="string">&quot;MMC-CD&quot;</span>, <span class="string">&quot;MMC-WP&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;voD eth&quot;</span>, <span class="string">&quot;RST eth&quot;</span>, <span class="string">&quot;LED R&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;LED G&quot;</span>, <span class="string">&quot;LED B&quot;</span>, <span class="string">&quot;col A&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;col B&quot;</span>, <span class="string">&quot;col C&quot;</span>, <span class="string">&quot;col D&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;NMI button&quot;</span>, <span class="string">&quot;Row A&quot;</span>, <span class="string">&quot;Row B&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;Row C&quot;</span>, <span class="string">&quot;Row D&quot;</span>, <span class="string">&quot;poweroff&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;reset&quot;</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>ç¬¬ 6 è¡Œçš„ ngpios å±æ€§æŒ‡å®šäº† GPIO æ§åˆ¶å™¨æ‰€æ”¯æŒçš„ GPIO å¼•è„šæ•°é‡ã€‚ å®ƒè¡¨ç¤ºè¯¥è®¾å¤‡ä¸Šå¯ç”¨çš„ GPIO å¼•è„šçš„æ€»æ•°ã€‚ åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ ngpios çš„å€¼ä¸º 18ï¼Œ æ„å‘³ç€è¯¥ GPIO æ§åˆ¶å™¨æ”¯æŒ 18ä¸ª GPIO å¼•è„šã€‚  </p>
<p>ç¬¬ 7 è¡Œçš„ gpio-reserved-ranges å±æ€§å®šä¹‰äº†ä¿ç•™çš„ GPIO èŒƒå›´ã€‚æ¯ä¸ªèŒƒå›´ç”±ä¸¤ä¸ªæ•´æ•°å€¼è¡¨ç¤ºï¼Œç”¨å°–æ‹¬å·æ‹¬èµ·æ¥ã€‚ ä¿ç•™çš„ GPIO èŒƒå›´æ„å‘³ç€è¿™äº› GPIO å¼•è„šä¸å¯ç”¨æˆ–å·²è¢«å…¶ä»–è®¾å¤‡æˆ–åŠŸèƒ½ä¿ç•™ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ æœ‰ä¸¤ä¸ªä¿ç•™èŒƒå›´ï¼š &lt;0 4&gt;å’Œ&lt;12 2&gt;ã€‚ &lt;0 4&gt;è¡¨ç¤ºä»ç¬¬ 0 ä¸ªå¼•è„šå¼€å§‹çš„è¿ç»­ 4 ä¸ªå¼•è„šè¢«ä¿ç•™ï¼Œ è€Œ&lt;12 2&gt;è¡¨ç¤ºä»ç¬¬ 12 ä¸ªå¼•è„šå¼€å§‹çš„è¿ç»­ 2 ä¸ªå¼•è„šè¢«ä¿ç•™ã€‚  </p>
<p>ç¬¬ 8 è¡Œçš„ gpio-line-names å±æ€§å®šä¹‰äº† GPIO å¼•è„šçš„åç§°ï¼Œ ä»¥é€—å·åˆ†éš”ã€‚ æ¯ä¸ªåç§°å¯¹åº”ä¸€ä¸ªGPIO å¼•è„šã€‚ è¿™äº›åç§°ç”¨äºæ ‡è¯†å’Œè¯†åˆ«æ¯ä¸ª GPIO å¼•è„šçš„ä½œç”¨æˆ–è¿æ¥çš„è®¾å¤‡ã€‚ åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ gpio-line-names å±æ€§åˆ—å‡ºäº†å¤šä¸ª GPIO å¼•è„šçš„åç§°ï¼Œ å¦‚ â€œMMC-CDâ€ã€ â€œMMC-WPâ€ã€ â€œvoD ethâ€ ç­‰ç­‰ã€‚ é€šè¿‡è¿™äº›åç§°ï¼Œ å¯ä»¥æ¸…æ¥šåœ°äº†è§£æ¯ä¸ª GPIO å¼•è„šçš„åŠŸèƒ½æˆ–ç”¨é€”ã€‚  </p>
<h3 id="4-2-GPIOå®ä¾‹"><a href="#4-2-GPIOå®ä¾‹" class="headerlink" title="4.2 GPIOå®ä¾‹"></a><font size=3>4.2 GPIOå®ä¾‹</font></h3><h4 id="4-2-1-ç¡¬ä»¶åŸç†å›¾"><a href="#4-2-1-ç¡¬ä»¶åŸç†å›¾" class="headerlink" title="4.2.1 ç¡¬ä»¶åŸç†å›¾"></a><font size=3>4.2.1 ç¡¬ä»¶åŸç†å›¾</font></h4><img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250220163438114.png" alt="image-20250220163438114" style="zoom: 50%;" />

<p>æŸ¥çœ‹åŸç†å›¾ä¼šå‘ç°LED0 æ¥åˆ°äº† GPIO_3 ä¸Šï¼Œ è¿™é‡Œçš„GPIO_3 å°±æ˜¯ GPIO1_IO03ï¼Œå½“ GPIO1_IO03è¾“å‡ºä½ç”µå¹³(0)çš„æ—¶å€™å‘å…‰äºŒæç®¡ LED0 å°±ä¼šå¯¼é€šç‚¹äº®ï¼Œå½“ GPIO1_IO03 è¾“å‡ºé«˜ç”µå¹³(1)çš„æ—¶å€™å‘å…‰äºŒæç®¡ LED0 ä¸ä¼šå¯¼é€šï¼Œå› æ­¤ LED0 ä¹Ÿå°±ä¸ä¼šç‚¹äº®ã€‚æ‰€ä»¥ LED0 çš„äº®ç­å–å†³äº GPIO1_IO03çš„è¾“å‡ºç”µå¹³ï¼Œè¾“å‡º 0 å°±äº®ï¼Œè¾“å‡º 1 å°±ç­ã€‚  </p>
<h4 id="4-2-2-ledç¯èŠ‚ç‚¹"><a href="#4-2-2-ledç¯èŠ‚ç‚¹" class="headerlink" title="4.2.2 ledç¯èŠ‚ç‚¹"></a><font size=3>4.2.2 ledç¯èŠ‚ç‚¹</font></h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">sdev_led &#123;</span><br><span class="line">	<span class="meta">#address-cells = <span class="string">&lt;1&gt;</span>;</span></span><br><span class="line">	<span class="meta">#size-cells = <span class="string">&lt;1&gt;</span>;</span></span><br><span class="line">	compatible = <span class="string">&quot;sdev-led&quot;</span>;</span><br><span class="line">	status = <span class="string">&quot;okay&quot;</span>;</span><br><span class="line">	reg = &lt; <span class="number">0X020C406C</span> <span class="number">0X04</span> <span class="comment">/* CCM_CCGR1_BASE */</span></span><br><span class="line">			<span class="number">0X020E0068</span> <span class="number">0X04</span> <span class="comment">/* SW_MUX_GPIO1_IO03_BASE */</span></span><br><span class="line">			<span class="number">0X020E02F4</span> <span class="number">0X04</span> <span class="comment">/* SW_PAD_GPIO1_IO03_BASE */</span></span><br><span class="line">			<span class="number">0X0209C000</span> <span class="number">0X04</span> <span class="comment">/* GPIO1_DR_BASE */</span></span><br><span class="line">			<span class="number">0X0209C004</span> <span class="number">0X04</span> &gt;; <span class="comment">/* GPIO1_GDIR_BASE */</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>ç¬¬ 2ã€ 3 è¡Œï¼Œå±æ€§#address-cells å’Œ#size-cells éƒ½ä¸º 1ï¼Œè¡¨ç¤º reg å±æ€§ä¸­èµ·å§‹åœ°å€å ç”¨ä¸€ä¸ªå­—é•¿(cell)ï¼Œåœ°å€é•¿åº¦ä¹Ÿå ç”¨ä¸€ä¸ªå­—é•¿(cell)ã€‚</p>
<p>ç¬¬ 4 è¡Œï¼Œå±æ€§ compatbile è®¾ç½® alphaled èŠ‚ç‚¹å…¼å®¹æ€§ä¸ºâ€œsdev-ledâ€ã€‚</p>
<p>ç¬¬ 5 è¡Œï¼Œå±æ€§ status è®¾ç½®çŠ¶æ€ä¸ºâ€œokayâ€ã€‚</p>
<p>ç¬¬ 6 ~ 10 è¡Œï¼Œ reg å±æ€§è®¾ç½®äº†é©±åŠ¨é‡Œé¢æ‰€è¦ä½¿ç”¨çš„å¯„å­˜å™¨ç‰©ç†åœ°å€ï¼Œæ¯”å¦‚ç¬¬ 6 è¡Œçš„â€œ0X020C406C 0X04â€è¡¨ç¤º I.MX6ULL çš„ CCM_CCGR1 å¯„å­˜å™¨ï¼Œå…¶ä¸­å¯„å­˜å™¨é¦–åœ°å€ä¸º 0X020C406Cï¼Œé•¿åº¦ä¸º 4 ä¸ªå­—èŠ‚ã€‚</p>
<h2 id="5-pinctrl"><a href="#5-pinctrl" class="headerlink" title="5.Â pinctrl  "></a><font size=3>5.Â pinctrl  </font></h2><h3 id="5-1-pinmux-ç®€ä»‹"><a href="#5-1-pinmux-ç®€ä»‹" class="headerlink" title="5.1Â pinmux ç®€ä»‹Â Â "></a><font size=3>5.1Â pinmux ç®€ä»‹Â Â </font></h3><h4 id="5-1-1-ä»€ä¹ˆæ˜¯pinmux"><a href="#5-1-1-ä»€ä¹ˆæ˜¯pinmux" class="headerlink" title="5.1.1 ä»€ä¹ˆæ˜¯pinmux"></a><font size=3>5.1.1 ä»€ä¹ˆæ˜¯pinmux</font></h4><p>Pinmuxï¼ˆ å¼•è„šå¤ç”¨ï¼‰ æ˜¯æŒ‡åœ¨ç³»ç»Ÿä¸­é…ç½®å’Œç®¡ç†å¼•è„šåŠŸèƒ½çš„è¿‡ç¨‹ã€‚ åœ¨è®¸å¤šç°ä»£é›†æˆç”µè·¯ä¸­ï¼Œå•ä¸ªå¼•è„šå¯ä»¥å…·æœ‰å¤šä¸ªåŠŸèƒ½ï¼Œ ä¾‹å¦‚ä½œä¸º GPIOã€ UARTã€ SPI æˆ– I2C ç­‰ã€‚ é€šè¿‡ä½¿ç”¨å¼•è„šå¤ç”¨åŠŸèƒ½ï¼Œå¯ä»¥åœ¨è¿™äº›ä¸åŒçš„åŠŸèƒ½ä¹‹é—´åˆ‡æ¢ã€‚  </p>
<p>å¼•è„šå¤ç”¨é€šè¿‡ç¡¬ä»¶å’Œè½¯ä»¶çš„æ–¹å¼å®ç°ã€‚ ç¡¬ä»¶å±‚é¢ï¼Œ èŠ¯ç‰‡è®¾è®¡ä¼šä¸ºæ¯ä¸ªå¼•è„šæä¾›å¤šä¸ªåŠŸèƒ½çš„é€‰æ‹©ã€‚ è¿™äº›åŠŸèƒ½é€šå¸¸ç”±èŠ¯ç‰‡å‚å•†åœ¨èŠ¯ç‰‡è§„æ ¼æ–‡æ¡£ä¸­å®šä¹‰ã€‚ é€šè¿‡ç¼–ç¨‹è®¾ç½®å¯„å­˜å™¨æˆ–å¼€å…³ï¼Œ å¯ä»¥é€‰æ‹©æŸä¸ªåŠŸèƒ½æ¥è¿æ¥å¼•è„šã€‚ è¿™ç§ç¡¬ä»¶å±‚é¢çš„é…ç½®é€šå¸¸æ˜¯ç”±å¼•è„šæ§åˆ¶å™¨ï¼ˆPin Controllerï¼‰ æˆ–å¼•è„šå¤ç”¨æ§åˆ¶å™¨ï¼ˆ Pin Mux Controllerï¼‰ è´Ÿè´£ç®¡ç†ã€‚  </p>
<p>è½¯ä»¶å±‚é¢ï¼Œ æ“ä½œç³»ç»Ÿæˆ–è®¾å¤‡é©±åŠ¨ç¨‹åºéœ€è¦äº†è§£å’Œé…ç½®å¼•è„šçš„åŠŸèƒ½ã€‚ å®ƒä»¬ä½¿ç”¨è®¾å¤‡æ ‘ï¼ˆ Device Treeï¼‰ æˆ–è®¾å¤‡æ ‘ç»‘å®šï¼ˆ Device Tree Bindingsï¼‰ æ¥æè¿°å’Œé…ç½®å¼•è„šçš„åŠŸèƒ½ã€‚ åœ¨è®¾å¤‡æ ‘ä¸­ï¼Œ å¯ä»¥æŒ‡å®šå¼•è„šçš„å¤ç”¨åŠŸèƒ½ï¼Œ å°†å…¶è¿æ¥åˆ°ç‰¹å®šçš„ç¡¬ä»¶æ¥å£æˆ–åŠŸèƒ½ã€‚ æ“ä½œç³»ç»Ÿæˆ–è®¾å¤‡é©±åŠ¨ç¨‹åºåœ¨å¯åŠ¨è¿‡ç¨‹ä¸­è§£æè®¾å¤‡æ ‘ï¼Œ å¹¶æ ¹æ®é…ç½®å¯¹å¼•è„šè¿›è¡Œåˆå§‹åŒ–å’Œè®¾ç½®ã€‚  </p>
<h4 id="5-1-2-imx6ullçš„å¼•è„šå¤ç”¨"><a href="#5-1-2-imx6ullçš„å¼•è„šå¤ç”¨" class="headerlink" title="5.1.2 imx6ullçš„å¼•è„šå¤ç”¨"></a><font size=3>5.1.2 imx6ullçš„å¼•è„šå¤ç”¨</font></h4><p>é‚£æˆ‘ä»¬è¦æ€æ ·çŸ¥æ™“æ¯ä¸€ä¸ªç®¡è„šéƒ½å¯ä»¥å¤ç”¨æˆä»€ä¹ˆåŠŸèƒ½å‘¢ï¼Œå¯¹äºæˆ‘ä½¿ç”¨çš„alpha-imx6ullå¼€å‘æ¿ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æŸ¥çœ‹ã€Ši.MX 6ULL Applications Processor Reference Manual.pdfã€‹æ‰‹å†Œçš„32.6 IOMUXC Memory Map&#x2F;Register Definition ã€‚ä¾‹å¦‚å‰é¢æŒ‰é”®æ˜¯æ¥åœ¨GPIO1_IO18ä¸Šï¼Œè¿™ä¸ªå¼•è„šé»˜è®¤æ˜¯UART1_CTS_Bï¼Œè¿™ä¸ªå¼•è„šå¤ç”¨æƒ…å†µå¦‚ä¸‹ï¼š</p>
  <img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250220092740884.png" alt="image-20250220092740884"  />

<h4 id="5-1-3-RK3568çš„å¼•è„šå¤ç”¨"><a href="#5-1-3-RK3568çš„å¼•è„šå¤ç”¨" class="headerlink" title="5.1.3 RK3568çš„å¼•è„šå¤ç”¨"></a><font size=3>5.1.3 RK3568çš„å¼•è„šå¤ç”¨</font></h4><p>æœ‰ä¸€äº›å‚å®¶ç»™çš„åŸç†å›¾ç”šè‡³ä¼šåœ¨æ ¸å¿ƒæ¿åŸç†å›¾æ ‡æ³¨å‡ºæ¯ä¸ªç®¡è„šçš„å¤ç”¨åŠŸèƒ½ï¼Œä¾‹å¦‚è®¯ä¸ºçš„RK3568å¼€å‘æ¿ï¼š</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250221093009766.png" alt="image-20250221093009766"  />

<p>ä»ä¸Šå›¾å¯ä»¥çœ‹åˆ° UART4_RX_M1 å¯¹åº”çš„å¼•è„šå¯ä»¥å¤ç”¨ä¸ºä»¥ä¸‹ 6 ä¸ªåŠŸèƒ½ LCDC_D16ã€VOP_BT1120_D7ã€ GMAC1_RXD0_M0ã€ UART4_RX_M1ã€ PWM8_M0ã€ GPIO3_B1_dï¼Œ é‚£ä¹ˆå¯¹äºRK3568æ¥è¯´ï¼Œå¯¹åº”çš„ BGAå¼•è„šæ ‡å·ä¸º AG1,é‚£è¿™é‡Œçš„ AG1 æ˜¯å¦‚ä½•å®šä½çš„å‘¢ã€‚</p>
<p>åœ¨ BGAï¼ˆBall Grid Arrayï¼Œ çƒæ …é˜µåˆ—ï¼‰ å°è£…ä¸­ï¼Œ å¼•è„šæ ‡å·æ˜¯ç”¨äºå”¯ä¸€æ ‡è¯†æ¯ä¸ªå¼•è„šçš„æ ‡è¯†ç¬¦ã€‚è¿™äº›æ ‡å·é€šå¸¸ç”±èŠ¯ç‰‡åˆ¶é€ å•†å®šä¹‰ï¼Œ å¹¶åœ¨èŠ¯ç‰‡çš„è§„æ ¼æ–‡æ¡£æˆ–æ•°æ®æ‰‹å†Œä¸­æä¾›ã€‚  </p>
<p>BGA èŠ¯ç‰‡çš„å¼•è„šæ ‡å·é€šå¸¸ç”±å­—æ¯å’Œæ•°å­—çš„ç»„åˆæ„æˆã€‚ å®ƒä»¬ç”¨äºåœ¨èŠ¯ç‰‡çš„å°è£…åº•éƒ¨çš„ç„Šç›˜ä¸Šè¿›è¡Œæ ‡è®°ã€‚ æ¯ä¸ªå¼•è„šæ ‡å·éƒ½ä¸èŠ¯ç‰‡å†…éƒ¨çš„åŠŸèƒ½æˆ–ä¿¡å·ç›¸å¯¹åº”ï¼Œ ä»¥ä¾¿æ­£ç¡®è¿æ¥åˆ°å°åˆ·ç”µè·¯æ¿ï¼ˆ PCBï¼‰ ä¸Šçš„ç›®æ ‡ä½ç½®ã€‚ RK3568 çš„å¼•è„šæ ‡å·å›¾å¦‚ä¸‹ï¼š</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250221093125213.png" alt="image-20250221093125213" style="zoom: 25%;" />

<p>å¯ä»¥çœ‹åˆ°çºµå‘ä¸º A-AH çš„ 28 ä¸ªå­—æ¯ç±»å‹æ ‡å·ï¼Œ æ¨ªå‘ä¸º 1-28 çš„ 28 ä¸ªå­—æ¯ç±»å‹æ ‡å·ï¼Œ ç‘èŠ¯å¾®ä¹Ÿåœ¨å¯¹åº”çš„ 3568 æ•°æ®æ‰‹å†Œä¸­åŠ å…¥äº†æ ¹æ® BGA ä½ç½®åˆ¶ä½œçš„å¤ç”¨åŠŸèƒ½å›¾ï¼Œ éƒ¨åˆ†å†…å®¹å¦‚ä¸‹å›¾  </p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250221093144491.png" alt="image-20250221093144491"  />

<p>å…¶ä¸­é»‘è‰²æ¡†ä»£è¡¨è¢«ä¿ç•™çš„å¼•è„šï¼Œ å…¶ä»–æœ‰é¢œè‰²çš„æ¡†ä¸€èˆ¬ä¸ºç”µæºå’Œåœ°ï¼Œ ç™½è‰²çš„æ¡†ä»£è¡¨æœ‰å…·ä½“å¤ç”¨åŠŸèƒ½çš„å¼•è„šã€‚  </p>
<h4 id="5-1-4-æ€»ç»“"><a href="#5-1-4-æ€»ç»“" class="headerlink" title="5.1.4 æ€»ç»“"></a><font size=3>5.1.4 æ€»ç»“</font></h4><p>å¼•è„šå¤ç”¨æé«˜äº†èŠ¯ç‰‡çš„çµæ´»æ€§å’Œå¯é‡ç”¨æ€§ï¼Œ é€šè¿‡å…è®¸åŒä¸€ä¸ªå¼•è„šåœ¨ä¸åŒçš„åŠŸèƒ½ä¹‹é—´åˆ‡æ¢ï¼Œ å¯ä»¥å‡å°‘ç¡¬ä»¶è®¾è®¡çš„å¤æ‚æ€§å’Œæˆæœ¬ã€‚ æ­¤å¤–ï¼Œ å¼•è„šå¤ç”¨è¿˜ä½¿å¾—åœ¨ä½¿ç”¨ç›¸åŒèŠ¯ç‰‡çš„ä¸åŒåº”ç”¨ä¸­å¯ä»¥æ›´åŠ çµæ´»åœ°é…ç½®å’Œå®šåˆ¶å¼•è„šåŠŸèƒ½ã€‚ </p>
<h3 id="5-2-RK3568ä¸­ä½¿ç”¨-pinctrl-è®¾ç½®å¤ç”¨å…³ç³»"><a href="#5-2-RK3568ä¸­ä½¿ç”¨-pinctrl-è®¾ç½®å¤ç”¨å…³ç³»" class="headerlink" title="5.2 RK3568ä¸­ä½¿ç”¨ pinctrl è®¾ç½®å¤ç”¨å…³ç³»  "></a><font size=3>5.2 RK3568ä¸­ä½¿ç”¨ pinctrl è®¾ç½®å¤ç”¨å…³ç³»  </font></h3><p>pinctrlï¼ˆå¼•è„šæ§åˆ¶ï¼‰ ç”¨äºæè¿°å’Œé…ç½®ç¡¬ä»¶è®¾å¤‡ä¸Šçš„å¼•è„šåŠŸèƒ½å’Œè¿æ¥æ–¹å¼ã€‚ å®ƒæ˜¯è®¾å¤‡æ ‘çš„ä¸€éƒ¨åˆ†ï¼Œ ç”¨äºåœ¨å¯åŠ¨è¿‡ç¨‹ä¸­ä¼ é€’å¼•è„šé…ç½®ä¿¡æ¯ç»™æ“ä½œç³»ç»Ÿå’Œè®¾å¤‡é©±åŠ¨ç¨‹åºï¼Œ ä»¥ä¾¿æ­£ç¡®åœ°åˆå§‹åŒ–å’Œæ§åˆ¶å¼•è„šã€‚  </p>
<p>åœ¨è®¾å¤‡æ ‘ä¸­ï¼Œ pinctrlï¼ˆå¼•è„šæ§åˆ¶ï¼‰ ä½¿ç”¨äº†å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„æ¦‚å¿µæ¥æè¿°å¼•è„šæ§åˆ¶çš„å…³ç³»å’Œé…ç½®ã€‚  </p>
<h4 id="5-2-1-å®¢æˆ·ç«¯ï¼ˆclientï¼‰"><a href="#5-2-1-å®¢æˆ·ç«¯ï¼ˆclientï¼‰" class="headerlink" title="5.2.1 å®¢æˆ·ç«¯ï¼ˆclientï¼‰"></a><font size=3>5.2.1 å®¢æˆ·ç«¯ï¼ˆclientï¼‰</font></h4><p>æ¥ä¸‹æ¥å°†ä½¿ç”¨ä¸‰ä¸ªä¾‹å­å¯¹å®¢æˆ·ç«¯è¦ç”¨åˆ°çš„å±æ€§è¿›è¡Œè¯´æ˜ã€‚</p>
<ul>
<li>ç¤ºä¾‹1</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">node &#123;</span><br><span class="line">    pinctrl-names = <span class="string">&quot;default&quot;</span>;</span><br><span class="line">    pinctrl<span class="number">-0</span> = &lt;&amp;pinctrl_hog_1&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>pinctrl-names å±æ€§å®šä¹‰äº†ä¸€ä¸ªçŠ¶æ€åç§°ï¼š defaultã€‚pinctrl-0 å±æ€§æŒ‡å®šäº†ç¬¬ä¸€ä¸ªçŠ¶æ€ default å¯¹åº”çš„å¼•è„šé…ç½®ã€‚&lt;&amp;pinctrl_hog_1&gt; æ˜¯ä¸€ä¸ªå¼•è„šæè¿°ç¬¦ï¼Œ å®ƒå¼•ç”¨äº†ä¸€ä¸ªåä¸º pinctrl_hog_1 çš„å¼•è„šæ§åˆ¶å™¨èŠ‚ç‚¹ã€‚ è¿™è¡¨ç¤ºåœ¨ default çŠ¶æ€ä¸‹ï¼Œ è®¾å¤‡çš„å¼•è„šé…ç½®å°†ä½¿ç”¨ pinctrl_hog_1 èŠ‚ç‚¹ä¸­å®šä¹‰çš„é…ç½®ã€‚    </p>
<ul>
<li>ç¤ºä¾‹2</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">node &#123;</span><br><span class="line">    pinctrl-names = <span class="string">&quot;default&quot;</span>, <span class="string">&quot;wake up&quot;</span>;</span><br><span class="line">    pinctrl<span class="number">-0</span> = &lt;&amp;pinctrl_hog_1&gt;;</span><br><span class="line">    pinctrl<span class="number">-1</span> = &lt;&amp;pinctrl_hog_2&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>pinctrl-names å±æ€§å®šä¹‰äº†ä¸¤ä¸ªçŠ¶æ€åç§°ï¼š default å’Œ wake upã€‚pinctrl-0 å±æ€§æŒ‡å®šäº†ç¬¬ä¸€ä¸ªçŠ¶æ€ default å¯¹åº”çš„å¼•è„šé…ç½®ï¼Œ å¼•ç”¨äº† pinctrl_hog_1 èŠ‚ç‚¹ã€‚pinctrl-1 å±æ€§æŒ‡å®šäº†ç¬¬äºŒä¸ªçŠ¶æ€ wake up å¯¹åº”çš„å¼•è„šé…ç½®ï¼Œ å¼•ç”¨äº† pinctrl_hog_2 èŠ‚ç‚¹ã€‚</p>
<p>è¿™æ„å‘³ç€è®¾å¤‡å¯ä»¥å¤„äºä¸¤ä¸ªä¸åŒçš„çŠ¶æ€ä¹‹ä¸€ï¼Œ æ¯ä¸ªçŠ¶æ€åˆ†åˆ«ä½¿ç”¨ä¸åŒçš„å¼•è„šé…ç½®ã€‚  </p>
<ul>
<li>ç¤ºä¾‹3</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">node &#123;</span><br><span class="line">    pinctrl-names = <span class="string">&quot;default&quot;</span>;</span><br><span class="line">    pinctrl<span class="number">-0</span> = &lt;&amp;pinctrl_hog_1 &amp;pinctrl_hog_2&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œ pinctrl-names å±æ€§ä»ç„¶å®šä¹‰äº†ä¸€ä¸ªçŠ¶æ€åç§°ï¼š defaultã€‚pinctrl-0 å±æ€§æŒ‡å®šäº†ç¬¬ä¸€ä¸ªçŠ¶æ€ default å¯¹åº”çš„å¼•è„šé…ç½®ï¼Œ ä½†ä¸ä¹‹å‰çš„ä¾‹å­ä¸åŒçš„æ˜¯ï¼Œ å®ƒå¼•ç”¨äº†ä¸¤ä¸ªå¼•è„šæè¿°ç¬¦ï¼š pinctrl_hog_1 å’Œ pinctrl_hog_2ã€‚    </p>
<p>è¿™è¡¨ç¤ºåœ¨ default çŠ¶æ€ä¸‹ï¼Œ è®¾å¤‡çš„å¼•è„šé…ç½®å°†ä½¿ç”¨ pinctrl_hog_1 å’Œ pinctrl_hog_2 ä¸¤ä¸ªèŠ‚ç‚¹ä¸­å®šä¹‰çš„é…ç½®ã€‚ è¿™ç§æ–¹å¼å¯ä»¥å°†å¤šä¸ªå¼•è„šæ§åˆ¶å™¨çš„é…ç½®ç»„åˆåœ¨ä¸€èµ·ï¼Œ ä»¥æ»¡è¶³ç‰¹å®šçŠ¶æ€ä¸‹çš„å¼•è„šéœ€æ±‚ã€‚  </p>
<p>å…³äºå®¢æˆ·ç«¯çš„å†…å®¹ï¼Œ ä¸åŒå‚å®¶çš„ç¼–å†™æ ¼å¼æ˜¯ç›¸åŒçš„ï¼Œè€ŒæœåŠ¡ç«¯æ¯ä¸ªå‚å®¶å°±æœ‰åŒºåˆ«äº†ã€‚</p>
<h4 id="5-2-2-æœåŠ¡ç«¯ï¼ˆserverï¼‰"><a href="#5-2-2-æœåŠ¡ç«¯ï¼ˆserverï¼‰" class="headerlink" title="5.2.2 æœåŠ¡ç«¯ï¼ˆserverï¼‰"></a><font size=3>5.2.2 æœåŠ¡ç«¯ï¼ˆserverï¼‰</font></h4><p>æœåŠ¡ç«¯æ˜¯è®¾å¤‡æ ‘ä¸­å®šä¹‰å¼•è„šé…ç½®çš„éƒ¨åˆ†ã€‚ å®ƒåŒ…å«å¼•è„šç»„å’Œå¼•è„šæè¿°ç¬¦ï¼Œ ä¸ºå®¢æˆ·ç«¯æä¾›å¼•è„šé…ç½®é€‰æ‹©ã€‚ æœåŠ¡ç«¯åœ¨è®¾å¤‡æ ‘ä¸­å®šä¹‰äº† pinctrl èŠ‚ç‚¹ï¼Œ å…¶ä¸­åŒ…å«å¼•è„šç»„å’Œå¼•è„šæè¿°ç¬¦çš„å®šä¹‰ã€‚  </p>
<p>è¿™é‡Œä»¥ç‘èŠ¯å¾®çš„ RK3568 ä¸ºä¾‹è¿›è¡Œ pinctrl æœåŠ¡ç«¯çš„å­¦ä¹ ï¼Œ ç‘èŠ¯å¾®åŸå‚ BSP å·¥ç¨‹å¸ˆä¸ºäº†æ–¹ä¾¿ç”¨æˆ·é€šè¿‡ pinctrl è®¾ç½®ç®¡è„šçš„å¤ç”¨å…³ç³»ï¼Œ å°†åŒ…å«æ‰€æœ‰å¤ç”¨å…³ç³»çš„é…ç½®å†™åœ¨äº†å†…æ ¸ï¼ˆ5.19.17ç‰ˆæœ¬ï¼Œä¸»è¦æ˜¯å› ä¸ºæœ‰äº›ç‰ˆæœ¬è¿˜æ²¡åŠ å…¥RKç³»åˆ—çš„èŠ¯ç‰‡ï¼‰ç›®å½•ä¸‹çš„  <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/v5.19.17/source/arch/arm64/boot/dts/rockchip/rk3568-pinctrl.dtsi">rk3568-pinctrl.dtsi - arch&#x2F;arm64&#x2F;boot&#x2F;dts&#x2F;rockchip&#x2F;rk3568-pinctrl.dtsi - Linux source code v5.19.17</a> ä¸­ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¿™ä¸ª <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/v5.19.17/source/arch/arm64/boot/dts/rockchip/rk3568-pinctrl.dtsi#L13">pinctrl</a> èŠ‚ç‚¹ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&amp;pinctrl &#123;</span><br><span class="line">	acodec &#123;</span><br><span class="line">		/omit-<span class="keyword">if</span>-no-ref/</span><br><span class="line">		acodec_pins: acodec-pins &#123;</span><br><span class="line">			rockchip,pins =</span><br><span class="line">				<span class="comment">/* acodec_adc_sync */</span></span><br><span class="line">				&lt;<span class="number">1</span> RK_PB1 <span class="number">5</span> &amp;pcfg_pull_none&gt;,</span><br><span class="line">				<span class="comment">/* acodec_adcclk */</span></span><br><span class="line">				&lt;<span class="number">1</span> RK_PA1 <span class="number">5</span> &amp;pcfg_pull_none&gt;,</span><br><span class="line">				<span class="comment">/* acodec_adcdata */</span></span><br><span class="line">				&lt;<span class="number">1</span> RK_PA0 <span class="number">5</span> &amp;pcfg_pull_none&gt;,</span><br><span class="line">				<span class="comment">/* acodec_dac_datal */</span></span><br><span class="line">				&lt;<span class="number">1</span> RK_PA7 <span class="number">5</span> &amp;pcfg_pull_none&gt;,</span><br><span class="line">				<span class="comment">/* acodec_dac_datar */</span></span><br><span class="line">				&lt;<span class="number">1</span> RK_PB0 <span class="number">5</span> &amp;pcfg_pull_none&gt;,</span><br><span class="line">				<span class="comment">/* acodec_dacclk */</span></span><br><span class="line">				&lt;<span class="number">1</span> RK_PA3 <span class="number">5</span> &amp;pcfg_pull_none&gt;,</span><br><span class="line">				<span class="comment">/* acodec_dacsync */</span></span><br><span class="line">				&lt;<span class="number">1</span> RK_PA5 <span class="number">5</span> &amp;pcfg_pull_none&gt;;</span><br><span class="line">		&#125;;</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>åœ¨ pinctrl èŠ‚ç‚¹ä¸­å°±æ˜¯æ¯ä¸ªèŠ‚ç‚¹çš„å¤ç”¨åŠŸèƒ½ï¼Œ ç„¶åæˆ‘ä»¬ä»¥ uart4 çš„å¼•è„šå¤ç”¨ä¸ºä¾‹è¿›è¡Œå­¦ä¹ ï¼Œ<a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/v5.19.17/source/arch/arm64/boot/dts/rockchip/rk3568-pinctrl.dtsi#L2572">uart4</a>çš„ pinctrl æœåŠ¡ç«¯å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">uart4 &#123;</span><br><span class="line">	<span class="comment">//......</span></span><br><span class="line">	/omit-<span class="keyword">if</span>-no-ref/</span><br><span class="line">	uart4m1_xfer: uart4m1-xfer &#123;</span><br><span class="line">		rockchip,pins =</span><br><span class="line">			<span class="comment">/* uart4_rxm1 */</span></span><br><span class="line">			&lt;<span class="number">3</span> RK_PB1 <span class="number">4</span> &amp;pcfg_pull_up&gt;,</span><br><span class="line">			<span class="comment">/* uart4_txm1 */</span></span><br><span class="line">			&lt;<span class="number">3</span> RK_PB2 <span class="number">4</span> &amp;pcfg_pull_up&gt;;</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­&lt;3 RK_PB1 4 &amp;pcfg_pull_up&gt;å’Œ&lt;3 RK_PB2 4 &amp;pcfg_pull_up&gt;åˆ†åˆ«è¡¨ç¤ºå°† GPIO3 çš„ PB1 å¼•è„šè®¾ç½®ä¸ºåŠŸèƒ½ 4ï¼Œ å°† GPIO3 çš„ PB2 ä¹Ÿè®¾ç½®ä¸ºåŠŸèƒ½ 4ï¼Œ ä¸”ç”µæ°”å±æ€§éƒ½ä¼šè®¾ç½®ä¸ºä¸Šæ‹‰ã€‚   </p>
<p>é€šè¿‡æŸ¥æ‰¾åŸç†å›¾å¯ä»¥å¾—åˆ°ä¸¤ä¸ªå¼•è„šåœ¨ BGA å°è£…ä½ç½®åˆ†åˆ«ä¸º AG1 å’Œ AF2ï¼Œ å¦‚ä¸‹å›¾  ï¼š</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250221092855296.png" alt="image-20250221092855296"  />

<p>ç„¶ååœ¨ rk3568 çš„æ•°æ®æ‰‹å†Œä¸­æ‰¾åˆ°å¼•è„šå¤ç”¨è¡¨å¯¹åº”çš„ä½ç½®ï¼Œ å…·ä½“å†…å®¹å¦‚ä¸‹å›¾æ‰€ç¤º  </p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250221093541551.png" alt="image-20250221093541551" style="zoom:50%;" />

<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250221093551160.png" alt="image-20250221093551160"  />

<p>å¯ä»¥çœ‹åˆ°åŠŸèƒ½ 4 å¯¹åº”ä¸²å£ 4 çš„å‘é€ç«¯å’Œæ¥æ”¶ç«¯ï¼Œ pinctrl æœåŠ¡ç«¯çš„é…ç½®å’Œæ•°æ®æ‰‹å†Œä¸­çš„å¼•è„šå¤ç”¨åŠŸèƒ½æ˜¯ä¸€ä¸€å¯¹åº”ï¼Œ é‚£å¦‚æœè¦å°† RK_PB1 å’Œ RK_PB2 è®¾ç½®ä¸º GPIO åŠŸèƒ½è¦å¦‚ä½•è®¾ç½®å‘¢ï¼Œä»ä¸Šå›¾å¯ä»¥çœ‹åˆ° GPIO å¯¹åº”åŠŸèƒ½ 0ï¼Œ æ‰€ä»¥å¯ä»¥é€šè¿‡ä»¥ä¸‹ pinctrl å†…å®¹å°†è®¾ç½® RK_PB1 å’Œ RK_PB2 è®¾ç½®ä¸º GPIO åŠŸèƒ½ï¼ˆäº‹å®ä¸Šå¦‚æœä¸å¯¹è¯¥ç®¡è„šè¿›è¡ŒåŠŸèƒ½å¤ç”¨è¯¥å¼•è„šé»˜è®¤å°±ä¼šè®¾ç½®ä¸º GPIO åŠŸèƒ½ï¼‰ ï¼š     </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="number">3</span> RK_PB1 <span class="number">0</span> &amp;pcfg_pull_up&gt;,</span><br><span class="line">&lt;<span class="number">3</span> RK_PB2 <span class="number">0</span> &amp;pcfg_pull_up&gt;;</span><br></pre></td></tr></table></figure>

<p>æœ€åæ¥çœ‹å®¢æˆ·ç«¯å¯¹ uart4 æœåŠ¡ç«¯çš„å¼•ç”¨ï¼Œå¯èƒ½ä¼šè¿™æ ·å†™ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&amp;uart4 &#123;</span><br><span class="line">	status = <span class="string">&quot;okay&quot;</span>;</span><br><span class="line">       pinctrl-names = <span class="string">&quot;default&quot;</span>;</span><br><span class="line">       pinctrl<span class="number">-0</span> = &lt;&amp;uart4m1_xfer&gt;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡åœ¨å®¢æˆ·ç«¯ä¸­å¼•ç”¨æœåŠ¡ç«¯çš„å¼•è„šæè¿°ç¬¦ï¼Œ è®¾å¤‡æ ‘å¯ä»¥å°†å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„å¼•è„šé…ç½®å…³è”èµ·æ¥ã€‚ è¿™æ ·ï¼Œ åœ¨è®¾å¤‡æ ‘è¢«è§£æå’Œå¤„ç†æ—¶ï¼Œ æ“ä½œç³»ç»Ÿå’Œè®¾å¤‡é©±åŠ¨ç¨‹åºå¯ä»¥æ ¹æ®å®¢æˆ·ç«¯çš„éœ€æ±‚ï¼Œ æŸ¥æ‰¾å¹¶åº”ç”¨é€‚å½“çš„å¼•è„šé…ç½®ã€‚  </p>
<h3 id="5-3-RK3568å¼€å‘æ¿çš„ä¸€ä¸ªå®ä¾‹"><a href="#5-3-RK3568å¼€å‘æ¿çš„ä¸€ä¸ªå®ä¾‹" class="headerlink" title="5.3 RK3568å¼€å‘æ¿çš„ä¸€ä¸ªå®ä¾‹"></a><font size=3>5.3 RK3568å¼€å‘æ¿çš„ä¸€ä¸ªå®ä¾‹</font></h3><blockquote>
<p>è¯´æ˜ï¼šæˆ‘æ²¡æœ‰è¿™ä¸ªå¼€å‘æ¿ï¼Œè¿™é‡Œæ˜¯å­¦ä¹ æ•™ç¨‹çš„æ—¶å€™ç›´æ¥å¤åˆ¶è¿‡æ¥ä½œä¸ºå‚è€ƒç¬”è®°ï¼Œåé¢åœ¨imx6ullå¼€å‘æ¿ä¸­æ˜¯ä¼šå†å­¦ä¹ pinctrl å­ç³»ç»Ÿï¼Œè¿™é‡Œä¹Ÿèƒ½å¸®åŠ©ç†è§£ã€‚</p>
</blockquote>
<p>é€šè¿‡ä¸Šé¢å­¦åˆ°çš„ pinctrl ç›¸å…³çŸ¥è¯†ï¼Œ å°† led çš„æ§åˆ¶å¼•è„šå¤ç”¨ä¸º GPIO æ¨¡å¼ã€‚é¦–å…ˆæ¥å¯¹ rk3568 çš„è®¾å¤‡æ ‘ç»“æ„è¿›è¡Œä»¥ä¸‹ä»‹ç»ï¼Œ æ ¹æ® sdk æºç ç›®å½•ä¸‹çš„â€œdevice&#x2F;rockchip&#x2F;rk356x&#x2F;BoardConfig-rk3568-evb1-ddr4-v10.mkâ€ é»˜è®¤é…ç½®æ–‡ä»¶å¯ä»¥äº†è§£åˆ°ç¼–è¯‘çš„è®¾å¤‡æ ‘ä¸º rk3568 -evb1-ddr4-v10-linux.dts,æ•´ç†å¥½çš„è®¾å¤‡æ ‘ä¹‹é—´åŒ…å«å…³ç³»åˆ—è¡¨å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250221095145496.png" alt="image-20250221095145496"  />

<p>Led åœ¨ rk3568-evb.dtsi è®¾å¤‡æ ‘ä¸­å·²ç»è¢«æ­£å¸¸é…ç½®äº†ï¼Œ å¦‚ä¸‹å›¾:</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250221095201552.png" alt="image-20250221095201552"  />

<p>è¿™é‡Œä¹Ÿå¹¶æ²¡æœ‰é…ç½® pinctrl å‘€ï¼Œ é‚£ä¸ºä»€ä¹ˆ led æœ€åèƒ½æ­£å¸¸ä½¿ç”¨å‘¢ï¼Œ è¿™ä¸ªåŸå› ä¹‹å‰å…¶å®å·²ç»æåˆ°äº†ï¼Œ å½“ä¸€ä¸ªå¼•è„šæ²¡æœ‰è¢«å¤ç”¨ä¸ºä»»ä½•åŠŸèƒ½æ—¶ï¼Œ é»˜è®¤å°±æ˜¯ GPIO åŠŸèƒ½ï¼Œ æ‰€ä»¥è¿™é‡Œæ²¡æœ‰ pinctrl led åŠŸèƒ½ä¹Ÿå¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚  </p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250221100143833.png" alt="image-20250221100143833"  />

<p>ä¿å­˜é€€å‡ºä¹‹åï¼Œ ç„¶åè¿›å…¥åˆ° rk3568-evb1-ddr4-v10.dtsi è®¾å¤‡æ ‘ä¸­ï¼Œ æ‰¾åˆ° rk_485_ctl èŠ‚ç‚¹ï¼Œ å¦‚ä¸‹å›¾  ï¼š</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250221100203516.png" alt="image-20250221100203516"  />

<p>è¿™æ˜¯æ ¹èŠ‚ç‚¹çš„æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œ è€Œä¸”ä¹Ÿæ˜¯ç”¨æ¥æ§åˆ¶ä¸€ä¸ª GPIO çš„ï¼Œ æˆ‘ä»¬å®Œå…¨å¯ä»¥ä»¿ç…§è¯¥èŠ‚ç‚¹ï¼Œåœ¨è¯¥èŠ‚ç‚¹ä¸‹æ–¹ç¼–å†™ led æ§åˆ¶èŠ‚ç‚¹ï¼Œ ä»¿å†™å®Œæˆçš„è®¾å¤‡æ ‘å†…å®¹å¦‚ä¸‹æ‰€ç¤º  ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">my_led: led &#123;</span><br><span class="line">    compatible = <span class="string">&quot;topeet,led&quot;</span>;</span><br><span class="line">    gpios = &lt;&amp;gpio0 RK_PB7 GPIO_ACTIVE_HIGH&gt;;</span><br><span class="line">    pinctrl-names = <span class="string">&quot;default&quot;</span>;</span><br><span class="line">    pinctrl<span class="number">-0</span> = &lt;&amp;rk_led_gpio&gt;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>ç¬¬ 1 è¡Œï¼š èŠ‚ç‚¹åç§°ä¸º ledï¼Œ æ ‡ç­¾åä¸º my_ledã€‚</p>
<p>ç¬¬ 2 è¡Œï¼š compatible å±æ€§æŒ‡å®šäº†è®¾å¤‡çš„å…¼å®¹æ€§æ ‡è¯†ï¼Œ å³è®¾å¤‡ä¸é©±åŠ¨ç¨‹åºä¹‹é—´çš„åŒ¹é…è§„åˆ™ã€‚åœ¨è¿™é‡Œï¼Œ è®¾å¤‡æ ‡è¯†ä¸º â€œtopeet,ledâ€ï¼Œ è¡¨ç¤ºè¯¥ LED è®¾å¤‡ä¸åä¸º â€œtopeet,ledâ€ çš„é©±åŠ¨ç¨‹åºå…¼å®¹ã€‚</p>
<p>ç¬¬ 3 è¡Œï¼š gpios å±æ€§æŒ‡å®šäº†ä¸ LED ç›¸å…³çš„ GPIOï¼ˆé€šç”¨è¾“å…¥&#x2F;è¾“å‡ºï¼‰ å¼•è„šé…ç½®ã€‚</p>
<p>ç¬¬ 4 è¡Œï¼š pinctrl-names å±æ€§æŒ‡å®šäº†ä¸å¼•è„šæ§åˆ¶ç›¸å…³çš„å‘½åã€‚ default è¡¨ç¤ºçŠ¶æ€ 0</p>
<p>ç¬¬ 5 è¡Œï¼š pinctrl-0 å±æ€§æŒ‡å®šäº†ä¸ pinctrl-names å±æ€§ä¸­å‘½åçš„å¼•è„šæ§åˆ¶ç›¸å…³è”çš„å®é™…å¼•è„šæ§åˆ¶å™¨é…ç½®ã€‚ &lt;&amp;rk_led_gpio&gt; è¡¨ç¤ºå¼•ç”¨äº†åä¸º rk_led_gpio çš„å¼•è„šæ§åˆ¶å™¨é…ç½®ã€‚</p>
<p>æ·»åŠ å®Œæˆå¦‚ä¸‹å›¾:</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250221100310837.png" alt="image-20250221100310837"  />

<p>ç„¶åç»§ç»­æ‰¾åˆ°åœ¨åŒä¸€è®¾å¤‡æ ‘æ–‡ä»¶çš„ 485 pinctrl æœåŠ¡ç«¯èŠ‚ç‚¹ï¼Œ å…·ä½“å†…å®¹å¦‚ä¸‹  ï¼š</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250221100328129.png" alt="image-20250221100328129"  />

<p>ç„¶ååœ¨è¯¥èŠ‚ç‚¹ä¸‹æ–¹ä»¿å†™ led æ§åˆ¶å¼•è„š pinctrl æœåŠ¡ç«¯èŠ‚ç‚¹ï¼Œ ä»¿å†™å®Œæˆçš„èŠ‚ç‚¹å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">rk_led&#123;</span><br><span class="line">    rk_led_gpio:rk-led-gpio &#123;</span><br><span class="line">    	rockchip,pins = &lt;<span class="number">0</span> RK_PB7 RK_FUNC_GPIO &amp;pcfg_pull_none&gt;;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>æ·»åŠ å®Œæˆä¹‹åå¦‚ä¸‹å›¾:</p>
<img data-src="https://fanhua-picture.oss-cn-hangzhou.aliyuncs.com/01%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/02IMX6ULL%E5%B9%B3%E5%8F%B0/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/LV06-10-%E8%AE%BE%E5%A4%87%E6%A0%91-02-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%AF%AD%E6%B3%95/img/image-20250221100415836.png" alt="image-20250221100415836"  />

<p>è‡³æ­¤ï¼Œ led çš„æ§åˆ¶å¼•è„šå°±é€šè¿‡ pinctrl è¢«å¤ç”¨ä¸ºäº† GPIO åŠŸèƒ½ï¼Œ ä¿å­˜é€€å‡ºä¹‹åï¼Œ é‡æ–°ç¼–è¯‘å†…æ ¸ï¼Œæ²¡æœ‰æŠ¥é”™å°±è¯æ˜æˆ‘ä»¬çš„å®ä¾‹å®Œæˆäº†ã€‚  </p>

    </div>

    
    
    

    <footer class="post-footer">




    <div>
        
            <div style="text-align:center;color: #ccc;font-size:14px;">
            ----------æœ¬æ–‡ç»“æŸ
            <i class="fas fa-fan fa-spin" style="color: #FF1493; font-size: 1rem"></i>
            æ„Ÿè°¢æ‚¨çš„é˜…è¯»----------
            </div>
        
    </div>





  
  <div class="my_post_copyright"> 
    <p><span>æ–‡ç« æ ‡é¢˜:</span><a href="/post/3a7cdf02.html">LV06-10-è®¾å¤‡æ ‘-02-è®¾å¤‡æ ‘è¯­æ³•</a></p>
    <p><span>æ–‡ç« ä½œè€…:</span><a href="/" title="æ¬¢è¿è®¿é—® ã€Šè‹æœ¨ã€‹ çš„å­¦ä¹ ç¬”è®°">è‹æœ¨</a></p>
    <p><span>å‘å¸ƒæ—¶é—´:</span>2025å¹´03æœˆ17æ—¥ - 07:45</p>
    <p><span>æœ€åæ›´æ–°:</span>2025å¹´06æœˆ14æ—¥ - 00:25</p>
    <p><span>åŸå§‹é“¾æ¥:</span><a href="/post/3a7cdf02.html" title="LV06-10-è®¾å¤‡æ ‘-02-è®¾å¤‡æ ‘è¯­æ³•">https://sumumm.github.io/post/3a7cdf02.html</a></p>
    <p><span>è®¸å¯åè®®:</span><i class="fab fa-creative-commons"></i> <a rel="license" href= "https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç¦æ­¢æ¼”ç» 4.0 å›½é™…</a> è½¬è½½è¯·ä¿ç•™åŸæ–‡é“¾æ¥åŠä½œè€…ã€‚</p>  
  </div>
  


          <div class="post-tags">
              <a href="/tags/LV06-%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/" rel="tag"><i class="fa fa-tag"></i> LV06-é©±åŠ¨å¼€å‘</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/post/cb9c294a.html" rel="prev" title="LV06-10-è®¾å¤‡æ ‘-03-è®¾å¤‡æ ‘æ·±å…¥åˆ†æ">
                  <i class="fa fa-angle-left"></i> LV06-10-è®¾å¤‡æ ‘-03-è®¾å¤‡æ ‘æ·±å…¥åˆ†æ
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/post/ad7cbef7.html" rel="next" title="LV06-10-è®¾å¤‡æ ‘-01-è®¾å¤‡æ ‘åŸºç¡€">
                  LV06-10-è®¾å¤‡æ ‘-01-è®¾å¤‡æ ‘åŸºç¡€ <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2017 â€“ 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">è‹æœ¨</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>ç«™ç‚¹æ€»å­—æ•°ï¼š</span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">3.7m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>ç«™ç‚¹é˜…è¯»æ—¶é•¿ &asymp;</span>
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">225:26</span>
  </span>
</div>




    <span id="sitetime"></span>
    <script defer language=javascript>
        function siteTime()
        {
            window.setTimeout("siteTime()", 1000);
            var seconds = 1000;
            var minutes = seconds * 60;
            var hours = minutes * 60;
            var days = hours * 24;
            var years = days * 365;
            var today = new Date();
            var todayYear = today.getFullYear();
            var todayMonth = today.getMonth()+1;
            var todayDate = today.getDate();
            var todayHour = today.getHours();
            var todayMinute = today.getMinutes();
            var todaySecond = today.getSeconds();
            /*==================================================
            Date.UTC() -- è¿”å›dateå¯¹è±¡è·ä¸–ç•Œæ ‡å‡†æ—¶é—´(UTC)1970å¹´1æœˆ1æ—¥åˆå¤œä¹‹é—´çš„æ¯«ç§’æ•°(æ—¶é—´æˆ³)
            year        - ä½œä¸ºdateå¯¹è±¡çš„å¹´ä»½ï¼Œä¸º4ä½å¹´ä»½å€¼
            month       - 0-11ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„æœˆä»½
            day         - 1-31ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„å¤©æ•°
            hours       - 0(åˆå¤œ24ç‚¹)-23ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„å°æ—¶æ•°
            minutes     - 0-59ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„åˆ†é’Ÿæ•°
            seconds     - 0-59ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„ç§’æ•°
            microseconds - 0-999ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„æ¯«ç§’æ•°
            ==================================================*/
            var t1 = Date.UTC(2017, 
                              5, 
                              19, 
                              0, 
                              0, 
                              0); //åŒ—äº¬æ—¶é—´
            var t2 = Date.UTC(todayYear,todayMonth,todayDate,todayHour,todayMinute,todaySecond);
            var diff = t2-t1;
            var diffYears = Math.floor(diff/years);
            var diffDays = Math.floor((diff/days)-diffYears*365);
            var diffHours = Math.floor((diff-(diffYears*365+diffDays)*days)/hours);
            var diffMinutes = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours)/minutes);
            var diffSeconds = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours-diffMinutes*minutes)/seconds);
            document.getElementById("sitetime").innerHTML="å·²åœ¨è¿™é‡Œ "+diffYears+" å¹´ "+diffDays+" å¤© "+diffHours+" å°æ—¶ "+diffMinutes+" åˆ†é’Ÿ "+diffSeconds+" ç§’";
        }
        siteTime();
    </script>



    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="è¿”å›é¡¶éƒ¨">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.28/fancybox/fancybox.umd.js" integrity="sha256-ytMJGN3toR+a84u7g7NuHm91VIR06Q41kMWDr2pq7Zo=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/fancybox.js"></script>

  <script src="/js/third-party/pace.js"></script>


  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


 
        <div id="click-show-text"
            data-mobile = false
            data-text = å¯Œå¼º,æ°‘ä¸»,æ–‡æ˜,å’Œè°,è‡ªç”±,å¹³ç­‰,å…¬æ­£,æ³•åˆ¶,çˆ±å›½,æ•¬ä¸š,è¯šä¿¡,å‹å–„
            data-fontsize = 15px
            data-random= false>
        </div>
       

      
        <script async src=https://cdn.jsdelivr.net/npm/hexo-next-mouse-effect@latest/click/showText.js></script>
      

      
    




    <script async src="/js/fancybox_param.js"></script>





<!-- APlayeræœ¬ä½“ -->



</body>
</html>
